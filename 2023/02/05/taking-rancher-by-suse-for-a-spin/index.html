<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>Taking Rancher by SUSE for a Spin &middot; blog.andreasm.io</title>
  <meta name="title" content="Taking Rancher by SUSE for a Spin &middot; blog.andreasm.io" />
  
  <meta name="description" content="In this post I wil go through Rancher and test out some of the possibilties and capabilties managing Kubernetes using Rancher." />
  <meta name="keywords" content="suse, rancher, kubernetes-management, rke2, " />
  
  
  <link rel="canonical" href="https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.48d290696564c2380c4233780f3fd414aa6e2b0b67ed916e9d918c48c05f5b20b641bf892fadd408e43ec21d2feb2ec1fe6fd1f021df2806a254977fe2f80a64.css"
    integrity="sha512-SNKQaWVkwjgMQjN4Dz/UFKpuKwtn7ZFunZGMSMBfWyC2Qb&#43;JL63UCOQ&#43;wh0v6y7B/m/R8CHfKAaiVJd/4vgKZA==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.a85bd6dc99d1fecae166deb56a1fee6375588c72533c4b8c690e4a9ec5a04174ff780e41e2ac770382a8e67818cb2b89766afa3e23965c9102424a080dafbb0c.js"
    integrity="sha512-qFvW3JnR/srhZt61ah/uY3VYjHJTPEuMaQ5KnsWgQXT/eA5B4qx3A4Ko5ngYyyuJdmr6PiOWXJECQkoIDa&#43;7DA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.a2d78d78672e549fbfc972ece871725b5478ba0b65708dda20cb97ab80a865eae6d247e1b05a4aec6ebbf78647ec3233bad8b2609ed98eee53cd58aa17128bc7.js"
    integrity="sha512-oteNeGcuVJ&#43;/yXLs6HFyW1R4ugtlcI3aIMuXq4CoZerm0kfhsFpK7G6794ZH7DIzutiyYJ7Zju5TzViqFxKLxw==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/">
  <meta property="og:site_name" content="blog.andreasm.io">
  <meta property="og:title" content="Taking Rancher by SUSE for a Spin">
  <meta property="og:description" content="Trying out Rancher and some of its capabilities">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-05T21:18:48+02:00">
    <meta property="article:modified_time" content="2023-02-05T21:18:48+02:00">
    <meta property="article:tag" content="Suse">
    <meta property="article:tag" content="Rancher">
    <meta property="article:tag" content="Kubernetes-Management">
    <meta property="article:tag" content="Rke2">
    <meta property="og:image" content="https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/feature-rancher-suse-logo-horizontal-color.svg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/feature-rancher-suse-logo-horizontal-color.svg">
  <meta name="twitter:title" content="Taking Rancher by SUSE for a Spin">
  <meta name="twitter:description" content="Trying out Rancher and some of its capabilities">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Taking Rancher by SUSE for a Spin",
    "headline": "Taking Rancher by SUSE for a Spin",
    "description": "Trying out Rancher and some of its capabilities",
    "abstract": "In this post I wil go through Rancher and test out some of the possibilties and capabilties managing Kubernetes using Rancher.",
    "inLanguage": "en",
    "url" : "https:\/\/blog.andreasm.io\/2023\/02\/05\/taking-rancher-by-suse-for-a-spin\/",
    "author" : {
      "@type": "Person",
      "name": "Andreas Marqvardsen"
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-02-05T21:18:48\u002b02:00",
    "datePublished": "2023-02-05T21:18:48\u002b02:00",
    
    "dateModified": "2023-02-05T21:18:48\u002b02:00",
    
    "keywords": ["suse","rancher","kubernetes-management","rke2"],
    
    "mainEntityOfPage": "true",
    "wordCount": "10582"
  }]
  </script>


  
  
  <meta name="author" content="Andreas Marqvardsen" />
  
  
  
  <link href="mailto:andreas.marqvardsen[AT]gmail.com" rel="me" />
  
  
  <link href="https://blog.andreasm.io/" rel="me" />
  
  
  <link href="https://github.com/andreasm80" rel="me" />
  
  
  <link href="https://linkedin.com/in/andreas-marqvardsen" rel="me" />
  
  
  <link href="https://vmst.io/@andreasm" rel="me" />
  
  
  <link href="https://x.com/NATsoFast" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  

<script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPYDVE8KR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TVPYDVE8KR');
</script>



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">blog.andreasm.io</span>

            
            <img src="/ynwa2.png" width="300" height="342"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="blog.andreasm.io" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">blog.andreasm.io</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Posts
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        About
    </p>
</a>



            
            
  <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Categories
    </p>
</a>



            
            
  <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Posts
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/2023/02/05/taking-rancher-by-suse-for-a-spin/feature-rancher-suse-logo-horizontal-color.svg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >blog.andreasm.io</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/2023/02/05/taking-rancher-by-suse-for-a-spin/"
      >Taking Rancher by SUSE for a Spin</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      Taking Rancher by SUSE for a Spin
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-02-05T21:18:48&#43;02:00">5 February 2023</time><span class="px-2 text-primary-500">&middot;</span><span>10582 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">50 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/rancher/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Rancher
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/kubernetes-management/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes-Management
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/rke2/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    RKE2
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/suse/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Suse
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/rancher/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Rancher
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/kubernetes-management/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes-Management
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/rke2/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Rke2
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Andreas Marqvardsen" src="/profile.png" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Andreas Marqvardsen
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Always curious, always learning</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:andreas.marqvardsen[AT]gmail.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://blog.andreasm.io/"
          target="_blank"
          aria-label="Link"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/andreasm80"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://linkedin.com/in/andreas-marqvardsen"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://vmst.io/@andreasm"
          target="_blank"
          aria-label="Mastodon"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://x.com/NATsoFast"
          target="_blank"
          aria-label="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#my-environments-used-in-this-post">My environments used in this post</a>
      <ul>
        <li><a href="#where-rancher-sits">Where Rancher sits</a></li>
      </ul>
    </li>
    <li><a href="#installing-rancher-on-an-existing-kubernetes-cluster-using-helm">Installing Rancher on an existing Kubernetes Cluster using Helm</a></li>
    <li><a href="#create-and-manage-kubernetes-clusters">Create and manage Kubernetes clusters</a>
      <ul>
        <li><a href="#rancher-kubernetes-distributions">Rancher Kubernetes distributions</a></li>
      </ul>
    </li>
    <li><a href="#create-rke2-clusters-using-vsphere">Create RKE2 clusters using vSphere</a>
      <ul>
        <li><a href="#create-cloud-credentials">Create Cloud Credentials</a></li>
        <li><a href="#rke2-clusters-using-vsphere-content-library-template">RKE2 clusters using vSphere Content Library template</a></li>
        <li><a href="#rke2-clusters-using-vsphere-vm-template">RKE2 clusters using vSphere VM template</a></li>
      </ul>
    </li>
    <li><a href="#creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider">Creating a RKE2 cluster on existing nodes - non native cloud provider</a>
      <ul>
        <li><a href="#creating-rke2-cluster-on-existing-nodes---custom-cloud">Creating RKE2 cluster on existing nodes - &ldquo;custom cloud&rdquo;</a></li>
      </ul>
    </li>
    <li><a href="#import-existing-kubernetes-clusters">Import existing Kubernetes Clusters</a></li>
    <li><a href="#navigating-the-rancher-ui">Navigating the Rancher UI</a>
      <ul>
        <li><a href="#rancher-cluster-dashboard">Rancher Cluster Dashboard</a></li>
        <li><a href="#accessing-my-new-rke2-cluster-deployed-on-vsphere">Accessing my new RKE2 cluster deployed on vSphere</a></li>
      </ul>
    </li>
    <li><a href="#managing-kubernetes-clusters-from-rancher">Managing Kubernetes clusters from Rancher</a>
      <ul>
        <li><a href="#scaling-nodes-horizontally---up-and-down">Scaling nodes horizontally - up and down</a></li>
        <li><a href="#scaling-nodes-vertically---add-cpu-ram-and-disk">Scaling nodes vertically - add cpu, ram and disk</a></li>
        <li><a href="#upgrading-kubernetes-clusters">Upgrading Kubernetes clusters</a></li>
        <li><a href="#installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator">Installing another Ingress controller than the default Ngninx - Avi Kubernetes Operator</a></li>
      </ul>
    </li>
    <li><a href="#installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni">Installing Custom CNI - bootstrapping new clusters using Antrea CNI</a>
      <ul>
        <li><a href="#add-on-config-using-manifest">Add-on Config using manifest</a></li>
        <li><a href="#add-on-config-using-helm-charts">Add-on Config using Helm Charts</a></li>
        <li><a href="#upgrading-or-changing-version-of-the-antrea-cni-using-rancher">Upgrading or changing version of the Antrea CNI using Rancher</a></li>
      </ul>
    </li>
    <li><a href="#neuvector">NeuVector</a></li>
    <li><a href="#monitoring">Monitoring</a></li>
    <li><a href="#the-rancher-api">The Rancher API</a></li>
    <li><a href="#authentication-and-rbac-with-rancher">Authentication and RBAC with Rancher</a></li>
    <li><a href="#outro">Outro</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#my-environments-used-in-this-post">My environments used in this post</a>
      <ul>
        <li><a href="#where-rancher-sits">Where Rancher sits</a></li>
      </ul>
    </li>
    <li><a href="#installing-rancher-on-an-existing-kubernetes-cluster-using-helm">Installing Rancher on an existing Kubernetes Cluster using Helm</a></li>
    <li><a href="#create-and-manage-kubernetes-clusters">Create and manage Kubernetes clusters</a>
      <ul>
        <li><a href="#rancher-kubernetes-distributions">Rancher Kubernetes distributions</a></li>
      </ul>
    </li>
    <li><a href="#create-rke2-clusters-using-vsphere">Create RKE2 clusters using vSphere</a>
      <ul>
        <li><a href="#create-cloud-credentials">Create Cloud Credentials</a></li>
        <li><a href="#rke2-clusters-using-vsphere-content-library-template">RKE2 clusters using vSphere Content Library template</a></li>
        <li><a href="#rke2-clusters-using-vsphere-vm-template">RKE2 clusters using vSphere VM template</a></li>
      </ul>
    </li>
    <li><a href="#creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider">Creating a RKE2 cluster on existing nodes - non native cloud provider</a>
      <ul>
        <li><a href="#creating-rke2-cluster-on-existing-nodes---custom-cloud">Creating RKE2 cluster on existing nodes - &ldquo;custom cloud&rdquo;</a></li>
      </ul>
    </li>
    <li><a href="#import-existing-kubernetes-clusters">Import existing Kubernetes Clusters</a></li>
    <li><a href="#navigating-the-rancher-ui">Navigating the Rancher UI</a>
      <ul>
        <li><a href="#rancher-cluster-dashboard">Rancher Cluster Dashboard</a></li>
        <li><a href="#accessing-my-new-rke2-cluster-deployed-on-vsphere">Accessing my new RKE2 cluster deployed on vSphere</a></li>
      </ul>
    </li>
    <li><a href="#managing-kubernetes-clusters-from-rancher">Managing Kubernetes clusters from Rancher</a>
      <ul>
        <li><a href="#scaling-nodes-horizontally---up-and-down">Scaling nodes horizontally - up and down</a></li>
        <li><a href="#scaling-nodes-vertically---add-cpu-ram-and-disk">Scaling nodes vertically - add cpu, ram and disk</a></li>
        <li><a href="#upgrading-kubernetes-clusters">Upgrading Kubernetes clusters</a></li>
        <li><a href="#installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator">Installing another Ingress controller than the default Ngninx - Avi Kubernetes Operator</a></li>
      </ul>
    </li>
    <li><a href="#installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni">Installing Custom CNI - bootstrapping new clusters using Antrea CNI</a>
      <ul>
        <li><a href="#add-on-config-using-manifest">Add-on Config using manifest</a></li>
        <li><a href="#add-on-config-using-helm-charts">Add-on Config using Helm Charts</a></li>
        <li><a href="#upgrading-or-changing-version-of-the-antrea-cni-using-rancher">Upgrading or changing version of the Antrea CNI using Rancher</a></li>
      </ul>
    </li>
    <li><a href="#neuvector">NeuVector</a></li>
    <li><a href="#monitoring">Monitoring</a></li>
    <li><a href="#the-rancher-api">The Rancher API</a></li>
    <li><a href="#authentication-and-rbac-with-rancher">Authentication and RBAC with Rancher</a></li>
    <li><a href="#outro">Outro</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
          
            $(e).removeClass('active');
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          

<h1 class="relative group">Rancher by Suse - short introduction 
    <div id="rancher-by-suse---short-introduction" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rancher-by-suse---short-introduction" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>From the offical Rancher <a href="https://ranchermanager.docs.rancher.com/getting-started/overview" target="_blank">docs</a>:</p>
<blockquote>
<p>Rancher is a container management platform built for organizations that deploy containers in production. Rancher makes it easy to run Kubernetes everywhere, meet IT requirements, and empower DevOps teams.</p>
</blockquote>
<blockquote>
<p><strong>Run Kubernetes Everywhere</strong></p>
<p>Kubernetes has become the container orchestration standard. Most cloud and virtualization vendors now offer it as standard infrastructure. Rancher users have the choice of creating Kubernetes clusters with Rancher Kubernetes Engine (RKE) or cloud Kubernetes services, such as GKE, AKS, and EKS. Rancher users can also import and manage their existing Kubernetes clusters created using any Kubernetes distribution or installer.</p>
<p><strong>Meet IT Requirements</strong></p>
<p>Rancher supports centralized authentication, access control, and monitoring for all Kubernetes clusters under its control. For example, you can:</p>
<ul>
<li>Use your Active Directory credentials to access Kubernetes clusters hosted by cloud vendors, such as GKE.</li>
<li>Setup and enforce access control and security policies across all users, groups, projects, clusters, and clouds.</li>
<li>View the health and capacity of your Kubernetes clusters from a single-pane-of-glass.</li>
</ul>
</blockquote>
<p>Rancher can manage already existing Kubernetes clusters by importing them into Rancher, but Rancher can also do fully automated deployments of complete Kubernetes clusters.</p>
<p>The initial parts of this post will be focusing on getting Rancher itself deployed, then I will do some automated Kubernetes deployments from Rancher. The goal is to showcase how quick and easy it is to to deploy Kubernetes using Rancher. If it is not too obvious when reading these cluster creation chapters, trust me, deploying and managing Kubernetes cluster with Rancher is both fun and easy. After the initial chapters I will dive into some more technical topics.</p>
<p>This post is not meant to be a comprehensive article on all features/configurations possible with Rancher, look at it more as an <em>unboxing</em> Rancher post.</p>


<h2 class="relative group">My environments used in this post 
    <div id="my-environments-used-in-this-post" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#my-environments-used-in-this-post" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>In this post I will be using two platforms where I run and deploy my Kubernetes clusters. One platform is VMware vSphere the other is using Proxmox. Proxmox is running home in my lab, vSphere is running in another remote place and I am accessing it using IPsec VPN. In this post I will deploy Rancher in a Tanzu Kubernetes Cluster deployed in my vSphere lab. I already have Rancher running in one of my Kubernetes clusters in my Proxmox lab. The Rancher deployment in vSphere is just used to go through the installation of Rancher (I had already done the installation of Rancher before creating this post and didnt want to tear it down). The Rancher instance in my lab will be used for both importing existing Kubernetes clusters and the automated deployments of Kubernetes clusters on both the vSphere environment and Proxmox environment.</p>
<p>In a very high level diagram it should look like this:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509112418043.png"
        alt="home-remote-environments"
      />
      
    </figure>
</p>


<h3 class="relative group">Where Rancher sits 
    <div id="where-rancher-sits" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#where-rancher-sits" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>As I will proceed through this post by adding and deploying Kubernetes clusters and using Rancher accessing these clusters, it will make sense to illustrate how this looks like. It may be beneficial to the overall understanding to have as much context as possible of whats going on and how things work when reading through the post.</p>
<p>Running Rancher on Kubernetes makes Rancher Highly Available, it will be distributed across multiple Kubernetes worker nodes and also benefit from Kubernetes lifecycle management, self-healing etc. Rancher will become a critical endpoint so managing and ensuring availability to this endpoint is critical. Exposing the Rancher using a HA capable loadbalancer is something to consider. Loosing a singleton instance loadbalancer means loosing access to Rancher. To expose Rancher one can use VMware <a href="https://docs.vmware.com/en/VMware-NSX-Advanced-Load-Balancer/index.html" target="_blank">Avi Loadbalancer</a> with its distributed architecture (several Service Engines in Active/Active) or one can use Traefik loadbalancer, HAProxy Nginx, just to name a few. Then the underlaying physical compute hosts should consist of more than one host of course.</p>
<p>One should thrive to make the Rancher API endpoint as robust as possible as this will be THE endpoint to use to access and manage the Rancher managed Kubernetes Clusters.</p>
<img src=images/image-20240509114316030.png style="width:500px" />
<p>As one can imagine, managing multiple clusters using Rancher there will be some requests to this endpoint. So performance and resilience is key.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509222710678.png"
        alt="rancher-proxy"
      />
      
    </figure>
</p>
<p>As soon as I have authenticated through Rancher I can access my Kubernetes clusters. Rancher will then work as a proxy and forward my requests to my respective Kubernetes clusters.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">{</span><span class="s2">&#34;kind&#34;</span>:<span class="s2">&#34;Event&#34;</span>,<span class="s2">&#34;authorization.k8s.io/decision&#34;</span>:<span class="s2">&#34;allow&#34;</span>,<span class="s2">&#34;authorization.k8s.io/reason&#34;</span>:<span class="s2">&#34;RBAC: allowed by ClusterRoleBinding \&#34;globaladmin-user-64t5q\&#34; of ClusterRole \&#34;cluster-admin\&#34; to User \&#34;user-64t5q\&#34;&#34;</span><span class="o">}}</span>
</span></span></code></pre></div>

<h2 class="relative group">Installing Rancher on an existing Kubernetes Cluster using Helm 
    <div id="installing-rancher-on-an-existing-kubernetes-cluster-using-helm" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#installing-rancher-on-an-existing-kubernetes-cluster-using-helm" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Before I can start using Rancher I need to install it. Rancher can be deployed using Docker for poc/testing purposes and on (more or less any) Kubernetes platform for production use. <em>If one started out testing Rancher on Docker one can actually <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/other-installation-methods" target="_blank">migrate</a> from Docker to Kubernetes at a later stage also.</em> In this post I will deploy Rancher on Kubernetes. I have already deployed a Kubernetes cluster I intend to deploy Rancher on. The Kubernetes cluster that will be used is provisioned by vSphere with Tanzu, running in my vSphere cluster using the method I describe in this <a href="https://blog.andreasm.io/2024/02/04/argo-cd-vsphere-with-tanzu/" target="_blank">post</a>. vSphere with Tanzu is also its own Kubernetes management platform of course. I have deployed 3 control plane nodes and 3 worker nodes. All persistent storage will be handled by the the vSphere Cluster VSAN storage. Ingress will be taken care of by VMware Avi loadbalancer.</p>
<p>Here is my TKC cluster I will install rancher on:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506080623908.png"
        alt="tkc-cluster-1"
      />
      
    </figure>
</p>
<p>The cluster is ready with all the necessary backend services like the Avi loadbalancer providing loadbalancer services and Ingress rules. The first thing I need is to add the Helm repo for Rancher.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># latest - recommended for testing the newest features</span>
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~$ helm repo add rancher-latest https://releases.rancher.com/server-charts/latest
</span></span><span class="line"><span class="cl"><span class="s2">&#34;rancher-latest&#34;</span> has been added to your repositories
</span></span></code></pre></div><p>Create a namespace for Rancher:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~$ kubectl create namespace cattle-system
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">namespace/cattle-system created
</span></span></code></pre></div><p>I will bring my own Certificate, so skipping Cert-Manager. This is my Rancher Helm value yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Additional Trusted CAs.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Enable this flag and add your CA certs as a secret named tls-ca-additional in the namespace.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># See README.md for details.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">additionalTrustedCAs</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">antiAffinity</span><span class="p">:</span><span class="w"> </span><span class="l">preferred</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">topologyKey</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes.io/hostname</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Audit Logs https://rancher.com/docs/rancher/v2.x/en/installation/api-auditing/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># The audit log is piped to the console of the rancher-audit-log container in the rancher pod.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># https://rancher.com/docs/rancher/v2.x/en/installation/api-auditing/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># destination stream to sidecar container console or hostPath volume</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># level: Verbosity of logs, 0 to 3. 0 is off 3 is a lot.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">auditLog</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l">sidecar</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">hostPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/log/rancher/audit/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maxAge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maxBackup</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maxSize</span><span class="p">:</span><span class="w"> </span><span class="m">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Image for collecting rancher audit logs.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Important: update pkg/image/export/resolve.go when this default image is changed, so that it&#39;s reflected accordingly in rancher-images.txt generated for air-gapped setups.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;rancher/mirrored-bci-micro&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="m">15.4.14.3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Override imagePullPolicy image</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># options: Always, Never, IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pullPolicy</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;IfNotPresent&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># As of Rancher v2.5.0 this flag is deprecated and must be set to &#39;true&#39; in order for Rancher to start</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">addLocal</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Add debug flag to Rancher server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># When starting Rancher for the first time, bootstrap the admin as restricted-admin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">restrictedAdmin</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Extra environment variables passed to the rancher pods.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># extraEnv:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># - name: CATTLE_TLS_MIN_VERSION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   value: &#34;1.0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Fully qualified name to reach your Rancher server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">rancher-01.my.domain.net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">## Optional array of imagePullSecrets containing private registry credentials</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">## Ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># - name: secretName</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">### ingress ###</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Readme for details and instruction on adding tls secrets.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">ingress</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># If set to false, ingress will not be created</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Defaults to true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># options: true, false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">includeDefaultExtraAnnotations</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">extraAnnotations</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;avi-lb&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Certain ingress controllers will will require the pathType or path to be set to a different value.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">ImplementationSpecific</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># backend port number</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">servicePort</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># configurationSnippet - Add additional Nginx configuration. This example statically sets a header on the ingress.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># configurationSnippet: |</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">#   more_set_input_headers &#34;X-Forwarded-Host: {{ .Values.hostname }}&#34;;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># options: rancher, letsEncrypt, secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l">secret</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">tls-rancher-ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">### service ###</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Override to use NodePort or LoadBalancer service type - default is ClusterIP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">### LetsEncrypt config ###</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># ProTip: The production environment only allows you to register a name 5 times a week.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#         Use staging until you have your config right.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">letsEncrypt</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># email: none@example.com</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l">production</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ingress</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># options: traefik, nginx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># If you are using certs signed by a private CA set to &#39;true&#39; and set the &#39;tls-ca&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># in the &#39;rancher-system&#39; namespace. See the README.md for details</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">privateCA</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># http[s] proxy server passed into rancher server.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># proxy: http://&lt;username&gt;@&lt;password&gt;:&lt;url&gt;:&lt;port&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># comma separated list of domains or ip addresses that will not use the proxy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">noProxy</span><span class="p">:</span><span class="w"> </span><span class="m">127.0.0.0</span><span class="l">/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,.svc,.cluster.local</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Override rancher image location for Air Gap installs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">rancherImage</span><span class="p">:</span><span class="w"> </span><span class="l">rancher/rancher</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># rancher/rancher image tag. https://hub.docker.com/r/rancher/rancher/tags/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Defaults to .Chart.appVersion</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># rancherImageTag: v2.0.7</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Override imagePullPolicy for rancher server images</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># options: Always, Never, IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Defaults to IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># rancherImagePullPolicy: &lt;pullPolicy&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Number of Rancher server replicas. Setting to negative number will dynamically between 0 and the abs(replicas) based on available nodes.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># of available nodes in the cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Set priorityClassName to avoid eviction</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">priorityClassName</span><span class="p">:</span><span class="w"> </span><span class="l">rancher-critical</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Set pod resource requests/limits for Rancher.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># tls</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#   Where to offload the TLS/SSL encryption</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># - ingress (default)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># - external</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l">ingress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">systemDefaultRegistry</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Set to use the packaged system charts</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">useBundledSystemChart</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Certmanager version compatibility</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">certmanager</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Rancher custom logos persistence</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">customLogos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumeSubpaths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">emberUi</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ember&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">vueUi</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;vue&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">## Volume kind to use for persistence: persistentVolumeClaim, configMap</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">volumeKind</span><span class="p">:</span><span class="w"> </span><span class="l">persistentVolumeClaim</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">## Use an existing volume. Custom logos should be copied to the volume by the user</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># volumeName: custom-logos</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">## Just for volumeKind: persistentVolumeClaim</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c">## To disables dynamic provisioning, set storageClass: &#34;&#34; or storageClass: &#34;-&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># storageClass: &#34;-&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">accessMode</span><span class="p">:</span><span class="w"> </span><span class="l">ReadWriteOnce</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l">1Gi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Rancher post-delete hook</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">postDelete</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l">rancher/shell</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l">v0.1.23</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespaceList</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cattle-fleet-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">cattle-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="l">rancher-operator-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Number of seconds to wait for an app to be uninstalled</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># by default, the job will fail if it fail to uninstall any of the apps</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">ignoreTimeoutError</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Set a bootstrap password. If leave empty, a random password will be generated.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">bootstrapPassword</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;MyPassword&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">livenessProbe</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="m">60</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">readinessProbe</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">global</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cattle</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">psp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># will default to true on 1.24 and below, and false for 1.25 and above</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># can be changed manually to true or false to bypass version checks and force that option</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># helm values to use when installing the rancher-webhook chart.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># helm values set here will override all other global values used when installing the webhook such as priorityClassName and systemRegistry settings.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">webhook</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># helm values to use when installing the fleet chart.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># helm values set here will override all other global values used when installing the fleet chart.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">fleet</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span></code></pre></div><p>I choose secret under TLS, so before I install Rancher I can create the secret with my own certificate.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~$ k create secret -n cattle-system tls tls-rancher-ingress --cert<span class="o">=</span>tls.crt --key<span class="o">=</span>tls.key
</span></span><span class="line"><span class="cl">secret/tls-rancher-ingress created
</span></span></code></pre></div><p>Now I can deploy Rancher with my value.yaml above.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">helm install -n cattle-system rancher rancher-latest/rancher -f rancher.values.yaml
</span></span><span class="line"><span class="cl">NAME: rancher
</span></span><span class="line"><span class="cl">LAST DEPLOYED: Mon May  <span class="m">6</span> 08:24:36 <span class="m">2024</span>
</span></span><span class="line"><span class="cl">NAMESPACE: cattle-system
</span></span><span class="line"><span class="cl">STATUS: deployed
</span></span><span class="line"><span class="cl">REVISION: <span class="m">1</span>
</span></span><span class="line"><span class="cl">TEST SUITE: None
</span></span><span class="line"><span class="cl">NOTES:
</span></span><span class="line"><span class="cl">Rancher Server has been installed.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NOTE: Rancher may take several minutes to fully initialize. Please standby <span class="k">while</span> Certificates are being issued, Containers are started and the Ingress rule comes up.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Check out our docs at https://rancher.com/docs/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">If you provided your own bootstrap password during installation, browse to https://rancher-01.my-domain.net to get started.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">If this is the first <span class="nb">time</span> you installed Rancher, get started by running this <span class="nb">command</span> and clicking the URL it generates:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> https://rancher-01.my-domain.net/dashboard/?setup<span class="o">=</span><span class="k">$(</span>kubectl get secret --namespace cattle-system bootstrap-secret -o go-template<span class="o">=</span><span class="s1">&#39;{{.data.bootstrapPassword|base64decode}}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To get just the bootstrap password on its own, run:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="cl">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template<span class="o">=</span><span class="s1">&#39;{{.data.bootstrapPassword|base64decode}}{{ &#34;\n&#34; }}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Happy Containering!
</span></span></code></pre></div><p>Now its time to log into the the url mentioned above using the provided bootstrap password (if entered):</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506113216096.png"
        alt="first-login"
      />
      
    </figure>
</p>
<p>By entering the bootstrap password above will log you in. If logging out, next time it will look like this:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506113324912.png"
        alt="user-password"
      />
      
    </figure>
</p>
<p>Before going to the next chapter, in my Kubernetes cluster now I will have some additional namespaces created, services and deployments. Below is some of them:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Namespaces</span>
</span></span><span class="line"><span class="cl">NAME                                     STATUS   AGE
</span></span><span class="line"><span class="cl">cattle-fleet-clusters-system             Active   3h9m
</span></span><span class="line"><span class="cl">cattle-fleet-local-system                Active   3h8m
</span></span><span class="line"><span class="cl">cattle-fleet-system                      Active   3h10m
</span></span><span class="line"><span class="cl">cattle-global-data                       Active   3h10m
</span></span><span class="line"><span class="cl">cattle-global-nt                         Active   3h10m
</span></span><span class="line"><span class="cl">cattle-impersonation-system              Active   3h9m
</span></span><span class="line"><span class="cl">cattle-provisioning-capi-system          Active   3h8m
</span></span><span class="line"><span class="cl">cattle-system                            Active   3h24m
</span></span><span class="line"><span class="cl">cluster-fleet-local-local-1a3d67d0a899   Active   3h8m
</span></span><span class="line"><span class="cl">fleet-default                            Active   3h10m
</span></span><span class="line"><span class="cl">fleet-local                              Active   3h10m
</span></span><span class="line"><span class="cl"><span class="nb">local</span>                                    Active   3h10m
</span></span><span class="line"><span class="cl">p-4s8sk                                  Active   3h10m
</span></span><span class="line"><span class="cl">p-n8cmn                                  Active   3h10m
</span></span><span class="line"><span class="cl"><span class="c1"># Deployments and services</span>
</span></span><span class="line"><span class="cl">NAME                                   READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="cl">pod/helm-operation-9bzv8               0/2     Completed   <span class="m">0</span>          3m22s
</span></span><span class="line"><span class="cl">pod/helm-operation-bvjrq               0/2     Completed   <span class="m">0</span>          8m10s
</span></span><span class="line"><span class="cl">pod/helm-operation-njvlg               0/2     Completed   <span class="m">0</span>          8m22s
</span></span><span class="line"><span class="cl">pod/rancher-5498b85476-bpfcn           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="cl">pod/rancher-5498b85476-j6ggn           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="cl">pod/rancher-5498b85476-xg247           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="cl">pod/rancher-webhook-7d876fccc8-6m8tk   1/1     Running     <span class="m">0</span>          8m7s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAME                      TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>          AGE
</span></span><span class="line"><span class="cl">service/rancher           ClusterIP   10.10.227.75   &lt;none&gt;        80/TCP,443/TCP   9m26s
</span></span><span class="line"><span class="cl">service/rancher-webhook   ClusterIP   10.10.81.6     &lt;none&gt;        443/TCP          8m8s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAME                              READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class="line"><span class="cl">deployment.apps/rancher           3/3     <span class="m">3</span>            <span class="m">3</span>           9m27s
</span></span><span class="line"><span class="cl">deployment.apps/rancher-webhook   1/1     <span class="m">1</span>            <span class="m">1</span>           8m9s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAME                                         DESIRED   CURRENT   READY   AGE
</span></span><span class="line"><span class="cl">replicaset.apps/rancher-5498b85476           <span class="m">3</span>         <span class="m">3</span>         <span class="m">3</span>       9m26s
</span></span><span class="line"><span class="cl">replicaset.apps/rancher-webhook-7d876fccc8   <span class="m">1</span>         <span class="m">1</span>         <span class="m">1</span>       8m8s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NAME      CLASS    HOSTS                        ADDRESS          PORTS     AGE
</span></span><span class="line"><span class="cl">rancher   avi-lb   rancher-01.my-domain.net   192.168.121.10   80, <span class="m">443</span>   9m47s
</span></span></code></pre></div><p>Rancher is ready to be used.</p>


<h2 class="relative group">Create and manage Kubernetes clusters 
    <div id="create-and-manage-kubernetes-clusters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-and-manage-kubernetes-clusters" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As soon as I have logged in the first thing I would like to do is to create a Kubernetes cluster. Rancher supports many methods of creating a Kubernetes cluster. Rancher can create clusters in a hosted Kubernetes provider such as Amazon EKS, Azure AKS, Google GKE and more. Rancher can create clusters and provision the nodes on Amazon EC2, Azure, DigitalOcean, Harvester, Linode, VMware vSphere and more. If you dont use any of them, it can create clusters on exisiting nodes like VMs deployed with a Linux (or even Windows..) OS waiting to be configured to do something (I will go through that later) or using <a href="https://elemental.docs.rancher.com/" target="_blank">Elemental</a> (more on that later also).</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506215803466.png"
        alt="create-clusters"
      />
      
    </figure>
</p>
<p>Under drivers, see the list of possible Cluster Drivers and Node Drivers:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220220902.png"
        alt="cluster-drivers"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220250915.png"
        alt="node-drivers"
      />
      
    </figure>
</p>
<p>I happen to have vSphere as my virtualization platform which is natively supported by Rancher and will start by provisioning a Kubernetes cluster using the vSphere cloud. I also have another hypervisor platform running in my lab (Proxmox) which does not have a native driver for Rancher, instead I will make Rancher deploy Kubernetes on existing VM nodes. I will go through how I deploy Kubernetes clusters on vSphere and on Proxmox using the <em>Custom</em> &ldquo;cloud&rdquo; on existing nodes.</p>


<h3 class="relative group">Rancher Kubernetes distributions 
    <div id="rancher-kubernetes-distributions" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rancher-kubernetes-distributions" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Rancher is fully capable of doing automated provisining of Kubernetes clusters, as I will go through in this post, as much as it can manage already exisiting Kubernetes clusters by importing them.</p>
<p>When Rancher is doing automated provisions of Kubernetes on supported clouds or onto existing nodes it uses its own Kubernetes distribution. In Rancher one can choose between three distributions called RKE, RKE2 and K3s. In this post I will only use RKE2 which stands for Rancher Kubernetes Engine. RKE2 is Rancher&rsquo;s <em>next-generation</em> Kubernetes distribution. I may touch upon the K3s distribution also, as this is very much focused on edge use cases due to its lightweight.</p>
<p>For more information on RKE2 head over <a href="https://docs.rke2.io/" target="_blank">here</a></p>
<p>For more information on K3s head over <a href="https://www.rancher.com/products/k3s" target="_blank">here</a></p>
<p>At the current time of writing this post I am using Rancher 2.8.3 and the latest RKE2/Kubernetes release is 1.28.8 which is not so far away from Kubernetes upstream which is currently at v1.30.</p>


<h2 class="relative group">Create RKE2 clusters using vSphere 
    <div id="create-rke2-clusters-using-vsphere" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-rke2-clusters-using-vsphere" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Using vSphere as the &ldquo;cloud&rdquo; in Rancher do have some benefits. From the docs</p>
<p>For Rancher to spin up and create RKE2 clusters on vSphere I need to create a VM template using the OS of choice in my vSphere cluster. According to the official RKE2 <a href="https://docs.rke2.io/install/requirements#operating-systems" target="_blank">documentation</a> <em>RKE2 should work on any Linux distribution that uses systemd and iptables</em>. There is also a RKE2 Support Matrix for all OS versions that have been validated with RKE2 <a href="https://www.suse.com/suse-rke2/support-matrix/all-supported-versions/rke2-v1-28/" target="_blank">here</a> (linked to v1.28 as this post uses 1.28 but v1.29 is already out at the time of writing this post).</p>
<p>I went with Ubuntu 22.04 as my Linux distribution</p>
<p>There is a couple of ways Rancher can utilize vSphere to manage the template. Below is a screenshot of the possible options of the time of writing this post:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240508233641430.png"
        alt="deployment-methods"
      />
      
    </figure>
</p>
<p>In this section I will go through the two methods <strong>Deploy from template: Content Library</strong> and <strong>deploy from template: Data Center</strong></p>


<h3 class="relative group">Create Cloud Credentials 
    <div id="create-cloud-credentials" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#create-cloud-credentials" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The first thing I will do before getting to the actual cluster creation is to create credentials for the user and connection information to my vCenter server. I will go to the Cluster Management and Cloud Credentials section in Rancher:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509001856987.png"
        alt="cloud-credentials"
      />
      
    </figure>
</p>
<p>Click create in the top right corner and select VMware vSphere:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002004160.png"
        alt="vsphere"
      />
      
    </figure>
</p>
<p>Fill in the relevant information about your vCenter server including the credentials with the right permissions (see permissions <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/launch-kubernetes-with-rancher/use-new-nodes-in-an-infra-provider/vsphere/create-credentials" target="_blank">here</a> using some very old screenshots from vCenter..):</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002145078.png"
        alt="vcenter-info"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002408912.png"
        alt="credentials-created"
      />
      
    </figure>
</p>


<h3 class="relative group">RKE2 clusters using vSphere Content Library template 
    <div id="rke2-clusters-using-vsphere-content-library-template" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rke2-clusters-using-vsphere-content-library-template" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I decided to start with the method of deploying RKE2 clusters using the Content Library method as I found that one to be the easiest and fastest method (its just about uploading the image to the content library and thats it). The concept behind this is to create a Content Library in your vCenter hosting a Cloud Image template for the OS of choice. This should be as minimal as possible, with zero to none configs. All the needed configs are done by Rancher when adding the nodes to your cluster later.</p>
<p>As mentioned above, I went with Ubuntu Cloud image. Ubuntu Cloud images can be found <a href="https://cloud-images.ubuntu.com/" target="_blank">here</a>.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240508220123400.png"
        alt="cloud-images"
      />
      
    </figure>
</p>
<p>I will go with this OVA image (22.04 LTS Jammy Jellyfish):</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240508220225820.png"
        alt="jammy-cloud-image-ova"
      />
      
    </figure>
</p>
<p>In my vCenter I create a Content Library:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240508235953618.png"
        alt="content-lib-create"
      />
      
    </figure>
</p>
<p>Local content library:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000026841.png"
        alt="local-content"
      />
      
    </figure>
</p>
<p>Select my datastore to host the content:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000126128.png"
        alt="content-datastore"
      />
      
    </figure>
</p>
<p>Finish:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000149484.png"
        alt="content-library-created"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000233597.png"
        alt="content-library"
      />
      
    </figure>
</p>
<p>Now I need to enter the content library by clicking on the name to add my desired Ubuntu Cloud Image version:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000417561.png"
        alt="import-items"
      />
      
    </figure>
</p>
<p>I will select Source File URL and paste the below URL:</p>
<p><a href="https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.ova" target="_blank">https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.ova</a></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000545222.png"
        alt="import"
      />
      
    </figure>
</p>
<p>Click on Import and it will download the OVA from the URL</p>
<p>It may complain about SSL certificate being untruste.. Click Actions and Continue:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000656514.png"
        alt="continue"
      />
      
    </figure>
</p>
<p>The template should be downloading now:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000742764.png"
        alt="downloading"
      />
      
    </figure>
</p>
<p>Thats it from the vCenter side. The cloud image is ready as a template for Rancher to use. Now I will head over to Rancher and create my RKE2 cluster on vSphere based on this template.</p>
<p>I will go to Cluster Management using the top left menu or directy from the homepage clicking on manage</p>
<p>As I have done the preparations in vSphere I am now ready to create my RKE2 cluster on vSphere. Head to Clusters in the top left corner and click create in the top right corner then select VMware vSphere:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002529003.png"
        alt="vSphere-cloud"
      />
      
    </figure>
</p>
<p>The cluster I want to create is one control-plane node and one worker node.</p>
<p>Give the cluster a name and description if you want. Then select the roles, at a minimum one have to deploy one node with all roles <em>etcd</em>, <em>Control Plane</em> and <em>Worker</em>. Give the pool a name, I will go with default values here. Machine count I will go with default 1 here also. I can scale it later &#x1f604;. Then make sure to select the correct datacenter in your vCenter, select the Resource Pool. If you have resource pools, if not just select the correct cluster (sfo-m01-cl01)/Resources which will be the cluster resource pool (root). Then select the correct Datastore. Then I will left the other fields default except the Creation method and Network. Under creation method I have selected <strong>Deploy from template: Content Library</strong> the correct Content Library and the <strong>jammy-server-cloudimg</strong> template I have uploaded/downloaded to the Content Library. Click Add Network and select the correct vCenter Network Portgroup you want the node to be placed in.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002845862.png"
        alt="node-pool1"
      />
      
    </figure>
</p>
<p>Thats it for pool-1. I will scroll a bit down, click on the + sign and add a second pool for the nodes to have only the role worker.</p>
<p>I will repeat the steps above for pool-2. They will be identical except for the pool name and only role <strong>Worker</strong> selected.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509003712557.png"
        alt="plus-to-add-pool"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509003856064.png"
        alt="pool-2"
      />
      
    </figure>
</p>
<p>For the sake of keeping it simple, I will leave all the other fields default and just click create. I will now sit back and enjoy Rancher creating my RKE2 cluster on vSphere.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509004028543.png"
        alt="create"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509004328959.png"
        alt="cluster-creation-in-progress"
      />
      
    </figure>
</p>
<p>In vCenter:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509005651880.png"
        alt="content-library-being-used"
      />
      
    </figure>
</p>
<p>And cluster is ready:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509010740012.png"
        alt="ready"
      />
      
    </figure>
</p>
<p>There was of course a bunch of option I elegantly skipped during the creation of this cluster. But the point, again, was to show how quickly and easily I could bring up a RKE2 cluster on vSphere. And so it was.</p>
<p><strong>Supplemental information</strong></p>
<p>To make further customization of the Ubuntu Cloud Image one can use the #cloud-config (<a href="https://cloud-init.io/" target="_blank">cloud-init</a>), and the vSphere vApp function.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011206653.png"
        alt="cloud-config"
      />
      
    </figure>
</p>
<p>vApp:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011229727.png"
        alt="image-20240509011229727"
      />
      
    </figure>
</p>
<p>When it comes to the Ubuntu Cloud Image it does not contain any default username and password. So how can I access SSH on them? Well, from the Rancher UI one can access SSH directly or download the SSH keys. One can even copy paste into the SSH shell from there. SSH through the UI is very neat feature.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011635979.png"
        alt="node-operations"
      />
      
    </figure>
</p>
<p>SSH Shell:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011829741.png"
        alt="ssh-shell"
      />
      
    </figure>
</p>
<p>For IP allocation I have configured DHCP in my NSX-T environment for the segment my RKE2 nodes will be placed in and all nodes will use dynamically allocated IP addresses in that subnet.</p>


<h3 class="relative group">RKE2 clusters using vSphere VM template 
    <div id="rke2-clusters-using-vsphere-vm-template" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rke2-clusters-using-vsphere-vm-template" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The other method of preparing a template for Rancher to use is to install the Ubuntu Server as a regular VM. That involves doing the necessary configs, power it down and convert it to template. I thought this would mean a very minimal config to be done. But not quite.</p>
<p>My first attempt did not go so well. I installed Ubuntu, then powered it down and converted it to a template. Tried to create a RKE2 cluster with it from Rancher, it cloned the amount of control plane nodes and worker nodes I had defined, but there it stopped. So I figured I must have missed something along the way.</p>
<p>Then I found this post <a href="https://dev.to/balajivedagiri/provisioning-an-rke2-cluster-on-vsphere-13mh" target="_blank">here</a> which elegantly described the things I need in my template before &ldquo;handing&rdquo; it over to Rancher. So below is what I did in my Ubuntu Template by following the blog <a href="https://dev.to/balajivedagiri/provisioning-an-rke2-cluster-on-vsphere-13mh" target="_blank">post</a> above.</p>
<p>In short, this is what I did following the post above.</p>
<p>On my template:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install -y curl wget git net-tools unzip ca-certificates cloud-init cloud-guest-utils cloud-image-utils cloud-initramfs-growroot open-iscsi openssh-server open-vm-tools net-tools apparmor
</span></span></code></pre></div><p>and:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo dpkg-reconfigure cloud-init
</span></span></code></pre></div><p>Deselected everything except &ldquo;NoCloud&rdquo;</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507105845272.png"
        alt=""
      />
      
    </figure>
</p>
<p>Then I ran the script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># Cleaning logs.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/audit/audit.log <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  cat /dev/null &gt; /var/log/audit/audit.log
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/wtmp <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  cat /dev/null &gt; /var/log/wtmp
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/lastlog <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  cat /dev/null &gt; /var/log/lastlog
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cleaning udev rules.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /etc/udev/rules.d/70-persistent-net.rules <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  rm /etc/udev/rules.d/70-persistent-net.rules
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cleaning the /tmp directories</span>
</span></span><span class="line"><span class="cl">rm -rf /tmp/*
</span></span><span class="line"><span class="cl">rm -rf /var/tmp/*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cleaning the SSH host keys</span>
</span></span><span class="line"><span class="cl">rm -f /etc/ssh/ssh_host_*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cleaning the machine-id</span>
</span></span><span class="line"><span class="cl">truncate -s <span class="m">0</span> /etc/machine-id
</span></span><span class="line"><span class="cl">rm /var/lib/dbus/machine-id
</span></span><span class="line"><span class="cl">ln -s /etc/machine-id /var/lib/dbus/machine-id
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cleaning the shell history</span>
</span></span><span class="line"><span class="cl"><span class="nb">unset</span> HISTFILE
</span></span><span class="line"><span class="cl"><span class="nb">history</span> -cw
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> &gt; ~/.bash_history
</span></span><span class="line"><span class="cl">rm -fr /root/.bash_history
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Truncating hostname, hosts, resolv.conf and setting hostname to localhost</span>
</span></span><span class="line"><span class="cl">truncate -s <span class="m">0</span> /etc/<span class="o">{</span>hostname,hosts,resolv.conf<span class="o">}</span>
</span></span><span class="line"><span class="cl">hostnamectl set-hostname localhost
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Clean cloud-init</span>
</span></span><span class="line"><span class="cl">cloud-init clean -s -l
</span></span></code></pre></div><p>Powered off the VM, converted it to a template in vSphere.</p>
<div class="notice info">
<p>Still after doing the steps described in the post linked to above my deployment failed. It turned out to be insufficient disk capacity. So I had to update my template in vSphere to use bigger disk. I was too conservative (or cheap) when I created it, I extended it to 60gb to be on the safe side. Could that have been a &ldquo;no-issue&rdquo; if I had read the official <a href="https://docs.rke2.io/install/requirements" target="_blank">documentation/requirements</a>, yes.</p>
</div>
<p>I saw that when I connected to the control plane and checked the cattle-cluster-agent (it never started):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">andreasm@linuxmgmt01:~/$ k --kubeconfig test-cluster.yaml describe pod -n cattle-system cattle-cluster-agent-5cc77b7988-dwrtj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Name</span><span class="p">:</span><span class="w">             </span><span class="l">cattle-cluster-agent-5cc77b7988-dwrtj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Namespace</span><span class="p">:</span><span class="w">        </span><span class="l">cattle-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">Events</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">Type     Reason                  Age                    From               Message</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>---- <span class="w">    </span>------ <span class="w">                 </span>---- <span class="w">                  </span>---- <span class="w">              </span>-------<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">Warning  Failed                  6m24s                  kubelet            Failed to pull image &#34;rancher/rancher-agent:v2.8.3&#34;: failed to pull and unpack image &#34;docker.io/rancher/rancher-agent:v2.8.3&#34;: failed to extract layer sha256:3a9df665b61dd3e00c0753ca43ca9a0828cb5592ec051048b4bbc1a3f4488e05: write /var/lib/rancher/rke2/agent/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/108/fs/var/lib/rancher-data/local-catalogs/v2/rancher-partner-charts/8f17acdce9bffd6e05a58a3798840e408c4ea71783381ecd2e9af30baad65974/.git/objects/pack/pack-3b07a8b347f63714781c345b34c0793ec81f2b86.pack: no space left on device: unknown</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Warning  Failed                  6m24s                  kubelet            Error</span><span class="p">:</span><span class="w"> </span><span class="l">ErrImagePull</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">Warning  FailedMount             4m15s (x5 over 4m22s)  kubelet            MountVolume.SetUp failed for volume &#34;kube-api-access-cvwz2&#34; : failed to fetch token: Post &#34;https://127.0.0.1:6443/api/v1/namespaces/cattle-system/serviceaccounts/cattle/token&#34;: dial tcp 127.0.0.1:6443: connect: connection refused</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">Normal   Pulling                 4m7s                   kubelet            Pulling image &#34;rancher/rancher-agent:v2.8.3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">Warning  Evicted                 3m59s                  kubelet            The node was low on resource: ephemeral-storage. Threshold quantity: 574385774, available</span><span class="p">:</span><span class="w"> </span><span class="l">108048Ki.</span><span class="w">
</span></span></span></code></pre></div><p>After doing the additional changes in my template I gave the RKE2 cluster creation another attempt.</p>
<p>From the Cluster Management, click Create</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220544660.png"
        alt="create"
      />
      
    </figure>
</p>
<p>Select VMware vSphere:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220614627.png"
        alt="vsphere"
      />
      
    </figure>
</p>
<p>I will start by defining &ldquo;pool-1&rdquo; as my 3 control plane nodes. Select vCenter Datacenter, Datastore and resource pool (if no resource pool is defined in vCenter, select just Resources which is &ldquo;root&rdquo;/cluster-level)</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506221613295.png"
        alt="pool-1"
      />
      
    </figure>
</p>
<p>Then define the &ldquo;pool-1&rdquo; instance options like cpu, memory, disk, network and the created vm template:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506231625901.png"
        alt="instance-1"
      />
      
    </figure>
</p>
<p>Add a second pool by clicking on the + sign here:</p>
<img src=images/image-20240506223316563.png style="width:500px" /> 
<p>Then confgure the amount of Machine count, roles (worker only) and vSphere placement as above (unless one have several clusters and want to distribute the workers.. That is another discussion).</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506223445557.png"
        alt="pool-2-2"
      />
      
    </figure>
</p>
<p>Configure the pool-2 instance cpu, memory, network, vm template etc.. Here one can define the workers to be a bit more beefier (resource wise) than the control plane nodes.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506231800970.png"
        alt="pool-2-3"
      />
      
    </figure>
</p>
<p>Then it is the cluster config itself. There is a lot of details I will not cover now, will cover these a bit later. Now the sole purpose is to get a cluster up and running as easy and fast as possible. I will leave everything default, except pod CIDR and service CIDR. Will get into some more details later in the post.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506223906595.png"
        alt="cluster-config-1"
      />
      
    </figure>
</p>
<p>Pod CIDR and Service CIDR</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506224042794.png"
        alt="cluster-config-2"
      />
      
    </figure>
</p>
<p>When done, click create bottom right corner.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506224209849.png"
        alt="image-20240506224209849"
      />
      
    </figure>
</p>
<p>From vCenter:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506232010931.png"
        alt="vms-reconfigured-powering-on"
      />
      
    </figure>
</p>
<p>Here is my cluster starting to be built.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240506232040851.png"
        alt="vms-powered-on"
      />
      
    </figure>
</p>
<p>Rancher cluster creation status</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507134729148.png"
        alt="status-1"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507134755776.png"
        alt="status-2"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507140438861.png"
        alt="ready"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507140941899.png"
        alt="status-complete"
      />
      
    </figure>
</p>
<p>Thats it. Cluster is up and running. There was a couple of additional tasks that needed to be done, but it worked. If one does not have the option to use a Cloud Image, then this will also work. The experience using a Cloud Image was by far the easiest and most flexible approach.</p>


<h2 class="relative group">Creating a RKE2 cluster on existing nodes - non native cloud provider 
    <div id="creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>If I dont have a vSphere environment or other supported Cloud provider, but another platform for my virtalization needs, one alternative is then to prepare some VMs with my preferred operating system I can tell Rancher to deploy RKE2 on. The provisioning and managing of these VMs will be handled by OpenTofu. Lets see how that works.</p>
<p>I have already a <a href="https://blog.andreasm.io/2024/01/15/proxmox-with-opentofu-kubespray-and-kubernetes/" target="_blank">post</a> covering how I am deploying VMs and Kubernetes using OpenTofu and Kubespray on my Proxmox cluster. For this section I will use the OpenTofu part just to quickly deploy the VMs on Proxmox I need to build or bring up my Kubernetes (RKE2) cluster.</p>
<p>My OpenTofu project is already configured, it should deploy 6 VMs, 3 control plane nodes and 3 workers. I will kick that task off like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/terraform/proxmox/rancher-cluster-1$ tofu apply plan
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_file.ubuntu_cloud_init: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_file.ubuntu_cloud_init: Creation <span class="nb">complete</span> after 1s <span class="o">[</span><span class="nv">id</span><span class="o">=</span>local:snippets/ubuntu.cloud-config.yaml<span class="o">]</span>
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>0<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>1<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>1<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>0<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creation <span class="nb">complete</span> after 1m37s <span class="o">[</span><span class="nv">id</span><span class="o">=</span>1023<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Apply complete! Resources: <span class="m">7</span> added, <span class="m">0</span> changed, <span class="m">0</span> destroyed.
</span></span></code></pre></div><p>And my vms should start popping up in my Proxmox ui:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507161104692.png"
        alt="soon-to-be-rke-nodes-proxmox"
      />
      
    </figure>
</p>
<p>Now I have some freshly installed VMs running, it is time to hand them over to Rancher to do some magic on them. Lets head over to Rancher and create a Custom cluster.</p>


<h3 class="relative group">Creating RKE2 cluster on existing nodes - &ldquo;custom cloud&rdquo; 
    <div id="creating-rke2-cluster-on-existing-nodes---custom-cloud" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#creating-rke2-cluster-on-existing-nodes---custom-cloud" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>In Rancher, go to Cluster Management or from the homepage, <strong>create</strong> and select <strong>Custom</strong></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507161939708.png"
        alt="custom-cluster"
      />
      
    </figure>
</p>
<p>Give the cluster a name, and change what you want according to your needs. I will only change the Container Network and the pod/services CIDR.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507184317985.png"
        alt="rke2-cluster-proxmox"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162547885.png"
        alt="rke2-cluster-proxmox-2"
      />
      
    </figure>
</p>
<p>Click create:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162615075.png"
        alt="create"
      />
      
    </figure>
</p>
<p>Now it will tell you to paste a registration command on the node you want to be the controlplane, etc and worker node.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162749161.png"
        alt="registration-command"
      />
      
    </figure>
</p>
<p>Click on the cli command to get it into the clipboard. I will start by preparing the first node with all three roles <em>control-plane</em>, <em>etcd</em> and <em>worker</em>. Then I will continue with the next two. After my controlplane is ready and consist of three nodes I will change the parameter to only include worker node and do the last three nodes.</p>
<p>Then go ahead and ssh into my intented control plane node and paste the command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ubuntu@ubuntu:~$ curl -fL https://rancher-dev.my-domain.net/system-agent-install.sh <span class="p">|</span> sudo  sh -s - --server https://rancher-dev.my-domain.net --label <span class="s1">&#39;cattle.io/os=linux&#39;</span> --token p5fp6sv4qbskmhl7mmpksbxcgs9gk9dtsqkqg9q8q8ln5f56l5jlpb --etcd --controlplane --worker
</span></span><span class="line"><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="cl"><span class="m">100</span> <span class="m">32228</span>    <span class="m">0</span> <span class="m">32228</span>    <span class="m">0</span>     <span class="m">0</span>   368k      <span class="m">0</span> --:--:-- --:--:-- --:--:--  370k
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Label: cattle.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: etcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: controlplane
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: worker
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent configuration directory /etc/rancher/agent
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent var directory /var/lib/rancher/agent
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully tested Rancher connection
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent binary from https://rancher-dev.my-domain.net/assets/rancher-system-agent-amd64
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent binary.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent-uninstall.sh script from https://rancher-dev.my-doamin.net/assets/system-agent-uninstall.sh
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent-uninstall.sh script.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Generating Cattle ID
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded Rancher connection information
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  systemd: Creating service file
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Creating environment file /etc/systemd/system/rancher-system-agent.env
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Enabling rancher-system-agent.service
</span></span><span class="line"><span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/rancher-system-agent.service  /etc/systemd/system/rancher-system-agent.service.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Starting/restarting rancher-system-agent.service
</span></span><span class="line"><span class="cl">ubuntu@ubuntu:~$
</span></span></code></pre></div><p>Now, lets just wait in the Rancher UI and monitor the progress.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507175908266.png"
        alt="status-opentofu-cluster"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180132180.png"
        alt="done"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180155419.png"
        alt="green"
      />
      
    </figure>
</p>
<p>Repeat same operation for the two last control plane nodes.</p>
<p>For the worker nodes I will adjust the command to only deploy worker node role:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180445251.png"
        alt="worker-node"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ubuntu@ubuntu:~$ curl -fL https://rancher-dev.my-domain.net/system-agent-install.sh <span class="p">|</span> sudo  sh -s - --server https://rancher-dev.my-domain.net --label <span class="s1">&#39;cattle.io/os=linux&#39;</span> --token jfjd5vwfdqxkszgg25m6w49hhm4l99kjk2xhrm2hp75dvwhrjnrt2d --worker
</span></span><span class="line"><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="cl"><span class="m">100</span> <span class="m">32228</span>    <span class="m">0</span> <span class="m">32228</span>    <span class="m">0</span>     <span class="m">0</span>   370k      <span class="m">0</span> --:--:-- --:--:-- --:--:--  374k
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Label: cattle.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: worker
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent configuration directory /etc/rancher/agent
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent var directory /var/lib/rancher/agent
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully tested Rancher connection
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent binary from https://rancher-dev.my-domain.net/assets/rancher-system-agent-amd64
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent binary.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent-uninstall.sh script from https://rancher-dev.my-doamin.net/assets/system-agent-uninstall.sh
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent-uninstall.sh script.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Generating Cattle ID
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded Rancher connection information
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  systemd: Creating service file
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Creating environment file /etc/systemd/system/rancher-system-agent.env
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Enabling rancher-system-agent.service
</span></span><span class="line"><span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/rancher-system-agent.service  /etc/systemd/system/rancher-system-agent.service.
</span></span><span class="line"><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Starting/restarting rancher-system-agent.service
</span></span></code></pre></div><p>Repeat for all the worker nodes needed.</p>
<p>After some minutes, the cluster should be complete with all control plane nodes and worker nodes:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240508164728679.png"
        alt="cluster-ready"
      />
      
    </figure>
</p>
<p>The whole process, two tasks really, from deploying my six VMs to a fully working Kubernetes cluster running was just shy of 10 minutes. All I had to do was to provison the VMs, go into Rancher create a RKE2 cluster, execute the registration command on each node.</p>
<p>Deploying Kubernetes clusters couldn&rsquo;t be more fun actually.</p>


<h2 class="relative group">Import existing Kubernetes Clusters 
    <div id="import-existing-kubernetes-clusters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#import-existing-kubernetes-clusters" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>As mentioned earlier, Rancher can also import existing Kubernetes clusters for central management. If one happen to have a bunch of Kubernetes clusters deployed, no central management of them, add them to Rancher.</p>
<p>Here is how to import existing Kubernetes clusters.</p>
<p>Head over to Cluster Management in the Rancher UI, go to Clusters and find the <em>Import Existing</em> button:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101644242.png"
        alt="import-existing"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101716841.png"
        alt="Generic"
      />
      
    </figure>
</p>
<p>I will select Generic as I dont have any clusters running in Amazon, Azure nor Google.</p>
<p>Give the cluster a name (name as it will show in Rancher <em>and ignore my typo tanzuz</em>) and description. I am using the default admin account in Rancher.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101919752.png"
        alt="name-cluster"
      />
      
    </figure>
</p>
<p>Click create in the bottom right corner.</p>
<p>It will now show me how I can register my already existing cluster into Rancher:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102041261.png"
        alt="import-kubectl"
      />
      
    </figure>
</p>
<p>Now I need to get into the context of the Kubernetes cluster I want to import and execute the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl apply -f https://rancher-dev.my-domain.net/v3/import/knkh9n4rvhgpkxxxk7c4rhblhkqxfjxcq82nm7zcgfdcgqsl7bqdg5_c-m-qxpbc6tp.yaml
</span></span></code></pre></div><p>In the correct context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~$ kubectl apply -f https://rancher-dev.my-domain.net/v3/import/knkh9n4rvhgpkxxxk7c4rhblhkqxfjxcq82nm7zcgfdcgqsl7bqdg5_c-m-qxpbc6tp.yaml
</span></span><span class="line"><span class="cl">clusterrole.rbac.authorization.k8s.io/proxy-clusterrole-kubeapiserver created
</span></span><span class="line"><span class="cl">clusterrolebinding.rbac.authorization.k8s.io/proxy-role-binding-kubernetes-master created
</span></span><span class="line"><span class="cl">Warning: resource namespaces/cattle-system is missing the kubectl.kubernetes.io/last-applied-configuration annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation will be patched automatically.
</span></span><span class="line"><span class="cl">namespace/cattle-system configured
</span></span><span class="line"><span class="cl">serviceaccount/cattle created
</span></span><span class="line"><span class="cl">clusterrolebinding.rbac.authorization.k8s.io/cattle-admin-binding created
</span></span><span class="line"><span class="cl">secret/cattle-credentials-603e85e created
</span></span><span class="line"><span class="cl">clusterrole.rbac.authorization.k8s.io/cattle-admin created
</span></span><span class="line"><span class="cl">Warning: spec.template.spec.affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms<span class="o">[</span>0<span class="o">]</span>.matchExpressions<span class="o">[</span>0<span class="o">]</span>.key: beta.kubernetes.io/os is deprecated since v1.14<span class="p">;</span> use <span class="s2">&#34;kubernetes.io/os&#34;</span> instead
</span></span><span class="line"><span class="cl">deployment.apps/cattle-cluster-agent created
</span></span><span class="line"><span class="cl">service/cattle-cluster-agent created
</span></span></code></pre></div><p>In the Rancher UI:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102515887.png"
        alt="cluster-imported"
      />
      
    </figure>
</p>
<p>It took a couple of seconds, and the cluster was imported.</p>
<p>Now just having a look around.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102738378.png"
        alt="first-glance"
      />
      
    </figure>
</p>
<p>Nodes:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103535894.png"
        alt="nodes"
      />
      
    </figure>
</p>
<p>Doing kubectl from the UI:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102842910.png"
        alt="kubectl-from-ui"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103027863.png"
        alt="storage-classes"
      />
      
    </figure>
</p>


<h2 class="relative group">Navigating the Rancher UI 
    <div id="navigating-the-rancher-ui" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#navigating-the-rancher-ui" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>So far I have only created and imported clusters into Rancher. The current inventory in Rancher is a couple of clusters both imported and created by Rancher:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103337593.png"
        alt="Clusters"
      />
      
    </figure>
</p>
<p>Its time to explore Rancher.</p>
<p>What is the information Rancher can give me on my new RKE2 cluster. Lets click around.</p>
<p>Click on <em>Explore</em></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507141639433.png"
        alt="explore"
      />
      
    </figure>
</p>


<h3 class="relative group">Rancher Cluster Dashboard 
    <div id="rancher-cluster-dashboard" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#rancher-cluster-dashboard" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The first thing I get to when clicking on <em>Explore</em> is the Cluster Dashboard. It contains a brief status of the cluster like CPU and Memory usage, total resources, pods running (55 of 660?) and latest events. Very nice set of information.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142216636.png"
        alt="cluster-dashboard"
      />
      
    </figure>
</p>
<p>But in the top right corner, what have we there? Install Monitoring and Add Cluster Badge. Lets try the Cluster Badge</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142721055.png"
        alt="cluster-badge"
      />
      
    </figure>
</p>
<p>I can customize the cluster badge.. Lets see how this looks like</p>
<p>It adds a color and initials on the cluster list on the left side menu, making it easy to distinguish and sort the different Kubernetes clusters.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142908603.png"
        alt="with-badge"
      />
      
    </figure>
</p>
<p>Now, what about the Install Monitoring.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507143047488.png"
        alt="candy"
      />
      
    </figure>
</p>
<p>A set of available monitoring tools, ready to be installed. This is really great, and qualifies for dedicated sections later in this post.</p>
<p>On left side menu, there is additional information:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507150707248.png"
        alt="left-side-menu"
      />
      
    </figure>
</p>
<p>Pods:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507150901820.png"
        alt="pods"
      />
      
    </figure>
</p>
<p>What about executing directly into shell of a pod?</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507153519566.png"
        alt="pod-exec"
      />
      
    </figure>
</p>
<p>Nodes:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507151005533.png"
        alt="nodes"
      />
      
    </figure>
</p>
<p>ConfigMaps:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507151128892.png"
        alt="configmaps"
      />
      
    </figure>
</p>
<p>I have an action menu on every object available in the left side menus, I can edit configMaps, secrets, drain node etc right there from the Rancher UI.</p>
<p>If I know the object name, I can just search for it also:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507153838802.png"
        alt="search"
      />
      
    </figure>
</p>
<p>So much information readily available directly after deploying the cluster. This was just a quick overview, there are several more fields to explore.</p>


<h3 class="relative group">Accessing my new RKE2 cluster deployed on vSphere 
    <div id="accessing-my-new-rke2-cluster-deployed-on-vsphere" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#accessing-my-new-rke2-cluster-deployed-on-vsphere" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Now that my clusters is up and running, how can I access it? SSH into one of the control plane nodes and grab the kubeconfig? Well that is possible, but is it a better way?</p>
<p>Yes it is&hellip;</p>
<p>Click on the three dots at the end of the cluster:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507141220328.png"
        alt="three-dots"
      />
      
    </figure>
</p>
<p>Lets try the <strong>Kubectl Shell</strong></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240507154958703.png"
        alt="kubectl-shell"
      />
      
    </figure>
</p>
<p>Or just copy the KubeConfig to Clipboard, paste it in a file on your workstation and access your cluster like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/$ k get nodes -owide
</span></span><span class="line"><span class="cl">NAME                                  STATUS   ROLES                              AGE    VERSION          INTERNAL-IP       EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION       CONTAINER-RUNTIME
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool1-47454a8f-6npvs   Ready    control-plane,etcd,master,worker   127m   v1.28.8+rke2r1   192.168.150.98    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool1-47454a8f-9tv65   Ready    control-plane,etcd,master,worker   123m   v1.28.8+rke2r1   192.168.150.54    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool1-47454a8f-xpjqf   Ready    control-plane,etcd,master,worker   121m   v1.28.8+rke2r1   192.168.150.32    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool2-b5e2f49f-2mr5r   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.97    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool2-b5e2f49f-9qnl2   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.99    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">rke2-cluster-1-pool2-b5e2f49f-tfw2x   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.100   &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/$ k get pods -A
</span></span><span class="line"><span class="cl">NAMESPACE             NAME                                                           READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="cl">cattle-fleet-system   fleet-agent-595ff97fd6-vl9t4                                   1/1     Running     <span class="m">0</span>          124m
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-6bb5b4f9c6-br6lk                          1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-6bb5b4f9c6-t5822                          1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">cattle-system         rancher-webhook-bcc8984b6-9ztqj                                1/1     Running     <span class="m">0</span>          122m
</span></span><span class="line"><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-6npvs   1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-9tv65   1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-xpjqf   1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-6npvs                       1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-9tv65                       1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-xpjqf                       1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-canal-4cxc6                                  0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-coredns-vxvpj                                0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-ingress-nginx-f5g88                          0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-metrics-server-66rff                         0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-9ncn6                0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-rrhbw                    0/1     Completed   <span class="m">1</span>          127m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-jxgr5            0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-6npvs             1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-9tv65             1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-xpjqf             1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-6npvs    1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-9tv65    1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-xpjqf    1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-6npvs                 1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-9tv65                 1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-xpjqf                 1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-2mr5r                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-9qnl2                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-tfw2x                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-6npvs             1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-9tv65             1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-xpjqf             1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-7lmxr                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-cmrm2                                               2/2     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-f9ztm                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-gptjt                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-p9dj4                                               2/2     Running     <span class="m">0</span>          121m
</span></span><span class="line"><span class="cl">kube-system           rke2-canal-qn998                                               2/2     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-q7cjn                     1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-v2lq7                     1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-lj6mp           1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-24g4k                            1/1     Running     <span class="m">0</span>          113m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-9gncw                            1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-h9slv                            1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-p98mx                            1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-rfvnm                            1/1     Running     <span class="m">0</span>          125m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-xlhd8                            1/1     Running     <span class="m">0</span>          113m
</span></span><span class="line"><span class="cl">kube-system           rke2-metrics-server-544c8c66fc-n8r9b                           1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-5twmc                      1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-8fzx7              1/1     Running     <span class="m">0</span>          126m
</span></span></code></pre></div><p>This goes for both Rancher automated deployed Kubernetes clusters and imported clusters. Same API endpoint to access them all.</p>
<p>If I would access my Tanzu Kubernetes clusters I would have to use the <em>kubectl vsphere login</em> command and from there enter the correnct vSphere Namespace context to get to my TKC cluster. By just adding the Tanzu cluster to Rancher I can use the same endpoint to access this cluster two. Have a quick look at how the kubectl config:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://rancher-dev.my-domain.net/k8s/clusters/c-m-qxpbc6tp&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kubeconfig-user-64t5qq4d67:l8mdcs55ggf8kz4zlrcpth8tk48j85kp9qjslk5zrcmjczw6nqr7fw&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span></code></pre></div><p>I accessing my TKC cluster through Rancher API endpoint.</p>


<h2 class="relative group">Managing Kubernetes clusters from Rancher 
    <div id="managing-kubernetes-clusters-from-rancher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#managing-kubernetes-clusters-from-rancher" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Though making Kubernetes cluster deployments an easy task is important, handling day two operations is even more important. Let&rsquo;s explore some typical administrative tasks that needs to be done on a Kubernetes cluster during its lifetime using Rancher.</p>


<h3 class="relative group">Scaling nodes horizontally - up and down 
    <div id="scaling-nodes-horizontally---up-and-down" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#scaling-nodes-horizontally---up-and-down" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>There will come a time when there is a need to scale the amount of worker nodes in a cluster. Lets see how we can do that in Rancher.</p>
<p>If I manually want to scale the amount of worker nodes up, I will go to Cluster Management and Clusters, then click on the name of my cluster to be scaled:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234028538.png"
        alt="cluster-management"
      />
      
    </figure>
</p>
<p>By clicking on the cluster name it will take me directly to the Machine pools, on the right there is some obvious -/+ buttons. By clicking on the + sign once it will scale with 1 additional worker node in that pool. Lets test</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234146135.png"
        alt="scale-up"
      />
      
    </figure>
</p>
<p>I will now scale my <em>rke2-cluster-2-vsphere</em> with from one worker node to two worker nodes.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234351880.png"
        alt="scaling"
      />
      
    </figure>
</p>
<p>In my vCenter:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234451691.png"
        alt="deploying_new_vm"
      />
      
    </figure>
</p>
<p>Cluster is now scaled with one additional worker node:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509235322632.png"
        alt="scaled"
      />
      
    </figure>
</p>
<p>Manual autoscaling is not always sufficient as the cluster is too dynamic so Rancher does have support Node Autoscaling</p>
<p>Autoscaling:
<a href="https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/rancher/README.md" target="_blank">https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/rancher/README.md</a></p>


<h3 class="relative group">Scaling nodes vertically - add cpu, ram and disk 
    <div id="scaling-nodes-vertically---add-cpu-ram-and-disk" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#scaling-nodes-vertically---add-cpu-ram-and-disk" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>What if I need to change the cpu, memory and disk resources on the nodes? An unexpected change in the workload dictates the nodes to be handle to change that and scaling horizontally does not solve it. Then I need an easy way to change the current nodes resource.</p>
<p>From the Cluster Manager and Clusters view, click on the name of the cluster that needs to have its nodes resources changed, and from there click <em>Config</em>:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240509235837729.png"
        alt="config"
      />
      
    </figure>
</p>
<p>Select the pool you want to change the resources on, I will select pool2 as thats where my worker nodes are residing.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000010471.png"
        alt="pool2"
      />
      
    </figure>
</p>
<p>Then in the top right corner click on the three dots and select edit config to allow for the required fields to be edited.</p>
<p>From there I will adjust the memory and cpu on the pool2 from 2 cpus to 4 and from 4096mb memory to 6144mb memory. Then click save.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000238032.png"
        alt="adjust-cpu-ram"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000322240.png"
        alt="status"
      />
      
    </figure>
</p>
<p>This triggers a rollout of a new worker nodes until all nodes have been replace with new nodes using the new cpu and memory config:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000357561.png"
        alt="rollout"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000435285.png"
        alt="new-cpu-memory-alloc"
      />
      
    </figure>
</p>
<p>Thats it</p>


<h3 class="relative group">Upgrading Kubernetes clusters 
    <div id="upgrading-kubernetes-clusters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#upgrading-kubernetes-clusters" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>This is probably one of the most important task maintaining a Kubernetes cluster, keeping pace with Kubernetes updates and performing Kubernetes upgrades. New Kubernetes release is coming approximately every 3 months.</p>
<p>So how can I upgrade my Kubernetes cluster using Rancher?</p>
<p>Almost same approach as above, but instead of changing any of the CPU and Memory resources I will scroll down and select the new Kubernetes version I want to upgrade to:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001659760.png"
        alt="upgrade-k8s-version"
      />
      
    </figure>
</p>
<p>I have a cluster currently running version 1.27.12 and want to upgrade to 1.28.8.
I will now select the latest version available and then save:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001754393.png"
        alt="1.28.8-upgrade"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001818305.png"
        alt="notification"
      />
      
    </figure>
</p>
<p>Continue.</p>
<p>This will not trigger a rolling upgrade, instead it will do a in-line upgrade by cordon node by node and the upgrade the node.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002109501.png"
        alt="control-plane-nodes-ready"
      />
      
    </figure>
</p>
<p>My control plane nodes has been upgrade to 1.28.8 already.</p>
<p>All nodes have been upgraded:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002231948.png"
        alt="ready"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002325256.png"
        alt="all-nodes"
      />
      
    </figure>
</p>
<p>This took just a couple of seconds (I was suspecting that something was wrong actually), it really only just took a couple of seconds. Everything worked as it should afterwards, I must say a relatively smoth process.</p>


<h3 class="relative group">Installing another Ingress controller than the default Ngninx - Avi Kubernetes Operator 
    <div id="installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>In my vSphere environment I already have Avi Loadbalancer running, Avi can also be extended into Kubernetes to automate K8s service creation and also Ingress and Gateway API. So in this section I will create a cluster with AKO as my Ingress controller.</p>
<p>By default Rancher installs Nginx as the Ingress controller. To install my own Ingress controller, like AKO, I will deselect Nginx in the cluster creation wizard:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510094631745.png"
        alt="disable-nginx"
      />
      
    </figure>
</p>
<p>Deploy the cluster, wait for it be finished.</p>
<p>Now that I have a cluster deployed without any ingressClasses or Ingress controller I can go on an deploy the ingress controller of my choice. As from my understanding there is currently no support for OCI Helm Chart repositories as of yet in Rancher I need to deploy  AKO using the cli approach. Otherwise I could just have added the AKO repo through the GUI and deploy it as an APP.</p>
<p>From my linux machine, I have grabbed the context of my newly created K8s cluster without any Ingress installed. Then I will just follow the regular AKO installation instructions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingressclasses.networking.k8s.io
</span></span><span class="line"><span class="cl">No resources found
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k create ns avi-system
</span></span><span class="line"><span class="cl">namespace/avi-system created
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ helm show values oci://projects.registry.vmware.com/ako/helm-charts/ako --version 1.11.3 &gt; values.yaml
</span></span><span class="line"><span class="cl">Pulled: projects.registry.vmware.com/ako/helm-charts/ako:1.11.3
</span></span><span class="line"><span class="cl">Digest: sha256:e4d0fcd80ae5b5377edf510d3d085211181a3f6b458a17c8b4a19d328e4cdfe6
</span></span><span class="line"><span class="cl"><span class="c1"># Will now edit the values.yaml file to accomodate my Avi config settings</span>
</span></span><span class="line"><span class="cl"><span class="c1"># After edit I will deploy AKO</span>
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ helm install --generate-name oci://projects.registry.vmware.com/ako/helm-charts/ako --version 1.11.3 -f values.yaml -n avi-system
</span></span><span class="line"><span class="cl">Pulled: projects.registry.vmware.com/ako/helm-charts/ako:1.11.3
</span></span><span class="line"><span class="cl">Digest: sha256:e4d0fcd80ae5b5377edf510d3d085211181a3f6b458a17c8b4a19d328e4cdfe6
</span></span><span class="line"><span class="cl">NAME: ako-1715330716
</span></span><span class="line"><span class="cl">LAST DEPLOYED: Fri May <span class="m">10</span> 10:45:19 <span class="m">2024</span>
</span></span><span class="line"><span class="cl">NAMESPACE: avi-system
</span></span><span class="line"><span class="cl">STATUS: deployed
</span></span><span class="line"><span class="cl">REVISION: <span class="m">1</span>
</span></span><span class="line"><span class="cl">TEST SUITE: None
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check for pods and Ingress Classes</span>
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get pods -n avi-system
</span></span><span class="line"><span class="cl">NAME    READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="cl">ako-0   1/1     Running   <span class="m">0</span>          39s
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingressclasses.networking.k8s.io
</span></span><span class="line"><span class="cl">NAME     CONTROLLER              PARAMETERS   AGE
</span></span><span class="line"><span class="cl">avi-lb   ako.vmware.com/avi-lb   &lt;none&gt;       47s
</span></span></code></pre></div><p>Now I have an Ingress controller installed in my cluster.</p>
<p>How about going back to the Rancher UI and create and Ingress using my newly deployed ingress controller?</p>
<p>I will go into my cluster, Service Discovery -&gt; Ingresses</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105025660.png"
        alt="ingresses"
      />
      
    </figure>
</p>
<p>Now lets try to create an Ingress:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105300728.png"
        alt="create-ingress"
      />
      
    </figure>
</p>
<p>Target Service and Ports are selected from the dropdown lists as long as the services are available from within the same namespace as I create my Ingress. Thats really nice.</p>
<p>Selecting my IngressClass from the dropdown.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105509618.png"
        alt="ingressclass"
      />
      
    </figure>
</p>
<p>Then click Create:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105608334.png"
        alt="create"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105640095.png"
        alt="ingress-active"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingress -n fruit
</span></span><span class="line"><span class="cl">NAME            CLASS    HOSTS                     ADDRESS          PORTS   AGE
</span></span><span class="line"><span class="cl">fruit-ingress   avi-lb   fruit-1.my-domain.net   192.168.121.13   <span class="m">80</span>      35s
</span></span></code></pre></div><p>In my Avi controller I should now have a new Virtual Service using the fqdn name:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510114029343.png"
        alt="fruit-virtual-service"
      />
      
    </figure>
</p>


<h2 class="relative group">Installing Custom CNI - bootstrapping new clusters using Antrea CNI 
    <div id="installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>What if I want to use a CNI that is not in the list of CNIs in Rancher?</p>
<p>Rancher provide a list of tested CNIs to choose from when deploying a new RKE2 cluster, but one is not limited to only choose one of these CNIs. It is possible to create a cluster using your own preferred CNI. So in this chapter I will go through how I can deploy a new RKE2 cluster using Antrea as my CNI.</p>
<p>Before I can bootstrap a cluster with Antrea (or any custom CNI) I need to tell Rancher to not deploy any CNI from the list of provided CNIs. This involves editing the cluster deployment using the YAML editor in Rancher. There is two ways I can install Antrea as the CNI during cluster creation/bootsrap, one is using the Antrea deployment manifest the other is using Helm Charts. The Helm Chart approach is the recommended way if you ask me, but one may not always have the option use Helm Chart that is way I have included both approaches. Below I will go through both of them, starting with the Antrea manifest. I need to complete one of these steps before clicking on the <em>create</em> cluster button.</p>


<h3 class="relative group">Add-on Config using manifest 
    <div id="add-on-config-using-manifest" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-on-config-using-manifest" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>After I have gone through the typical cluster creation steps, node pool config, cluster config etc I will need to add my Antrea manifest in the Add-On Config section.</p>
<p>So I will be going into the Cluster Configuration section and <em>Add-On Config</em></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240513161022543.png"
        alt="add-on-config"
      />
      
    </figure>
</p>
<p>Here I can add the deployment manifest for Antrea by just copy paste the content directly from the Antrea repo <a href="https://github.com/antrea-io/antrea/blob/main/build/yamls/antrea.yml" target="_blank">here</a>. This will always take you to the latest version of Antrea. Do the necessary configs in the deployment yaml like enabling or disabling the Antrea feature gates, if needed. They can be changed post cluster provision too.</p>
<p>Disregard the already populated Calico Configuration section:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240513161936973.png"
        alt="calico-add-on-config"
      />
      
    </figure>
</p>
<p>This will be removed at a later stage completely. I need to paste my Antrea deployment manifest under <em>Additional Manifest</em></p>
<p>When done proceed to the step which involves disabling the default CNI that Rancher wants to deploy. It is not possible set CNI to <em>none</em> from the UI so I need to configure the yaml directly to tell it to not install any CNI. That is done by following the steps below.</p>
<p>Click <em>edit as yaml</em></p>
<img src=images/image-20240513144701914.png style="width:400px" />
<p>Within my cluster yaml, there is certain blocks I need to edit and remove. Below is a &ldquo;default&rdquo; yaml using Calico as CNI, then I will paste the yaml which I have edited to allow me to install my custom CNI. See comments in the yamls by extending the code-field. I have only pasted parts of the yaml that is involved to make it &ldquo;shorter&rdquo;.</p>
<p>The &ldquo;untouched&rdquo; yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Before edited - expand field for all content to display</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE Cluster with Antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.8+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span><span class="c">## Need to add {} due to remove the below line</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">rke2-calico</span><span class="p">:</span><span class="w"> </span>{}<span class="w"> </span><span class="c">### This needs to be removed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        bucket: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        cloudCredentialName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        endpoint: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        endpointCA: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        folder: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        region: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        skipSSLVerify: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">calico</span><span class="w"> </span><span class="c">### Need to set this to none</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span></code></pre></div><p>The edited yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Before edited - expand field for all content to display</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE Cluster with Antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.8+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        bucket: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        cloudCredentialName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        endpoint: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        endpointCA: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        folder: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        region: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        skipSSLVerify: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">none</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="c">## See comment below</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span></code></pre></div><p>After editing the yaml as indicated above it is time to click Create.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240513151518462.png"
        alt="create-no-cni"
      />
      
    </figure>
</p>
<p>After a couple of minutes the cluster should be getting green and ready to consume with Antrea as the CNI.</p>
<p>Next up is the Helm Chart approach.</p>


<h3 class="relative group">Add-on Config using Helm Charts 
    <div id="add-on-config-using-helm-charts" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#add-on-config-using-helm-charts" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>I will follow almost the same approach as above, but instead of providing the Antrea manifest, I will be providing the Antrea Helm Chart repo.</p>
<p>So to save some digital ink, head over to Add-On Config and populate the Additional Manifest with the following content:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514203207791.png"
        alt="antrea-helm-chart"
      />
      
    </figure>
</p>
<p>Below is the yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">helm.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">HelmChart</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">kube-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">bootstrap</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c"># this is important</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">chart</span><span class="p">:</span><span class="w"> </span><span class="l">antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">targetNamespace</span><span class="p">:</span><span class="w"> </span><span class="l">kube-system</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l">https://charts.antrea.io</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">v1.15.1</span><span class="w"> </span><span class="c"># if I want a specific version to be installed</span><span class="w">
</span></span></span></code></pre></div><p>Below is a template to see which key/values that can be used:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">helm.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">HelmChart</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="c">#string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  annotations:  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  labels:  key: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  authPassCredentials: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  authSecret:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  backOffLimit: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  bootstrap: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  chart: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  chartContent: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  createNamespace: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  dockerRegistrySecret:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  failurePolicy: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  helmVersion: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  jobImage: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  podSecurityContext:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    fsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    fsGroupChangePolicy: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsNonRoot: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsUser: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    seLinuxOptions:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      level: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      role: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      user: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    seccompProfile:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      localhostProfile: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    supplementalGroups:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      - int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    sysctls:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      - name: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        value: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    windowsOptions:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpec: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpecName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      hostProcess: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      runAsUserName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  repo: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  repoCA: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  repoCAConfigMap:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  securityContext:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    allowPrivilegeEscalation: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    capabilities:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      add:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        - string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      drop:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#        - string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    privileged: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    procMount: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    readOnlyRootFilesystem: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsNonRoot: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    runAsUser: int</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    seLinuxOptions:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      level: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      role: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      user: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    seccompProfile:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      localhostProfile: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#    windowsOptions:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpec: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpecName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      hostProcess: boolean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#      runAsUserName: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  set: map[]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  targetNamespace: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  timeout: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  valuesContent: string</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  version: string</span><span class="w">
</span></span></span></code></pre></div><p>Then edit the cluster yaml to disable the Rancher provided CNI, as described above.</p>
<p>Click <em>create</em></p>
<p>Below is a complete yaml of the cluster being provisioned with Antrea as the CNI using Helm Chart option.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE2 using Antrea</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">appendTolerations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">overrideResourceRequirements</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">defaultPodSecurityAdmissionConfigurationTemplateName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">defaultPodSecurityPolicyTemplateName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">fleetAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">appendTolerations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">overrideAffinity</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">overrideResourceRequirements</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.9+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">additionalManifest</span><span class="p">:</span><span class="w"> </span><span class="p">|-</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">      apiVersion: helm.cattle.io/v1
</span></span></span><span class="line"><span class="cl"><span class="sd">      kind: HelmChart
</span></span></span><span class="line"><span class="cl"><span class="sd">      metadata:
</span></span></span><span class="line"><span class="cl"><span class="sd">        name: antrea
</span></span></span><span class="line"><span class="cl"><span class="sd">        namespace: kube-system
</span></span></span><span class="line"><span class="cl"><span class="sd">      spec:
</span></span></span><span class="line"><span class="cl"><span class="sd">        bootstrap: true # This is important
</span></span></span><span class="line"><span class="cl"><span class="sd">        chart: antrea
</span></span></span><span class="line"><span class="cl"><span class="sd">        targetNamespace: kube-system
</span></span></span><span class="line"><span class="cl"><span class="sd">        repo: https://charts.antrea.io</span><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">none</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">machinePools</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pool1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">etcdRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">controlPlaneRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">workerRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">hostnamePrefix</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">quantity</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">unhealthyNodeTimeout</span><span class="p">:</span><span class="w"> </span><span class="l">0m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">machineConfigRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VmwarevsphereConfig</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nc-rke2-cluster-4-antrea-pool1-gh2nj</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">drainBeforeDelete</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">machineOS</span><span class="p">:</span><span class="w"> </span><span class="l">linux</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pool2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">etcdRole</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">controlPlaneRole</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">workerRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">hostnamePrefix</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">quantity</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">unhealthyNodeTimeout</span><span class="p">:</span><span class="w"> </span><span class="l">0m</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">machineConfigRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VmwarevsphereConfig</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nc-rke2-cluster-4-antrea-pool2-s5sv4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">drainBeforeDelete</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">machineOS</span><span class="p">:</span><span class="w"> </span><span class="l">linux</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">machineSelectorConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">protect-kernel-defaults</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">registries</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">configs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">mirrors</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">upgradeStrategy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">controlPlaneConcurrency</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">controlPlaneDrainOptions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">deleteEmptyDirData</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">disableEviction</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">gracePeriod</span><span class="p">:</span><span class="w"> </span>-<span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">ignoreDaemonSets</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">skipWaitForDeleteTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">workerConcurrency</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">workerDrainOptions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">deleteEmptyDirData</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">disableEviction</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">gracePeriod</span><span class="p">:</span><span class="w"> </span>-<span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">ignoreDaemonSets</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">skipWaitForDeleteTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">machineSelectorConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="nt">config</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">__clone</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>By doing the steps above, I should shortly have a freshly installed Kubernetes cluster deployed using Antrea as my CNI.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514203832012.png"
        alt="antrea-app"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514193830195.png"
        alt="antrea-1"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514193904279.png"
        alt="antrea-tiers"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Run kubectl commands inside here</span>
</span></span><span class="line"><span class="cl"><span class="c1"># e.g. kubectl get all</span>
</span></span><span class="line"><span class="cl">&gt; k get pods -A
</span></span><span class="line"><span class="cl">NAMESPACE             NAME                                                                  READY   STATUS      RESTARTS      AGE
</span></span><span class="line"><span class="cl">cattle-fleet-system   fleet-agent-7cf5c7b6cb-cbr4c                                          1/1     Running     <span class="m">0</span>             35m
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-686798b687-jq9kp                                 1/1     Running     <span class="m">0</span>             36m
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-686798b687-q97mx                                 1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">cattle-system         dashboard-shell-6tldq                                                 2/2     Running     <span class="m">0</span>             7s
</span></span><span class="line"><span class="cl">cattle-system         helm-operation-95wr6                                                  0/2     Completed   <span class="m">0</span>             35m
</span></span><span class="line"><span class="cl">cattle-system         helm-operation-jtgzs                                                  0/2     Completed   <span class="m">0</span>             29m
</span></span><span class="line"><span class="cl">cattle-system         helm-operation-qz9bc                                                  0/2     Completed   <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">cattle-system         rancher-webhook-7d57cd6cb8-4thw7                                      1/1     Running     <span class="m">0</span>             29m
</span></span><span class="line"><span class="cl">cattle-system         system-upgrade-controller-6f86d6d4df-x46gp                            1/1     Running     <span class="m">0</span>             35m
</span></span><span class="line"><span class="cl">kube-system           antrea-agent-9qm2d                                                    2/2     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           antrea-agent-dr2hz                                                    2/2     Running     <span class="m">1</span> <span class="o">(</span>33m ago<span class="o">)</span>   34m
</span></span><span class="line"><span class="cl">kube-system           antrea-controller-768b4dbcb5-7srnw                                    1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv   1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           etcd-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv                       1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           helm-install-antrea-vtskp                                             0/1     Completed   <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-coredns-8lrrq                                       0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-ingress-nginx-4bbr4                                 0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-metrics-server-8xrbh                                0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-rt5hb                       0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-pncxt                           0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-zv9kl                   0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           kube-apiserver-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv             1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           kube-controller-manager-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv    1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv                 1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-5-antrea-pool2-209a1e89-9sjt7                 1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">kube-system           kube-scheduler-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv             1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-6hrfv                            1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-z2bb5                            1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-spj7d                  1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-8p7rz                                   1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="cl">kube-system           rke2-ingress-nginx-controller-zdbvm                                   0/1     Pending     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           rke2-metrics-server-655477f655-5n7sp                                  1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-6mtbs                             1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-jprqr                     1/1     Running     <span class="m">0</span>             37m
</span></span></code></pre></div><p>Now with Antrea installed as the CNI I can go ahead and use the rich set of feature gates Antrea brings to table.</p>
<p>To enable and disable the Antrea FeatureGates either edit the configMap using <em>kubectl edit configmap -n kube-system antrea-config</em> or use the Rancher UI:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194348844.png"
        alt="ConfigMaps"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194425307.png"
        alt="edit-config"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194506279.png"
        alt="edit-yaml"
      />
      
    </figure>
</p>


<h3 class="relative group">Upgrading or changing version of the Antrea CNI using Rancher 
    <div id="upgrading-or-changing-version-of-the-antrea-cni-using-rancher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#upgrading-or-changing-version-of-the-antrea-cni-using-rancher" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>When I deploy Antrea using the Helm Chart Add-On Config, upgrading or changing the version of Antrea is a walk in the park.</p>
<p>In the cluster I want to upgrade/downgrade Antrea I first need to add the Antrea Helm Repo under App -&gt; Repositories:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204700410.png"
        alt="add-antrea-repo"
      />
      
    </figure>
</p>
<p>Then head back to Installed Apps under <strong>Apps</strong> and click on <em>antrea</em></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204819652.png"
        alt="antrea-app"
      />
      
    </figure>
</p>
<p>Click top right corner:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204934418.png"
        alt="upgrade"
      />
      
    </figure>
</p>
<p>Follow the wizard and select the version you want, then click next.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205037494.png"
        alt="antrea-version"
      />
      
    </figure>
</p>
<p>Change values or dont, and click Upgrade:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205229183.png"
        alt="upgrade"
      />
      
    </figure>
</p>
<p>Sit back and enjoy:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205343991.png"
        alt="upgraded"
      />
      
    </figure>
</p>
<p>Now I just downgraded from version 2.0.0 to 1.15.1, the same approach is true for upgrading to a newer version of course. But why upgrade when one can downgrade, one need to have some fun in life&hellip;</p>
<p>In the list of <strong>Installed Apps</strong> view Rancher will notify me if there is a new release available. This is a nice indicator whenever there is a new release:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240514211110983.png"
        alt="new-version-available"
      />
      
    </figure>
</p>


<h2 class="relative group">NeuVector 
    <div id="neuvector" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#neuvector" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>NeuVector is new for me, by having a quick look at what it does it did spark my interest. From the official <a href="https://open-docs.neuvector.com/basics/overview" target="_blank">docs page</a>:</p>
<blockquote>
<p>NeuVector provides a powerful end-to-end container security platform. This includes end-to-end vulnerability scanning and complete run-time protection for containers, pods and hosts, including:</p>
<ol>
<li>CI/CD Vulnerability Management &amp; Admission Control. Scan images with a Jenkins plug-in, scan registries, and enforce admission control rules for deployments into production.</li>
<li>Violation Protection. Discovers behavior and creates a whitelist based policy to detect violations of normal behavior.</li>
<li>Threat Detection. Detects common application attacks such as DDoS and DNS attacks on containers.</li>
<li>DLP and WAF Sensors. Inspect network traffic for Data Loss Prevention of sensitive data, and detect common OWASP Top10 WAF attacks.</li>
<li>Run-time Vulnerability Scanning. Scans registries, images and running containers orchestration platforms and hosts for common (CVE) as well as application specific vulnerabilities.</li>
<li>Compliance &amp; Auditing. Runs Docker Bench tests and Kubernetes CIS Benchmarks automatically.</li>
<li>Endpoint/Host Security. Detects privilege escalations, monitors processes and file activity on hosts and within containers, and monitors container file systems for suspicious activity.</li>
<li>Multi-cluster Management. Monitor and manage multiple Kubernetes clusters from a single console.</li>
</ol>
<p>Other features of NeuVector include the ability to quarantine containers and to export logs through SYSLOG and webhooks, initiate packet capture for investigation, and integration with OpenShift RBACs, LDAP, Microsoft AD, and SSO with SAML. Note: Quarantine means that all network traffic is blocked. The container will remain and continue to run - just without any network connections. Kubernetes will not start up a container to replace a quarantined container, as the api-server is still able to reach the container.</p>
</blockquote>
<p>If I head over to any of my clusters in Rancher under Apps -&gt; Charts I will find a set of ready to install applications. There I also find NeuVector:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121533387.png"
        alt="apps-neuvector"
      />
      
    </figure>
</p>
<p>Lets try an installation of NeuVector. I will keep everything at default for now. As one can imagine there is some configurations that should be done if deploying it in production, like Ingress, Certificate, PVC etc. By just deploying with all default values it will be exposed using NodePort, selfsigned certificate and no PVC.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121711137.png"
        alt="install"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121802867.png"
        alt="step-1"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121903296.png"
        alt="step2"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; k get pods -A
</span></span><span class="line"><span class="cl">NAMESPACE                 NAME                                                                   READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-cctd7                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-ql5dz                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-tmb77                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-lnsfl                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-m4gjp                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-wr5j4                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-manager-pod-779f9976f8-cmlh5                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-8lztx                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-8qhr7                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-gcbr9                                 1/1     Running     <span class="m">0</span>          53s
</span></span></code></pre></div><p>NeuVector is up and running.</p>
<p>Lets have a quick look inside NeuVector</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124246619.png"
        alt="login"
      />
      
    </figure>
</p>
<p>Default password is <em>admin</em></p>
<p>First glance:</p>
<p>Dashboard</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124409589.png"
        alt="dasboard"
      />
      
    </figure>
</p>
<p>Network Activity</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124556048.png"
        alt="network-activity"
      />
      
    </figure>
</p>
<p>Network Rules</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510125541756.png"
        alt="network-rules"
      />
      
    </figure>
</p>
<p>Settings</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240510125624102.png"
        alt="settings"
      />
      
    </figure>
</p>
<p>For more information head over to the official NeuVector documentation page <a href="https://open-docs.neuvector.com/navigation/navigation" target="_blank">here</a></p>
<p><strong>Neuvector Rancher UI Extension</strong></p>
<p>Neuvector can also be installed as an extension in Rancher:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100149730.png"
        alt="neuvector-rancher"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100231909.png"
        alt="install"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100341875.png"
        alt="reload"
      />
      
    </figure>
</p>
<p>If I now head into the cluster I have deployed NeuVector, I will get a great overview from NeuVector directly in the Rancher UI:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100543769.png"
        alt="neuvector-overview"
      />
      
    </figure>
</p>
<p>That is very neat. And again, it was just one click to enable this extension.</p>


<h2 class="relative group">Monitoring 
    <div id="monitoring" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#monitoring" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Keeping track of whats going on in the whole Kubernetes estate is crucial, everything from Audit logs, performance, troubleshooting.</p>
<p>I will try out the Monitoring app that is available under Monitoring tools, or Cluster tools here:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101446424.png"
        alt="monitoring"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101610249.png"
        alt="monitoring"
      />
      
    </figure>
</p>
<p>Again, using default values:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101709208.png"
        alt="install"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SUCCESS: helm upgrade --install<span class="o">=</span><span class="nb">true</span> --namespace<span class="o">=</span>cattle-monitoring-system --timeout<span class="o">=</span>10m0s --values<span class="o">=</span>/home/shell/helm/values-rancher-monitoring-103.1.0-up45.31.1.yaml --version<span class="o">=</span>103.1.0+up45.31.1 --wait<span class="o">=</span><span class="nb">true</span> rancher-monitoring /home/shell/helm/rancher-monitoring-103.1.0-up45.31.1.tgz
</span></span><span class="line"><span class="cl">2024-05-11T08:19:06.403230781Z ---------------------------------------------------------------------
</span></span></code></pre></div><p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511102112263.png"
        alt="up-and-running"
      />
      
    </figure>
</p>
<p>Now I suddenly can access it all from the Monitoring section within my cluster:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104058931.png"
        alt="monitoring"
      />
      
    </figure>
</p>
<p>Notice the Active Alerts.</p>
<p>From the Cluster Dashboard:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240513143749611.png"
        alt="dashboard"
      />
      
    </figure>
</p>
<p>Lets see whats going on in and with my cluster:</p>
<p><strong>AlertManager</strong></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104237091.png"
        alt="alertmanager"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511111127724.png"
        alt="alert"
      />
      
    </figure>
</p>
<p><strong>Grafana</strong></p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104314786.png"
        alt="grafana"
      />
      
    </figure>
</p>
<p>A bunch of provided dashboards:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104358707.png"
        alt="dashboards"
      />
      
    </figure>
</p>


<h2 class="relative group">The Rancher API 
    <div id="the-rancher-api" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-rancher-api" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>One can interact with Rancher not only using the great Rancher UI, but using the CLI, kubectl and from external applications.</p>
<p>Lets start with the CLI. The binary for the CLI can be downloaded from the Rancher UI by going to <em>about</em> - here:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511112634751.png"
        alt="image-20240511112634751"
      />
      
    </figure>
</p>
<p>I download the tar file for mac, extract it using <code>tar -zxvf rancher-darwin-amd64-v2.8.3.tar.gz</code> and then copy/and move it to <em>/user/local/bin/</em> folder.</p>
<p>Before I can use th CLI to connect to my Rancher endpoint I need to create an api token here:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113253630.png"
        alt="api-key"
      />
      
    </figure>
</p>
<p>No Scopes as I want access to them all</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113331005.png"
        alt="create"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113416587.png"
        alt="ready"
      />
      
    </figure>
</p>
<p>Now I need to copy these keys, so I have them. They will expire in 90 days. If I loose them I have to create new ones.</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113618928.png"
        alt="created"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher login https://rancher-dev.my-domain.net --token token-m8k88:cr89kvdq4xfsl4pcnn4rh5xkdcw2rhvz46cxlrpw29qblqxbsnz
</span></span><span class="line"><span class="cl">NUMBER    CLUSTER NAME             PROJECT ID             PROJECT NAME   PROJECT DESCRIPTION
</span></span><span class="line"><span class="cl"><span class="m">1</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-dt4qw   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">2</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-rpqhc   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">3</span>         rke2-cluster-1           c-m-d85dvj2l:p-gpczf   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">4</span>         rke2-cluster-1           c-m-d85dvj2l:p-l6cln   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">5</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-57cpk   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">6</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-fzdtp   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">7</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-8gc9x   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">8</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-f2kkb   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">9</span>         tanzuz-cluster-1         c-m-qxpbc6tp:p-mk49f   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">10</span>        tanzuz-cluster-1         c-m-qxpbc6tp:p-s428w   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">11</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-nrxgl   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">12</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-xsmbd   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">13</span>        <span class="nb">local</span>                    local:p-tqk2t          Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">14</span>        <span class="nb">local</span>                    local:p-znt9n          System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl">Select a Project:
</span></span></code></pre></div><p>Selecting project rke2-cluster-2-vsphere ID 5:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Select a Project:5
</span></span><span class="line"><span class="cl">INFO<span class="o">[</span>0123<span class="o">]</span> Saving config to /Users/andreasm/.rancher/cli2.json
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher kubectl get pods -A
</span></span><span class="line"><span class="cl">NAMESPACE                  NAME                                                                   READY   STATUS      RESTARTS      AGE
</span></span><span class="line"><span class="cl">calico-system              calico-kube-controllers-7fdf877475-svqt8                               1/1     Running     <span class="m">0</span>             22h
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#Switch between contexts</span>
</span></span><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher context switch
</span></span><span class="line"><span class="cl">NUMBER    CLUSTER NAME             PROJECT ID             PROJECT NAME   PROJECT DESCRIPTION
</span></span><span class="line"><span class="cl"><span class="m">1</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-dt4qw   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">2</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-rpqhc   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">3</span>         rke2-cluster-1           c-m-d85dvj2l:p-gpczf   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">4</span>         rke2-cluster-1           c-m-d85dvj2l:p-l6cln   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">5</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-57cpk   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">6</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-fzdtp   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">7</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-8gc9x   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">8</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-f2kkb   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">9</span>         tanzuz-cluster-1         c-m-qxpbc6tp:p-mk49f   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">10</span>        tanzuz-cluster-1         c-m-qxpbc6tp:p-s428w   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">11</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-nrxgl   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">12</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-xsmbd   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">13</span>        <span class="nb">local</span>                    local:p-tqk2t          Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl"><span class="m">14</span>        <span class="nb">local</span>                    local:p-znt9n          System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="cl">Select a Project:
</span></span></code></pre></div><p>More information on the CLI reference page <a href="https://ranchermanager.docs.rancher.com/reference-guides/cli-with-rancher/rancher-cli" target="_blank">here</a></p>
<p>More information on the API <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api" target="_blank">here</a></p>
<p><strong>kubectl</strong></p>
<p>Using kubectl without the Rancher CLI is of course possible, just grab the contexts from your different cluster you have access to from the Rancher UI, copy or download them and put into the .kube/config or point to them as below and interact with Rancher managed Kubernetes clusters as they were any other Kubernetes cluster:</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511115154151.png"
        alt="download"
      />
      
    </figure>
</p>
<p>
    <figure>
      <img
        class="my-0 rounded-md"
        loading="lazy"
        src="/2023/02/05/taking-rancher-by-suse-for-a-spin/images/image-20240511115215009.png"
        alt="copy"
      />
      
    </figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">andreasm@linuxmgmt01:~/rancher$ k --kubeconfig rke-ako.yaml get pods -A
</span></span><span class="line"><span class="cl">NAMESPACE             NAME                                                               READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="cl">avi-system            ako-0                                                              1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="cl">calico-system         calico-kube-controllers-67f857444-qwtd7                            1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">calico-system         calico-node-4k6kl                                                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">calico-system         calico-node-wlzpt                                                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">calico-system         calico-typha-75d7fbfc6c-bhgxj                                      1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">cattle-fleet-system   fleet-agent-7cf5c7b6cb-kqgqm                                       1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-8548cbfbb7-b4t5f                              1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">cattle-system         cattle-cluster-agent-8548cbfbb7-hvdcx                              1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">cattle-system         rancher-webhook-7d57cd6cb8-gwvr4                                   1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">cattle-system         system-upgrade-controller-6f86d6d4df-zg7lv                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">fruit                 apple-app                                                          1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="cl">fruit                 banana-app                                                         1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-3-ako-pool1-b6cddca0-tf84w   1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           etcd-rke2-cluster-3-ako-pool1-b6cddca0-tf84w                       1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-calico-crd-w2skj                                 0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-calico-lgcdp                                     0/1     Completed   <span class="m">1</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-coredns-xlrtx                                    0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-metrics-server-rb7qj                             0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-bhrq5                    0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-controller-wlftf                        0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-jmnm2                0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           kube-apiserver-rke2-cluster-3-ako-pool1-b6cddca0-tf84w             1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           kube-controller-manager-rke2-cluster-3-ako-pool1-b6cddca0-tf84w    1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-3-ako-pool1-b6cddca0-tf84w                 1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           kube-proxy-rke2-cluster-3-ako-pool2-50bb46e0-tj2kp                 1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           kube-scheduler-rke2-cluster-3-ako-pool1-b6cddca0-tf84w             1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-jj2gk                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-wq4hs                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-c86ps               1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-metrics-server-544c8c66fc-hkdh9                               1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-np4lt                          1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-9zk7w                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="cl">tigera-operator       tigera-operator-779488d655-7x25x                                   1/1     Running     <span class="m">0</span>          25h
</span></span></code></pre></div>

<h2 class="relative group">Authentication and RBAC with Rancher 
    <div id="authentication-and-rbac-with-rancher" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#authentication-and-rbac-with-rancher" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Rancher provides a robust Authentication and RBAC out of the box. For more information on authentication and RBAC in Rancher head over <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config" target="_blank">here</a> <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac" target="_blank">here</a></p>
<p>Rancher can integrate with the following external authentication services, in addition to local user authentication:</p>
<ul>
<li>Microsoft Active Directory</li>
<li>Microsoft Azure AD</li>
<li>Microsoft AD FS</li>
<li>GitHub</li>
<li>FreeIPA</li>
<li>OpenLDAP</li>
<li>PingIdentity</li>
<li>KeyCloak (OIDC)</li>
<li>KeyCloak ((SAML)</li>
<li>Okta</li>
<li>Google OAuth</li>
<li>Shibboleth</li>
</ul>
<p>RBAC is an important part in managing a Kubernetes estate. I will cover RBAC in Rancher in more depth in another blog post.</p>


<h2 class="relative group">Outro 
    <div id="outro" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#outro" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>My experience with Rancher has been very positive, I would say way over the expectations I had before I started writing this post. It (Rancher) just feels like a well thought through product, solid and complete. It brings a lot of built-in features and tested applications, but its not limiting me to do things differently nor add my own &ldquo;custom&rdquo; things to it. Delivering a product with so many features out-of-the-box, without setting to many limitations on what I can do &ldquo;outside-the-box&rdquo; is not an easy achievement, but Rancher gives me the feeling they have acheived it. I feel like whatever feature I wanted, Rancher had it, at the same time many features I even haven&rsquo;t thought of, Rancher had it.</p>
<p>A very powerful Kubernetes management platform. Its open-source and available.</p>
<p>Stay tuned for some follow-up posts where I deepdive into specific topics of Rancher. This will be fun.</p>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/&amp;title=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/&amp;text=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://s2f.kytta.dev/?text=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin%20https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/"
      title=""
      aria-label=""
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://blog.andreasm.io/2023/02/05/taking-rancher-by-suse-for-a-spin/&amp;subject=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/2023/02/02/neuvector-by-suse-security-where-it-is-needed-part-1/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2023/02/02/neuvector-by-suse-security-where-it-is-needed-part-1/feature-NeuVector_logo.svg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2023/02/02/neuvector-by-suse-security-where-it-is-needed-part-1/">NeuVector by SUSE - security where it is needed - part 1</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-02-02T12:42:04&#43;02:00">2 February 2023</time><span class="px-2 text-primary-500">&middot;</span><span>6920 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">33 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/security/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/compliance/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Compliance
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/suse/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    SUSE
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/neuvector/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    NeuVector
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/compliance/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Compliance
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/neuvector/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Neuvector
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/suse/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Suse
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          In this two post series I will explore and deep dive into NeuVector security features
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/2023/06/21/securing-kubernetes-clusters-with-antrea-network-policies/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2023/06/21/securing-kubernetes-clusters-with-antrea-network-policies/feature-antrea-1.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2023/06/21/securing-kubernetes-clusters-with-antrea-network-policies/">Securing Kubernetes clusters with Antrea Network Policies</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2023-06-21T10:01:46&#43;02:00">21 June 2023</time><span class="px-2 text-primary-500">&middot;</span><span>6048 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">29 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/cni/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    CNI
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/antrea/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Antrea
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/security/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/tmc/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    TMC
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/tanzu-mission-control/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Tanzu Mission Control
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/security/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Security
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cni/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cni
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/antrea/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Antrea
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/tmc/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Tmc
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          In this post I will go through how to utilize Antrea Network policies with Tanzu Mission Control and a little bit NSX. So jump in and hopefully get some ideas how what we can do with Antrea Network Policies and how to use them.
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/2024/04/16/exploring-some-antrea-features/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2024/04/16/exploring-some-antrea-features/feature-antrea-1.png);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2024/04/16/exploring-some-antrea-features/">Exploring some Antrea Features</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-04-16T09:25:28&#43;02:00">16 April 2024</time><span class="px-2 text-primary-500">&middot;</span><span>6097 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">29 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/cni/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    CNI
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/antrea/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Antrea
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/antrea/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Antrea
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/kubernetes/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Kubernetes
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/cni/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Cni
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          In this post I will go through a couple of Antrea features I find interesting, some new features and some older features
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2023-02-05-taking-rancher-by-suse-for-a-spin\/index.md"
        var oid_likes = "likes_posts\/2023-02-05-taking-rancher-by-suse-for-a-spin\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/2023/02/02/neuvector-by-suse-security-where-it-is-needed-part-1/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >NeuVector by SUSE - security where it is needed - part 1</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-02-02T12:42:04&#43;02:00">2 February 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/2023/02/20/antrea-egress/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Antrea Egress</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-02-20T15:42:54&#43;01:00">20 February 2023</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="">
            
            Tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="">
            
            Categories
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2026
      Andreas Marqvardsen
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://blog.andreasm.io/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
