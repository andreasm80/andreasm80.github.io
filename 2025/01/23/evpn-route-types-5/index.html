<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>EVPN Route Types 5 &middot; blog.andreasm.io</title>
  <meta name="title" content="EVPN Route Types 5 &middot; blog.andreasm.io" />
  
  <meta name="description" content="Going into details of EVPN route type 5" />
  <meta name="keywords" content="networking, overlay, EVPN, " />
  
  
  <link rel="canonical" href="http://localhost:1313/2025/01/23/evpn-route-types-5/" />
  
  
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="/css/main.bundle.min.48d290696564c2380c4233780f3fd414aa6e2b0b67ed916e9d918c48c05f5b20b641bf892fadd408e43ec21d2feb2ec1fe6fd1f021df2806a254977fe2f80a64.css"
    integrity="sha512-SNKQaWVkwjgMQjN4Dz/UFKpuKwtn7ZFunZGMSMBfWyC2Qb&#43;JL63UCOQ&#43;wh0v6y7B/m/R8CHfKAaiVJd/4vgKZA==" />
  
  
  <script type="text/javascript" src="/js/appearance.min.a85bd6dc99d1fecae166deb56a1fee6375588c72533c4b8c690e4a9ec5a04174ff780e41e2ac770382a8e67818cb2b89766afa3e23965c9102424a080dafbb0c.js"
    integrity="sha512-qFvW3JnR/srhZt61ah/uY3VYjHJTPEuMaQ5KnsWgQXT/eA5B4qx3A4Ko5ngYyyuJdmr6PiOWXJECQkoIDa&#43;7DA=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="/js/main.bundle.min.a2d78d78672e549fbfc972ece871725b5478ba0b65708dda20cb97ab80a865eae6d247e1b05a4aec6ebbf78647ec3233bad8b2609ed98eee53cd58aa17128bc7.js"
    integrity="sha512-oteNeGcuVJ&#43;/yXLs6HFyW1R4ugtlcI3aIMuXq4CoZerm0kfhsFpK7G6794ZH7DIzutiyYJ7Zju5TzViqFxKLxw==" data-copy="" data-copied=""></script>
  
  
  
  <script src="/lib/zoom/zoom.min.37d2094687372da3f7343a221a470f6b8806f7891aa46a5a03966af7f0ebd38b9fe536cb154e6ad28f006d184b294525a7c4054b6bbb4be62d8b453b42db99bd.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S&#43;Yti0U7QtuZvQ=="></script>
  
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/2025/01/23/evpn-route-types-5/">
  <meta property="og:site_name" content="blog.andreasm.io">
  <meta property="og:title" content="EVPN Route Types 5">
  <meta property="og:description" content="What is EVPN route type 5">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-01-23T10:17:20+01:00">
    <meta property="article:modified_time" content="2025-01-23T10:17:20+01:00">
    <meta property="article:tag" content="Networking">
    <meta property="article:tag" content="Overlay">
    <meta property="article:tag" content="EVPN">
    <meta property="og:image" content="http://localhost:1313/2025/01/23/evpn-route-types-5/feature-arista-networks.jpg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/2025/01/23/evpn-route-types-5/feature-arista-networks.jpg">
  <meta name="twitter:title" content="EVPN Route Types 5">
  <meta name="twitter:description" content="What is EVPN route type 5">

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "EVPN Route Types 5",
    "headline": "EVPN Route Types 5",
    "description": "What is EVPN route type 5",
    "abstract": "Going into details of EVPN route type 5",
    "inLanguage": "en",
    "url" : "http:\/\/localhost:1313\/2025\/01\/23\/evpn-route-types-5\/",
    "author" : {
      "@type": "Person",
      "name": "Andreas Marqvardsen"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-01-23T10:17:20\u002b01:00",
    "datePublished": "2025-01-23T10:17:20\u002b01:00",
    
    "dateModified": "2025-01-23T10:17:20\u002b01:00",
    
    "keywords": ["networking","overlay","EVPN"],
    
    "mainEntityOfPage": "true",
    "wordCount": "5867"
  }]
  </script>


  
  
  <meta name="author" content="Andreas Marqvardsen" />
  
  
  
  <link href="mailto:andreas.marqvardsen[AT]gmail.com" rel="me" />
  
  
  <link href="https://blog.andreasm.io/" rel="me" />
  
  
  <link href="https://github.com/andreasm80" rel="me" />
  
  
  <link href="https://linkedin.com/in/andreas-marqvardsen" rel="me" />
  
  
  <link href="https://vmst.io/@andreasm" rel="me" />
  
  
  <link href="https://x.com/NATsoFast" rel="me" />
  
  
  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>






















  
  

<script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPYDVE8KR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TVPYDVE8KR');
</script>



  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    
    
    <div>
        <a href="/" class="flex">
            <span class="sr-only">blog.andreasm.io</span>

            
            <img src="/ynwa2.png" width="300" height="342"
                class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt="blog.andreasm.io" />
            

        </a>
    </div>
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            
            <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">blog.andreasm.io</a>
            

        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Posts
    </p>
</a>



            
            
  <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        About
    </p>
</a>



            
            
  <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Categories
    </p>
</a>



            
            
  <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-base font-medium" title="">
        Tags
    </p>
</a>



            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 flex items-center">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400">
                    <div class="flex items-center justify-center dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12 h-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" class="text-base hover:text-primary-600 dark:hover:text-primary-400" style="margin-right:5px">
                <div class="flex items-center justify-center dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" class="block">
            
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li id="menu-close-button">
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    

                    
  <li class="mt-1">
    <a href="/posts/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Posts
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/about/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            About
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/categories/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Categories
        </p>
    </a>
</li>




                    

                    
  <li class="mt-1">
    <a href="/tags/"  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
        
        <p class="text-bg font-bg" title="">
            Tags
        </p>
    </a>
</li>




                    

                </ul>
                
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/2025/01/23/evpn-route-types-5/feature-arista-networks.jpg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
<script>
    window.addEventListener('scroll', function (e) {
        var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
        var background_blur = document.getElementById('background-blur');
        background_blur.style.opacity = (scroll / 300)
    });
</script>

  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/"
      >blog.andreasm.io</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="/2025/01/23/evpn-route-types-5/"
      >EVPN Route Types 5</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      EVPN Route Types 5
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      





  
  







  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2025-01-23T10:17:20&#43;01:00">23 January 2025</time><span class="px-2 text-primary-500">&middot;</span><span>5867 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">28 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  
  
  
</div>




    </div>

    
    
    
    
    

    

    
      
      
        
        
<div class="flex author">
  
    
    
      
    
    
      
      <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
      alt="Andreas Marqvardsen" src="/profile.png" />
    
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Andreas Marqvardsen
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">Always curious, always learning</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:andreas.marqvardsen[AT]gmail.com"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://blog.andreasm.io/"
          target="_blank"
          aria-label="Link"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/andreasm80"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://linkedin.com/in/andreas-marqvardsen"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://vmst.io/@andreasm"
          target="_blank"
          aria-label="Mastodon"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://x.com/NATsoFast"
          target="_blank"
          aria-label="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>

      

      

      
      <div class="mb-5"></div>
      

    

  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open id="TOCView"
  class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#route-type-3---inclusive-multicast-ethernet-tag-route">Route Type 3 - inclusive multicast Ethernet tag route</a></li>
    <li><a href="#route-type-2---macip-advertisement-route">Route Type 2 - MAC/IP advertisement route</a>
      <ul>
        <li>
          <ul>
            <li><a href="#mac-vrf-vs-ip-vrf">MAC-VRF vs IP-VRF</a></li>
            <li><a href="#constrained-route-distribution---rfc-4684">Constrained Route Distribution - RFC 4684</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#egress">Egress</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#route-type-3---inclusive-multicast-ethernet-tag-route">Route Type 3 - inclusive multicast Ethernet tag route</a></li>
    <li><a href="#route-type-2---macip-advertisement-route">Route Type 2 - MAC/IP advertisement route</a>
      <ul>
        <li>
          <ul>
            <li><a href="#mac-vrf-vs-ip-vrf">MAC-VRF vs IP-VRF</a></li>
            <li><a href="#constrained-route-distribution---rfc-4684">Constrained Route Distribution - RFC 4684</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#egress">Egress</a></li>
  </ul>
</nav>
  </div>
</details>

<script>

  var margin = 200;
  var marginError = 50;

  (function () {
    var $window = $(window);
    var $toc = $('#TOCView');
    var tocHeight = $toc.height();

    function onResize() {
      var windowAndMarginHeight = $window.height() - margin;
      if(tocHeight >= windowAndMarginHeight) {
        $toc.css("overflow-y", "scroll")
        $toc.css("max-height", (windowAndMarginHeight + marginError) + "px")
      } else {
        $toc.css("overflow-y", "hidden")
        $toc.css("max-height", "9999999px")
      }
    }

    $window.on('resize', onResize);
    $(document).ready(onResize);
  })();



  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = decodeURIComponent(e.attr('id'));
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
          
            $(e).removeClass('active');
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
        
        onScroll();
      });
    }
  })();


</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="article-content max-w-prose mb-20">
          

<h1 class="relative group">EVPN Route Types 
    <div id="evpn-route-types" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#evpn-route-types" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>As promised in my previous post <a href="https://blog.andreasm.io/2024/12/09/evpn-introduction/" target="_blank">EVPN Introduction</a> I will now go into the different route types in EVPN, what they do and when they are used. In the previous post I mention that EVPN depends on <a href="https://blog.andreasm.io/2024/12/09/evpn-introduction/#mp-bgp" target="_blank">MP-BGP</a> to add specific EVPN BGP NLRI, aka EVPN route types. The different EVPN route types if I ask Arista EOS:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a#show bgp evpn route-type ?
</span></span><span class="line"><span class="cl">  auto-discovery    Filter by Ethernet auto-discovery <span class="o">(</span>A-D<span class="o">)</span> route <span class="o">(</span><span class="nb">type</span> 1<span class="o">)</span>
</span></span><span class="line"><span class="cl">  count             Route-type based path count
</span></span><span class="line"><span class="cl">  ethernet-segment  Filter by Ethernet segment route <span class="o">(</span><span class="nb">type</span> 4<span class="o">)</span>
</span></span><span class="line"><span class="cl">  imet              Filter by inclusive multicast Ethernet tag route <span class="o">(</span><span class="nb">type</span> 3<span class="o">)</span>
</span></span><span class="line"><span class="cl">  ip-prefix         Filter by IP prefix route <span class="o">(</span><span class="nb">type</span> 5<span class="o">)</span>
</span></span><span class="line"><span class="cl">  join-sync         Filter by multicast join sync route <span class="o">(</span><span class="nb">type</span> 7<span class="o">)</span>
</span></span><span class="line"><span class="cl">  leave-sync        Filter by multicast leave sync route <span class="o">(</span><span class="nb">type</span> 8<span class="o">)</span>
</span></span><span class="line"><span class="cl">  mac-ip            Filter by MAC/IP advertisement route <span class="o">(</span><span class="nb">type</span> 2<span class="o">)</span>
</span></span><span class="line"><span class="cl">  smet              Filter by selective multicast Ethernet tag route <span class="o">(</span><span class="nb">type</span> 6<span class="o">)</span>
</span></span><span class="line"><span class="cl">  spmsi             Filter by selective PMSI auto discovery route <span class="o">(</span><span class="nb">type</span> 10<span class="o">)</span>
</span></span></code></pre></div><p>Where in this post I will cover route type 2 (MAC/IP advertisement route) and route type 3 (inclusive multicast ethernet tag route).</p>
<p>In this post I will build upon the same environment and topology as in previous post, already configured with EVPN and VXLAN.</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250123110235437.png" alt="l3ls" />
      
    </figure>
</p>


<h2 class="relative group">Route Type 3 - inclusive multicast Ethernet tag route 
    <div id="route-type-3---inclusive-multicast-ethernet-tag-route" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#route-type-3---inclusive-multicast-ethernet-tag-route" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>Why start with route type 3 and 2? Not because I wanted to do it in a chronological order, because then I would start with route type 1. Route type 2 and 3 are the most common route types in an EVPN VXLAN fabric and both are kind of necessary together. Hopefully in this post I shed some light on why that is.</p>
<p>In my previous post I covered how we can use BGP to configure EVPN and VXLAN so they can create vpn tunnels between them and how they find each other.</p>
<p>I have not covered how the VTEPS advertise to the other VTEP peers which VNIs (or broadcast domains) they are interested in or participating in. It may not come as a surprise, but this will involve route type 3.</p>
<p>Below is the diagram illustrating how servers in the same broadcast domain think they are connected in a L3 spine-leaf.</p>
<p>They think they are connected like this:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250207102715229.png" alt="layer2" />
      
    </figure>
</p>
<p>But in reality they are connected like this:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250127092740097.png" alt="layer3" />
      
    </figure>
</p>
<p>For these two connected servers to find each other, the first thing they do is sending out an ARP request, which is broadcast traffic and thus part of a BUM packet (Broadcast Unknown Unicast Multicast), to figure out how to get the mac of the server to get the specific ip address. This BUM is sent using &ldquo;ingress replication&rdquo; as default from local VTEP to remote VTEPs, encapsulated into a VXLAN-packet for the respective VTEP destination. BUM may also be sent using EVPN multicast which is something I will get back to in a later post. If the request comes from Server 1 on VLAN 11 leaf1a will forward this BUM packet to all local ports configured with VLAN 11, if the server 2 is not there it needs to forward this BUM to the other VTEP peers where Server 2 may be connected.  I know where they are connected, but how do the VTEPs know where the servers are connected in my fabric so they can forward this BUM packet to the other VTEPs?</p>
<p>In short, route type 3 will be used by the VTEPs to advertise their participation in a broadcast domain (VLAN-VNI mapping). Leaf1a hosts Server 1 connected to VLAN 11 and if this server needs to reach Server 2 also at VLAN 11, but hosted at leaf2b leaf1a and leaf2b must form a tunnel for the same broadcast domain (layer 2). By using route type 3 this is advertised when I configure the VLAN to VNI mapping on both VTEPS. This way the source VTEP will only send BUM packets to remote VTEPS participating in the same VXLAN segment.</p>
<p>Without EVPN route type 3 there will be no connectivity between the hosts connected to same VLAB but on different VTEPS.</p>
<p>Lets have a look at how this route type.</p>
<p>First the inclusive multicast ethernet tag route EVPN NRLI:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">               +---------------------------------------+
</span></span><span class="line"><span class="cl">               <span class="p">|</span>  RD <span class="o">(</span><span class="m">8</span> octets<span class="o">)</span>                        <span class="p">|</span>
</span></span><span class="line"><span class="cl">               +---------------------------------------+
</span></span><span class="line"><span class="cl">               <span class="p">|</span>  Ethernet Tag ID <span class="o">(</span><span class="m">4</span> octets<span class="o">)</span>           <span class="p">|</span>
</span></span><span class="line"><span class="cl">               +---------------------------------------+
</span></span><span class="line"><span class="cl">               <span class="p">|</span>  IP Address Length <span class="o">(</span><span class="m">1</span> octet<span class="o">)</span>          <span class="p">|</span>
</span></span><span class="line"><span class="cl">               +---------------------------------------+
</span></span><span class="line"><span class="cl">               <span class="p">|</span>  Originating Router<span class="err">&#39;</span>s IP Address      <span class="p">|</span>
</span></span><span class="line"><span class="cl">               <span class="p">|</span>          <span class="o">(</span><span class="m">4</span> or <span class="m">16</span> octets<span class="o">)</span>             <span class="p">|</span>
</span></span><span class="line"><span class="cl">               +---------------------------------------+
</span></span></code></pre></div><p>Then from my leaf1a and leaf2b I will run the command <em>show bgp evpn route-type imet vni 10011</em> (filtering for 10011).</p>
<p>leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a<span class="o">(</span>config-if-Vx1<span class="o">)</span><span class="c1">#show bgp evpn route-type imet vni 10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.3:10011 imet 10.255.1.3
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.4:10011 imet 10.255.1.4
</span></span><span class="line"><span class="cl">                                 10.255.1.4            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.4:10011 imet 10.255.1.4
</span></span><span class="line"><span class="cl">                                 10.255.1.4            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.5:10011 imet 10.255.1.5
</span></span><span class="line"><span class="cl">                                 10.255.1.5            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.5:10011 imet 10.255.1.5
</span></span><span class="line"><span class="cl">                                 10.255.1.5            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10011 imet 10.255.1.6
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10011 imet 10.255.1.6
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span></code></pre></div><p>leaf2b:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf2b#show bgp evpn route-type imet vni <span class="m">10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.6, <span class="nb">local</span> AS number <span class="m">65114</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.3:10011 imet 10.255.1.3
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.3:10011 imet 10.255.1.3
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.4:10011 imet 10.255.1.4
</span></span><span class="line"><span class="cl">                                 10.255.1.4            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.4:10011 imet 10.255.1.4
</span></span><span class="line"><span class="cl">                                 10.255.1.4            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.5:10011 imet 10.255.1.5
</span></span><span class="line"><span class="cl">                                 10.255.1.5            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.5:10011 imet 10.255.1.5
</span></span><span class="line"><span class="cl">                                 10.255.1.5            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.6:10011 imet 10.255.1.6
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span></code></pre></div><p>The first thing I notice is that all my leafs (VTEPS) are participating in VNI10011, the next hops are the respective VXLAN loopback interfaces (see earlier in this post for interfaces reference). I can see the RD: 10.255.0.x:10011, which represents the leafs EVPN loopback interfaces and the respective VNI. What I do not see here is any mac or mac-ip entries.</p>
<p>Now what more do I see if I add some more details to the output of the above command <em>show bgp evpn route-type imet vni 10011 detail</em> (I will only take a snippet of the output to keep it a bit shorter, its local and leaf1a and leaf2b respectively):</p>
<p>leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a<span class="o">(</span>config-if-Vx1<span class="o">)</span><span class="c1">#show bgp evpn route-type imet vni 10011 detail</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> imet 10.255.1.3, Route Distinguisher: 10.255.0.3:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">1</span> available
</span></span><span class="line"><span class="cl">  Local
</span></span><span class="line"><span class="cl">    - from - <span class="o">(</span>0.0.0.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref -, weight 0, tag 0, valid, local, best
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.3
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> imet 10.255.1.6, Route Distinguisher: 10.255.0.6:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.6
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.6
</span></span></code></pre></div><p>leaf2b:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf2b#show bgp evpn route-type imet vni <span class="m">10011</span> detail
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.6, <span class="nb">local</span> AS number <span class="m">65114</span>
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> imet 10.255.1.3, Route Distinguisher: 10.255.0.3:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.3
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.3
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> imet 10.255.1.6, Route Distinguisher: 10.255.0.6:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">1</span> available
</span></span><span class="line"><span class="cl">  Local
</span></span><span class="line"><span class="cl">    - from - <span class="o">(</span>0.0.0.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref -, weight 0, tag 0, valid, local, best
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span>
</span></span><span class="line"><span class="cl">      PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.6
</span></span></code></pre></div><p>The additional and required information that differs from the detailed output of route type 2 is this:</p>
<p><em>PMSI Tunnel: Ingress Replication, MPLS Label: 10011, Leaf Information Required: false, Tunnel ID: 10.255.1.6</em></p>
<p>PMSI Tunnel - Provider Multicast Service Interface - Ingress replication</p>
<p>MPLS Label - 10011 VNI ID</p>
<p>Tunnel ID -  VTEP VXLAN loopback interface</p>
<p>To sum up route type 3:</p>
<ul>
<li>Advertising their participation in specific broadcast domains between the VTEPS in the fabric</li>
<li>EVPN route type 3 is not about advertising host routes nor ip-subnets, but VNI participation.</li>
<li>BUM is only forward to those that are interested or require it.</li>
</ul>


<h2 class="relative group">Route Type 2 - MAC/IP advertisement route 
    <div id="route-type-2---macip-advertisement-route" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#route-type-2---macip-advertisement-route" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>EVPN route type 2&rsquo;s main purpose is to advertise hosts mac addresses &ldquo;over&rdquo; BGP and optionally hosts ip addresses in a /32 format (host routes) to all interested VTEP peers. BGP will be used to dynamically update the VTEP peers about the network reachability of hosts attached in the configured overlay networks so they can reach each other. Having a host connected to Leaf1a and another host connected to Leaf2a in the same Layer 2 broadcast domain (VLAN), when they interact, they use MAC addresses to communicate, as a result of ARP. How these mac-addresses and ip addresses are advertised and why this is needed is something I will try to explain and cover here.</p>
<p>In the previous <a href="https://blog.andreasm.io/2024/12/09/evpn-introduction/" target="_blank">post</a> I covered how the EVPN peers (all the leafs and spines) were advertised using BGP in the underlay to establish a secure BGP connection between all the peers. Similarily BGP is used to advertise the VTEP peers themselves in the fabric (the leafs). This configuration is done so the VTEPs can discover each other in the fabric and are able to encapsulate and forward VXLAN traffic between them using stateless tunnels. VXLAN uses a shim header inserted between the IP/UDP headers and the inner Ethernet frame, allowing Layer 2 frames to be tunneled over a Layer 3 network without establishing stateful tunnels. Why I mention a secure connection is because I am using authentication between all the peers in the fabric, including the spines. One cant just add a new BGP peer in the fabric without the correct authentication, these will be dropped, this to minimize unwanted BGP peers. One can probably do more to secure the BGP connection like ACLs, additional prefix lists etc. Not in the scope for this post. Using BGP instead of static routes brings a whole lot more flexibility, and as it removes any flood and learn across the fabric, or between the vteps, the network is much more optimised and scale better. Now as this is an EVPN/VXLAN fabric stretching layer 2 over a layer 3 fabric, I need BGP to also advertise layer 2 mac addresses between the VTEPS. This is where EVPN route type 2 comes into play.</p>
<p>To get some more context below is my topology with their respective leafs loopback interfaces:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250124152144218.png" alt="loopback_interfaces_underlay" />
      
    </figure>
</p>
<p>Lets have a look at the bgp neighbors and routing table in the underlay from spine1 and leaf1a (10.255.255.x/x are the P2P links):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-spine1#show bgp summary
</span></span><span class="line"><span class="cl">BGP summary information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.1, <span class="nb">local</span> AS number <span class="m">65110</span>
</span></span><span class="line"><span class="cl">Neighbor               AS Session State AFI/SAFI                AFI/SAFI State   NLRI Rcd   NLRI Acc
</span></span><span class="line"><span class="cl">------------- ----------- ------------- ----------------------- -------------- ---------- ----------
</span></span><span class="line"><span class="cl">10.255.0.3          <span class="m">65111</span> Established   L2VPN EVPN              Negotiated             <span class="m">21</span>         <span class="m">21</span>
</span></span><span class="line"><span class="cl">10.255.0.4          <span class="m">65112</span> Established   L2VPN EVPN              Negotiated             <span class="m">21</span>         <span class="m">21</span>
</span></span><span class="line"><span class="cl">10.255.0.5          <span class="m">65113</span> Established   L2VPN EVPN              Negotiated             <span class="m">21</span>         <span class="m">21</span>
</span></span><span class="line"><span class="cl">10.255.0.6          <span class="m">65114</span> Established   L2VPN EVPN              Negotiated             <span class="m">77</span>         <span class="m">77</span>
</span></span><span class="line"><span class="cl">10.255.255.1        <span class="m">65111</span> Established   IPv4 Unicast            Negotiated              <span class="m">2</span>          <span class="m">2</span>
</span></span><span class="line"><span class="cl">10.255.255.5        <span class="m">65112</span> Established   IPv4 Unicast            Negotiated              <span class="m">2</span>          <span class="m">2</span>
</span></span><span class="line"><span class="cl">10.255.255.9        <span class="m">65113</span> Established   IPv4 Unicast            Negotiated              <span class="m">2</span>          <span class="m">2</span>
</span></span><span class="line"><span class="cl">10.255.255.13       <span class="m">65114</span> Established   IPv4 Unicast            Negotiated              <span class="m">2</span>          <span class="m">2</span>
</span></span></code></pre></div><p>In the bgp routing table we can see both the EVPN and VXLAN loopback interfaces. Note that I only have 4 VTEP entries as I only configure VXLAN on the leafs. Next hop is the respective switches P2P interfaces.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-spine1#show ip bgp
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.1, <span class="nb">local</span> AS number <span class="m">65110</span>
</span></span><span class="line"><span class="cl">Route status codes: s - suppressed contributor, * - valid, &gt; - active, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    S - Stale, c - Contributing to ECMP, b - backup, L - labeled-unicast
</span></span><span class="line"><span class="cl">                    % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">RPKI Origin Validation codes: V - valid, I - invalid, U - unknown
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  AIGP       LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;      10.255.0.1/32          -                     -       -          -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.0.3/32          10.255.255.1          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.0.4/32          10.255.255.5          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.0.5/32          10.255.255.9          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.0.6/32          10.255.255.13         <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.1.3/32          10.255.255.1          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.1.4/32          10.255.255.5          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65112</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.1.5/32          10.255.255.9          <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65113</span> i
</span></span><span class="line"><span class="cl"> * &gt;      10.255.1.6/32          10.255.255.13         <span class="m">0</span>       -          <span class="m">100</span>     <span class="m">0</span>       <span class="m">65114</span> i
</span></span></code></pre></div><p>This is just to verify that all my peers are advertised as they should, now if I add an overlay network like this:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250127092740097.png" alt="image-20250127092740097" />
      
    </figure>
</p>
<p>I have configured an overlay network with two hosts connected to each their leaf, they are in the same layer 2 network, they can reach each other as it was a regular VLAN between two switches using layer 2 links. The hosts or servers themselves are not aware of any VXLAN configuration, spine leaf or layer 3 links, as far as they are concerned they think they are connected to the same vlan or broadcast domain.  They think they are connected like this:</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250207102715229.png" alt="layer2" />
      
    </figure>
</p>
<p>Using the information from Route Type 3, the ARP request from server 1 is sent as BUM traffic to all relevant VTEPs in the VXLAN segment, including the VTEP hosting server 2. When server 2 responds, its VTEP advertises a Route Type 2 with the MAC/IP mapping. This allows future unicast traffic from server 1 to go directly to the correct VTEP without any further flooding.</p>
<p>Lets have a look at the bgp evpn route type 2 at both leaf1a and leaf2b below (sorted on the VNI 10011):</p>
<p>Leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a#show bgp evpn route-type mac-ip vni <span class="m">10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span></code></pre></div><p>Leaf2b:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf2b#show bgp evpn route-type mac-ip vni <span class="m">10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.6, <span class="nb">local</span> AS number <span class="m">65114</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span></code></pre></div><p>By using the command <em>show bgp evpn route-type mac-ip vni 10011</em> (filtering for the specific VNI) to list the route type 2 entries on my leaf1a and leaf2b I can see the entries in the bgp routing table reflecting the mac-addresses of both the connected servers 1 and 2 in this VNI.</p>
<p>At first glance they look very similar except some &ldquo;opposite&rdquo; information, we can see the mac addresses of <em>Server 1</em> and <em>Server 2</em> respectively. <em>Leaf1a</em> contains a single entry of the mac address information of <em>Server 1</em> as it is locally present on leaf1a and two entries of the mac address information of <em>Server 2</em>, while <em>leaf2b</em> contains the exact opposite.</p>
<p>Leaf1a has the VNI 10011 locally configured, so do leaf2b. Leaf1a will advertise server 1&rsquo;s mac address in BGP using itself as a Route Distinguisher while it receives the mac address information for server 2 from leaf2b, RD 10.255.0.6:10011. There are two entries for server 2 because it contains two potential paths (via my two spines) using ECMP. The current active path is indicated with &gt;Ec (ECMP head).</p>
<p>If I have configured an anycast gateway (IRB) on the VLAN interface, (see <a href="https://blog.andreasm.io/2024/12/09/evpn-introduction/#integrated-routing-and-bridging-irb" target="_blank">here</a>), additional entries in BGP will be installed combining the mac+ip as a host route (/32). The reason for /32 routes (host routes) is because an anycast gateway is a distributed router and exists on more than one leaf I cant have a /24 advertised on all gateways as they dont know where to forward the traffic if the destination is not local.</p>
<p>Having a look at the bgp evpn route type 2 entries for server 1 and server 2 with anycast configured:</p>
<p>Leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a#show bgp evpn route-type mac-ip vni <span class="m">10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4 10.20.11.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4 10.20.11.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.3:10011 mac-ip bc24.1144.8595 10.20.11.10
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span></code></pre></div><p>Leaf2b:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf2b#show bgp evpn route-type mac-ip vni <span class="m">10011</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.6, <span class="nb">local</span> AS number <span class="m">65114</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;      RD: 10.255.0.6:10011 mac-ip bc24.1140.f4e4 10.20.11.14
</span></span><span class="line"><span class="cl">                                 -                     -       -       <span class="m">0</span>       i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595 10.20.11.10
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.3:10011 mac-ip bc24.1144.8595 10.20.11.10
</span></span><span class="line"><span class="cl">                                 10.255.1.3            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65111</span> i
</span></span></code></pre></div><p>Now in additon to just the mac address of my servers 1 and 2 I also have the mac+ip entries with the same amount of paths.</p>
<p>With anycast configured EVPN route-type 2 will advertise both mac and mac-ip.</p>
<p><em>Throughout this post the expressions L2VNI and L3VNI will be used. A VNI is a VNI, a VNI can be mapped to a VLAN and a VRF. But to differenciate between a VNI that is mapped to a VLAN or VRF the expressions above is used.</em></p>
<p>To get more details on the routing table on my leaf1a for the entry of my remote <em>Server 2</em> I can get that by typing <em>show bgp evp detail</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a#show bgp evpn detail
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1140.f4e4, Route Distinguisher: 10.255.0.6:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1140.f4e4 10.20.11.14, Route Distinguisher: 10.255.0.6:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:5e:4a:59
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:5e:4a:59
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span></code></pre></div><p>This gives me some additional information, if needed, including the mac addresses of the remote leaf (leaf2b). Notice the L3 VNI: 10 which is my VRF20 mapped to VNI 10 (L3VNI/IP-VRF).</p>
<p>Now lets try to map that with the EVPN NLRI of a route type 2:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> RD <span class="o">(</span><span class="m">8</span> octets<span class="o">)</span>                          <span class="p">|</span> -&gt; 10.255.0.6:10011
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Ethernet Segment Identifier <span class="o">(</span><span class="m">10</span> octets<span class="o">)</span><span class="p">|</span> -&gt; 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> Ethernet Tag ID <span class="o">(</span><span class="m">4</span> octets<span class="o">)</span>             <span class="p">|</span> -&gt; <span class="m">0</span> <span class="o">(</span>using VXLAN<span class="o">)</span>
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> MAC Address Length <span class="o">(</span><span class="m">1</span> octet<span class="o">)</span>           <span class="p">|</span> -&gt; <span class="m">6</span>
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> MAC Address <span class="o">(</span><span class="m">6</span> octets<span class="o">)</span>                 <span class="p">|</span> -&gt; bc.24.11.40.f4.e4
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> IP Address Length <span class="o">(</span><span class="m">1</span> octet<span class="o">)</span>            <span class="p">|</span> -&gt; <span class="m">4</span>
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> IP Address <span class="o">(</span>0, 4, or <span class="m">16</span> octets<span class="o">)</span>        <span class="p">|</span> -&gt; 10.20.11.14
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> MPLS Label1 <span class="o">(</span><span class="m">3</span> octets<span class="o">)</span>                 <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span> MPLS Label2 <span class="o">(</span><span class="m">0</span> or <span class="m">3</span> octets<span class="o">)</span>            <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----------------------------------------+
</span></span></code></pre></div>

<h4 class="relative group">MAC-VRF vs IP-VRF 
    <div id="mac-vrf-vs-ip-vrf" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#mac-vrf-vs-ip-vrf" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Sometimes the expressions mac-vrf and ip-vrf are being used without any explanation of what they are or what they do. So I decided to just quickly try to explain what these two are.</p>
<p>First some basics which these two build upon.</p>
<p>A VLAN is a way to create layer 2, or broadcast domain, isolation in the network, I can have overlapping mac-addresses between vlans. Every VLAN has its own mac address table. A VLAN is at the data link layer (OSI 2) and uses MAC addresses which is broadcasted in the same VLAN to find its &ldquo;peers&rdquo; MAC addresses it needs to communicate with. There is no sence of IP addresses within the same VLAN, it only comes into play if I need to communicate across VLANS, using layer 3.</p>
<p>A VRF (Virtual Routing and Forwarding) is an isolated routing instance with its own isolated routing table, allowing multiple routing tables to coexist on a single device. IP addresses and IP prefixes within a VRF are separate from those in other VRFs, allowing for overlapping IP address spaces. VRF is primarily concerned with IP routing and is at the network layer (Layer 3) in the OSI model (OSI 3). In a physical network, VRFs can create isolated routing domains to maintain separation of routing decisions, such as for multi-tenancy. By default, there is no reachability between network segments in different VRFs, meaning network A in VRF A cannot reach network B in VRF B unless explicitly configured with inter-VRF routing or if traffic is routed in a firewall and rules to allow between the VRFs are in place.</p>
<blockquote>
<ul>
<li><strong>MAC-VRF:</strong> A Virtual Routing and Forwarding table for storing Media Access Control (MAC) addresses on a VTEP for a specific tenant.</li>
</ul>
</blockquote>
<p>Source: <a href="https://www.arista.com/en/um-eos/eos-evpn-overview" target="_blank">https://www.arista.com/en/um-eos/eos-evpn-overview</a></p>
<p>Why is mac-vrf good to know about in this context? MAC-vrf is the forwarding table for mac addresses, like BGP is maintaining regular ip address forwarding table BGP-EVPN can also maintain mac address forwarding table. These tables will be used by the VTEPS to know where the different mac-addresses are located, which VTEP currently has this mac-address. As seen above the mac address <em>bc24.1140.f4e4</em> is currently local to VTEP or Route Distinguisher 10.255.0.6 which is <em>leaf2b</em> which is then advertised to the other VTEP members through BGP. By enabling EVPN (using MP-BGP) we use BGP to maintain this mac address routing table instead of using flood and learn which would not work either as these l2 networks is not part of the underlay so even with flood and learn they would not learn anything from any of the other leafs, as described in the EVPN introduction post. In a layer 3 spine leaf without any use of overlay or network virtualization the l2 segments/or broadcast domains will be isolated to their local leaf.  In this context the VLAN which is mapped to a VNI and then configured in BGP for mac-advertisement is my MAC-VRF.</p>
<blockquote>
<p>An <strong>IP VRF</strong> is used on a PE router for each Layer 3 overlay. VRF IP routes are exported into the EVPN BGP table and advertised to remote VTEPs as type 5 routes.</p>
</blockquote>
<p>Source: <a href="https://www.arista.com/en/um-eos/eos-evpn-overview" target="_blank">https://www.arista.com/en/um-eos/eos-evpn-overview</a></p>
<p>Why is IP VRF good to know about in this context? As mentioned in my previous <a href="https://blog.andreasm.io/2024/12/09/evpn-introduction/#integrated-routing-and-bridging-irb" target="_blank">post</a> under the topic <em>&ldquo;integrated routing and bridging&rdquo;</em> to achieve a scalable configuration without having all the leafs being members of all subnets/VNIs the recommended approach is symmetric irb. In EVPN VXLAN, each VLAN mapped to a VNI represents a MAC-VRF. Instead of advertising all those mac-addresses to all leafs in the same VXLAN fabric a more efficient way is to advertise ip-prefixes or host-routes only. By mapping a VNI to a VRF to create a L3VNI and defining that VRF in BGP with a Route Destinguisher and Route Target accordingly I create an intermediate IP-VRF that will be used as connectivity between local subnets an non-local subnets (exists on remote VTEPs). Via this IP-VRF I can exhange routes between VTEPS for networks that is part of the same VRF. I can have multiple IP-VRFs defined to maintain isolated routing instances across my VXLAN fabric.</p>
<p>
    <figure>
      <img class="my-0 rounded-md" loading="lazy" src="images/image-20250131103032746.png" alt="ip-vrf" />
      
    </figure>
</p>
<p>In the illustration above I am using IP-VRF to advertise reachability between two VTEPS configured with two distinct VLANs (mac-vrfs), Server-1 uses the NLRI over the intermediate IP-VRF VN10 to reach Server-2. In BGP I can see the routes for both servers in both leafs like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">leaf1a:
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1140.f4e4, Route Distinguisher: 10.255.0.6:10014
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10014:10014 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10014</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10014:10014 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10014</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1140.f4e4 10.20.14.14, Route Distinguisher: 10.255.0.6:10014
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10014:10014 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:5e:4a:59
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10014</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65114</span>
</span></span><span class="line"><span class="cl">    10.255.1.6 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10014:10014 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:5e:4a:59
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10014</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">leaf2b:
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1144.8595, Route Distinguisher: 10.255.0.3:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">BGP routing table entry <span class="k">for</span> mac-ip bc24.1144.8595 10.20.11.10, Route Distinguisher: 10.255.0.3:10011
</span></span><span class="line"><span class="cl"> Paths: <span class="m">2</span> available
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.1 <span class="o">(</span>10.255.0.1<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP head, ECMP, best, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:1d:5f:a1
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span><span class="line"><span class="cl">  <span class="m">65110</span> <span class="m">65111</span>
</span></span><span class="line"><span class="cl">    10.255.1.3 from 10.255.0.2 <span class="o">(</span>10.255.0.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">      Origin IGP, metric -, localpref 100, weight 0, tag 0, valid, external, ECMP, ECMP contributor
</span></span><span class="line"><span class="cl">      Extended Community: Route-Target-AS:10:10 Route-Target-AS:10011:10011 TunnelEncap:tunnelTypeVxlan EvpnRouterMac:bc:24:11:1d:5f:a1
</span></span><span class="line"><span class="cl">      VNI: <span class="m">10011</span> L3 VNI: <span class="m">10</span> ESI: 0000:0000:0000:0000:0000
</span></span></code></pre></div><p>If I check the mac-address table for VLAN 14 on leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a#show mac address-table vlan <span class="m">14</span>
</span></span><span class="line"><span class="cl">          Mac Address Table
</span></span><span class="line"><span class="cl">------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vlan    Mac Address       Type        Ports      Moves   Last Move
</span></span><span class="line"><span class="cl">----    -----------       ----        -----      -----   ---------
</span></span><span class="line"><span class="cl">Total Mac Addresses <span class="k">for</span> this criterion: <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Multicast Mac Address Table
</span></span><span class="line"><span class="cl">------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vlan    Mac Address       Type        Ports
</span></span><span class="line"><span class="cl">----    -----------       ----        -----
</span></span><span class="line"><span class="cl">Total Mac Addresses <span class="k">for</span> this criterion: <span class="m">0</span>
</span></span></code></pre></div><p>Empty</p>
<p>If I check the mac-address table for VLAN 11 on leaf2b:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf2b<span class="o">(</span>config-if-Et4<span class="o">)</span><span class="c1">#show mac address-table vlan 11</span>
</span></span><span class="line"><span class="cl">          Mac Address Table
</span></span><span class="line"><span class="cl">------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vlan    Mac Address       Type        Ports      Moves   Last Move
</span></span><span class="line"><span class="cl">----    -----------       ----        -----      -----   ---------
</span></span><span class="line"><span class="cl">  <span class="m">11</span>    bc24.1144.8595    DYNAMIC     Vx1        <span class="m">1</span>       <span class="m">21</span> days, 20:54:50 ago <span class="c1">## Server1</span>
</span></span><span class="line"><span class="cl">Total Mac Addresses <span class="k">for</span> this criterion: <span class="m">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Multicast Mac Address Table
</span></span><span class="line"><span class="cl">------------------------------------------------------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Vlan    Mac Address       Type        Ports
</span></span><span class="line"><span class="cl">----    -----------       ----        -----
</span></span><span class="line"><span class="cl">Total Mac Addresses <span class="k">for</span> this criterion: <span class="m">0</span>
</span></span></code></pre></div><p>Not so empty&hellip; Why is that?
If the mac-vrf exists (VLAN) on the receiving VTEP it will install the mac-address in the mac-vrf (corresponding vlan) and the mac+ip host route will be installed in the IP-VRF. If the mac-vrf does not exist on the receiving VTEP only the mac+ip host route is installed. This saves space by not installing mac entries that are not present locally, but relies on BGP host routes to reach those remote mac entries.</p>
<p>But still the mac-address route will be installed in the BGP table of the receiving leaf when the mac-vrf/vlan doesn&rsquo;t exist.</p>
<p>In large environments scalability is critical and wasting space with unnecessary information is not a good idea. Symmetric IRB is optimal in large scale environments as it does not mandate having all VNIs configured on all leafs, and saves mac address table space. But as we have seen so far even with symmetric IRB the mac-address routes are installed in BGP on leafs where the VNI is not present. This may seem unnecessary. To easily accommodate for that there is an address-family called <em>rt-membership</em>.</p>


<h4 class="relative group">Constrained Route Distribution - RFC 4684 
    <div id="constrained-route-distribution---rfc-4684" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#constrained-route-distribution---rfc-4684" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc4684" target="_blank">RFC 4684</a> introduces procedures for BGP speakers to exchange Route Target (RT) reachability information across BGP/MPLS VPNs, allowing more controlled distribution of VPN routing information. The approach helps limit the number of routes carried by inter-AS or inter-cluster routers, improving scalability and efficiency. In short, it is used to reduce the number of routes advertised in the EVPN fabric.</p>
<p>This must be configured on both the sending and receiving devices, which in my case means all the leafs and spines.</p>
<p>Before configuring the rt-membership address family lets have quick refresh on how the routes on leaf1a are advertised for VNI 10014 which is only configured on leaf2b.</p>
<p>On leaf1a:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a<span class="o">(</span>config-if-Vl11<span class="o">)</span><span class="c1">#show bgp evpn route-type mac-ip vni 10014</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4 10.20.14.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4 10.20.14.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span></code></pre></div><p>I see both the mac-address and mac+ip entries.</p>
<p>After having the address familiy configured I can have a look at my routing table again and see if I notice any difference:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">veos-dc1-leaf1a<span class="o">(</span>config-if-Vl11<span class="o">)</span><span class="c1">#show bgp evpn route-type mac-ip vni 10014</span>
</span></span><span class="line"><span class="cl">BGP routing table information <span class="k">for</span> VRF default
</span></span><span class="line"><span class="cl">Router identifier 10.255.0.3, <span class="nb">local</span> AS number <span class="m">65111</span>
</span></span><span class="line"><span class="cl">Route status codes: * - valid, &gt; - active, S - Stale, E - ECMP head, e - ECMP
</span></span><span class="line"><span class="cl">                    c - Contributing to ECMP, % - Pending best path selection
</span></span><span class="line"><span class="cl">Origin codes: i - IGP, e - EGP, ? - incomplete
</span></span><span class="line"><span class="cl">AS Path Attributes: Or-ID - Originator ID, C-LST - Cluster List, LL Nexthop - Link Local Nexthop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          Network                Next Hop              Metric  LocPref Weight  Path
</span></span><span class="line"><span class="cl"> * &gt;Ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4 10.20.14.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span><span class="line"><span class="cl"> *  ec    RD: 10.255.0.6:10014 mac-ip bc24.1140.f4e4 10.20.14.14
</span></span><span class="line"><span class="cl">                                 10.255.1.6            -       <span class="m">100</span>     <span class="m">0</span>       <span class="m">65110</span> <span class="m">65114</span> i
</span></span></code></pre></div><p>I now only see the host routes, mac+ip.</p>
<p>To configure this is straight forward, in your BGP configuration add these lines:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">   address-family rt-membership
</span></span><span class="line"><span class="cl">      neighbor EVPN-OVERLAY-PEERS activate <span class="c1"># EVPN loopback interfaces group</span>
</span></span></code></pre></div><p>If using AVD (Arista Validated Design) one can add this in your <em>fabric</em> config:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Enable Route Target Membership Constraint Address Family on EVPN overlay BGP peerings (Min. EOS 4.25.1F).</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Requires use eBGP as overlay protocol.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">evpn_overlay_bgp_rtc</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>Link to the section in AVD <a href="https://avd.arista.com/5.1/roles/eos_designs/docs/input-variables.html?h=evpn_overlay_bgp_rtc#evpn-settings" target="_blank">here</a></p>
<p>For more information on <em>rt-membership</em> see the following <a href="https://datatracker.ietf.org/doc/html/rfc4684" target="_blank">RFC4684</a>.</p>
<p>To sum up the main responsibilites of BGP EVPN route type 2:</p>
<ul>
<li>Advertise the hosts mac-addresses between the VTEPS</li>
<li>Advertise the hosts mac-ip host routes between the VTEPS</li>
<li>ARP suppression - remote hosts mac-ip is known and VTEPs reply to ARP requests from locally connected hosts instead of going over the fabric to get it.
<ul>
<li>Handling ARP advertisements efficiently, reducing ARP broadcasts and flooding. In environments with dynamic workloads like virtual machines being moved between physical hosts it handles updates efficiently, including GARP updates. Ensures ARP tables are refreshed and ip-to-mac mappings are correctly propagated.</li>
</ul>
</li>
</ul>


<h2 class="relative group">Egress 
    <div id="egress" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#egress" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>EVPN route type 2 is responsible for advertising mac-addresses and associated ip addresses (host routes) between VTEPS.</p>
<p>EVPN route type 3 advertises VTEPS participation in broadcast domains.</p>
<p>Now we know what EVPN route type 2 and 3 does, and why it is the two most common EVPN route types.</p>

          
          
          
        </div>
        
        

        
        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:1313/2025/01/23/evpn-route-types-5/&amp;title=EVPN%20Route%20Types%205"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=http://localhost:1313/2025/01/23/evpn-route-types-5/&amp;text=EVPN%20Route%20Types%205"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://s2f.kytta.dev/?text=EVPN%20Route%20Types%205%20http://localhost:1313/2025/01/23/evpn-route-types-5/"
      title=""
      aria-label=""
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=http://localhost:1313/2025/01/23/evpn-route-types-5/&amp;subject=EVPN%20Route%20Types%205"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


        


<h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
<section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
  
  

  <a href="/2025/01/23/evpn-route-types-2-and-3/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2025/01/23/evpn-route-types-2-and-3/feature-arista-networks.jpg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2025/01/23/evpn-route-types-2-and-3/">EVPN Route Types 2 and 3 </div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2025-01-23T10:17:20&#43;01:00">23 January 2025</time><span class="px-2 text-primary-500">&middot;</span><span>5867 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">28 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          Going into details of EVPN route type 2 and 3
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/2024/12/09/evpn-introduction/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2024/12/09/evpn-introduction/feature-arista-networks.jpg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2024/12/09/evpn-introduction/">EVPN introduction</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-12-09T14:55:58&#43;01:00">9 December 2024</time><span class="px-2 text-primary-500">&middot;</span><span>9172 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">44 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/encapsulation/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Encapsulation
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/evpn/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EVPN
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/multi-tenancy/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Multi-Tenancy
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/vxlan/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Vxlan
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          First post in a series of posts covering EVPN and getting to know EVPN with Arista EOS
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
  

  <a href="/2024/11/08/overlay-on-overlay-arista-in-the-underlay/" class="min-w-full">
    
    <div class="min-h-full border border-neutral-200 dark:border-neutral-700 border-2 rounded overflow-hidden shadow-2xl relative">
        
        <div class="w-full thumbnail_card_related nozoom" style="background-image:url(/2024/11/08/overlay-on-overlay-arista-in-the-underlay/feature-arista-networks.jpg);"></div>
        
      

      <div class="px-6 py-4">

        
        <div class="font-bold text-xl text-neutral-800 decoration-primary-500 hover:underline hover:underline-offset-2 dark:text-neutral"
          href="/2024/11/08/overlay-on-overlay-arista-in-the-underlay/">Overlay on overlay - Arista in the underlay</div>
        

        <div class="text-sm text-neutral-500 dark:text-neutral-400">
          











  





  



  













<div class="flex flex-row flex-wrap items-center">
  
  
  <time datetime="2024-11-08T08:56:51&#43;01:00">8 November 2024</time><span class="px-2 text-primary-500">&middot;</span><span>10127 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">48 mins</span>
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/eos/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EOS
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/arista/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Arista
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/encapsulation/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Encapsulation
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/categories/topologies/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Topologies
  </span>
</span>
  </span>
  
  
  
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/networking/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Networking
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/eos/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    EOS
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/arista/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Arista
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/overlay/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Overlay
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/encapsulation/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Encapsulation
  </span>
</span>
  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/topologies/&#34;,'_self');return false;">
    <span class="flex" style="cursor: pointer;">
  <span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Topologies
  </span>
</span>
  </span>
  
  
  
  
</div>




        </div>

        
        <div class="py-1 prose dark:prose-invert">
          Describing typical deployments where we end up with double encapsulation, how to monitor, troubleshoot
        </div>
        
      </div>
      <div class="px-6 pt-4 pb-2">

      </div>
    </div>
  </a>

  
</section>

  
      </div>
     
      
      
        
        
          
          
        
      <script>
        var oid = "views_posts\/2025-08-13-evpn-route-type-5\/index.md"
        var oid_likes = "likes_posts\/2025-08-13-evpn-route-type-5\/index.md"
      </script>
      
      
      <script type="text/javascript" src="/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js" integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q&#43;oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script>
      
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/2024/12/09/evpn-introduction/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >EVPN introduction</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-12-09T14:55:58&#43;01:00">9 December 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/2025/01/23/evpn-route-types-2-and-3/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >EVPN Route Types 2 and 3 </span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-01-23T10:17:20&#43;01:00">23 January 2025</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/tags/"
            title="">
            
            Tags
          </a>
        </li>
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="/categories/"
            title="">
            
            Categories
          </a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    
    <p class="text-sm text-neutral-500 dark:text-neutral-400">
      &copy;
      2025
      Andreas Marqvardsen
    </p>
    

    
    
    <p class="text-xs text-neutral-500 dark:text-neutral-400">
      
      
      Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
        href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
    </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="http://localhost:1313/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
