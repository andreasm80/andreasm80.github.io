
<!DOCTYPE html>
<html
  lang="en"
  data-figures=""
  
    class="page"
  
  
  
    data-mode="dim"
  >
  <head>
<title>Taking Rancher by SUSE for a Spin | From 0.985mhz... to several Ghz</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TVPYDVE8KR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-TVPYDVE8KR');
</script>



  
<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="Trying out Rancher and some of its capabilities" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="Taking Rancher by SUSE for a Spin" />
<meta name="twitter:image" content="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/images/rancher-suse-logo-horizontal-color.svg"/>
<meta property="og:url" content="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/" />
<meta property="og:title" content="Taking Rancher by SUSE for a Spin" />
<meta property="og:description" content="Trying out Rancher and some of its capabilities" />
<meta property="og:image" content="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/images/rancher-suse-logo-horizontal-color.svg" />
  <meta name="keywords" content="nsx,vmware,networking,infrastucture,lodbalancing,tanzu,security,cni,antrea,cilium,kubernetes" />

<link rel="apple-touch-icon" sizes="180x180" href="https://blog.andreasm.io/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.andreasm.io/icons/favicon-32x32.png">
<link rel="manifest" href="https://blog.andreasm.io/icons/site.webmanifest">

<link rel="canonical" href="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/">



<link rel="preload" href="https://blog.andreasm.io/css/styles.6c67fa3a7f5290a2facfb027358dd2bdb5450d04b8de427c8a74d79f524a7fb716b470b14b6ba95f1b7cf3aa9a2219a7294a6adeaf16a1080f432eae45d8c03c.css" integrity = "sha512-bGf6On9SkKL6z7AnNY3SvbVFDQS43kJ8inTXn1JKf7cWtHCxS2upXxt886qaIhmnKUpq3q8WoQgPQy6uRdjAPA==" as="style" crossorigin="anonymous">



<link rel="preload" href="https://blog.andreasm.io/en/js/bundle.5548d358738600c857a1f05f0459418da7143d4426c66a08bf3f15ded1b39dd2136bf104a559247a909fc4dcc45b8e06bad0870ece4c71ee5303d30550def8bd.js" as="script" integrity=
"sha512-VUjTWHOGAMhXofBfBFlBjacUPUQmxmoIvz8V3tGzndITa/EEpVkkepCfxNzEW44GutCHDs5Mce5TA9MFUN74vQ==" crossorigin="anonymous">


<link rel="stylesheet" type="text/css" href="https://blog.andreasm.io/css/styles.6c67fa3a7f5290a2facfb027358dd2bdb5450d04b8de427c8a74d79f524a7fb716b470b14b6ba95f1b7cf3aa9a2219a7294a6adeaf16a1080f432eae45d8c03c.css" integrity="sha512-bGf6On9SkKL6z7AnNY3SvbVFDQS43kJ8inTXn1JKf7cWtHCxS2upXxt886qaIhmnKUpq3q8WoQgPQy6uRdjAPA==" crossorigin="anonymous">


  </head>
  <body
    data-code="15"
    data-lines="false"
    id="documentTop"
    data-lang="en"
  >

<header class="nav_header" >
  <nav class="nav"><a href='https://blog.andreasm.io/' class="nav_brand nav_item" title="From 0.985mhz... to several Ghz">
  <img src="https://blog.andreasm.io/quote3.png" class="logo" alt="From 0.985mhz... to several Ghz">
  <div class="nav_close">
    <div><svg class="icon">
  <title>open-menu</title>
  <use xlink:href="#open-menu"></use>
</svg>
<svg class="icon">
  <title>closeme</title>
  <use xlink:href="#closeme"></use>
</svg>
</div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://blog.andreasm.io/" class="nav_item" title="Home">Home </a>
  </div>
  <div class="nav_parent">
    <a href="https://blog.andreasm.io/about/" class="nav_item" title="About">About </a>
  </div>
      
<div class='follow'>
    
  <a href="https://blog.andreasm.io/index.xml">
    <svg class="icon">
  <title>rss</title>
  <use xlink:href="#rss"></use>
</svg>

  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">Taking Rancher by SUSE for a Spin</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <title>calendar</title>
  <use xlink:href="#calendar"></use>
</svg>
</span>
    <span class="post_date">
      05-05-2024</span>
    <span class="post_time"> · 52 min read</span><span>&nbsp;· <a href='https://blog.andreasm.io/tags/suse/' title="suse" class="post_tag button button_translucent">suse
        </a><a href='https://blog.andreasm.io/tags/rancher/' title="rancher" class="post_tag button button_translucent">rancher
        </a><a href='https://blog.andreasm.io/tags/kubernetes-management/' title="kubernetes-management" class="post_tag button button_translucent">kubernetes-management
        </a><a href='https://blog.andreasm.io/tags/rke2/' title="rke2" class="post_tag button button_translucent">rke2
        </a>
    </span>
    <span class="page_only">&nbsp;·
  <div class="post_share">
    Share on:
    <a href="https://twitter.com/intent/tweet?text=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin&url=https%3a%2f%2fblog.andreasm.io%2f2024%2f05%2f05%2ftaking-rancher-by-suse-for-a-spin%2f&tw_p=tweetbutton" class="twitter" title="Share on Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>twitter</title>
  <use xlink:href="#twitter"></use>
</svg>

    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.andreasm.io%2f2024%2f05%2f05%2ftaking-rancher-by-suse-for-a-spin%2f&t=Taking%20Rancher%20by%20SUSE%20for%20a%20Spin" class="facebook" title="Share on Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>facebook</title>
  <use xlink:href="#facebook"></use>
</svg>

    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="Share on LinkedIn" rel="nofollow">
      <svg class="icon">
  <title>linkedin</title>
  <use xlink:href="#linkedin"></use>
</svg>

    </a>
    <a href="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <title>copy</title>
  <use xlink:href="#copy"></use>
</svg>

    </a>
  </div>
  </span>
  </div>

      <div class="post_toc">
        <h2>Overview</h2>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#my-environments-used-in-this-post">My environments used in this post</a>
      <ul>
        <li><a href="#where-rancher-sits">Where Rancher sits</a></li>
      </ul>
    </li>
    <li><a href="#installing-rancher-on-an-existing-kubernetes-cluster-using-helm">Installing Rancher on an existing Kubernetes Cluster using Helm</a></li>
    <li><a href="#create-and-manage-kubernetes-clusters">Create and manage Kubernetes clusters</a>
      <ul>
        <li><a href="#rancher-kubernetes-distributions">Rancher Kubernetes distributions</a></li>
      </ul>
    </li>
    <li><a href="#create-rke2-clusters-using-vsphere">Create RKE2 clusters using vSphere</a>
      <ul>
        <li><a href="#create-cloud-credentials">Create Cloud Credentials</a></li>
        <li><a href="#rke2-clusters-using-vsphere-content-library-template">RKE2 clusters using vSphere Content Library template</a></li>
        <li><a href="#rke2-clusters-using-vsphere-vm-template">RKE2 clusters using vSphere VM template</a></li>
      </ul>
    </li>
    <li><a href="#creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider">Creating a RKE2 cluster on existing nodes - non native cloud provider</a>
      <ul>
        <li><a href="#creating-rke2-cluster-on-existing-nodes---custom-cloud">Creating RKE2 cluster on existing nodes - &quot;custom cloud&quot;</a></li>
      </ul>
    </li>
    <li><a href="#import-existing-kubernetes-clusters">Import existing Kubernetes Clusters</a></li>
    <li><a href="#navigating-the-rancher-ui">Navigating the Rancher UI</a>
      <ul>
        <li><a href="#rancher-cluster-dashboard">Rancher Cluster Dashboard</a></li>
        <li><a href="#accessing-my-new-rke2-cluster-deployed-on-vsphere">Accessing my new RKE2 cluster deployed on vSphere</a></li>
      </ul>
    </li>
    <li><a href="#managing-kubernetes-clusters-from-rancher">Managing Kubernetes clusters from Rancher</a>
      <ul>
        <li><a href="#scaling-nodes-horizontally---up-and-down">Scaling nodes horizontally - up and down</a></li>
        <li><a href="#scaling-nodes-vertically---add-cpu-ram-and-disk">Scaling nodes vertically - add cpu, ram and disk</a></li>
        <li><a href="#upgrading-kubernetes-clusters">Upgrading Kubernetes clusters</a></li>
        <li><a href="#installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator">Installing another Ingress controller than the default Ngninx - Avi Kubernetes Operator</a></li>
      </ul>
    </li>
    <li><a href="#installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni">Installing Custom CNI - bootstrapping new clusters using Antrea CNI</a>
      <ul>
        <li><a href="#add-on-config-using-manifest">Add-on Config using manifest</a></li>
        <li><a href="#add-on-config-using-helm-charts">Add-on Config using Helm Charts</a></li>
        <li><a href="#upgrading-or-changing-version-of-the-antrea-cni-using-rancher">Upgrading or changing version of the Antrea CNI using Rancher</a></li>
      </ul>
    </li>
    <li><a href="#neuvector">NeuVector</a></li>
    <li><a href="#monitoring">Monitoring</a></li>
    <li><a href="#the-rancher-api">The Rancher API</a></li>
    <li><a href="#authentication-and-rbac-with-rancher">Authentication and RBAC with Rancher</a></li>
    <li><a href="#outro">Outro</a></li>
  </ul>
</nav>
      </div>
    
    <div class="post_body"><h1 id="rancher-by-suse---short-introduction">Rancher by Suse - short introduction</h1>
<p>From the offical Rancher <a href="https://ranchermanager.docs.rancher.com/getting-started/overview">docs</a>:</p>
<blockquote>
<p>Rancher is a container management platform built for organizations that deploy containers in production. Rancher makes it easy to run Kubernetes everywhere, meet IT requirements, and empower DevOps teams.</p>
</blockquote>
<blockquote>
<p><strong>Run Kubernetes Everywhere</strong></p>
<p>Kubernetes has become the container orchestration standard. Most cloud and virtualization vendors now offer it as standard infrastructure. Rancher users have the choice of creating Kubernetes clusters with Rancher Kubernetes Engine (RKE) or cloud Kubernetes services, such as GKE, AKS, and EKS. Rancher users can also import and manage their existing Kubernetes clusters created using any Kubernetes distribution or installer.</p>
<p><strong>Meet IT Requirements</strong></p>
<p>Rancher supports centralized authentication, access control, and monitoring for all Kubernetes clusters under its control. For example, you can:</p>
<ul>
<li>Use your Active Directory credentials to access Kubernetes clusters hosted by cloud vendors, such as GKE.</li>
<li>Setup and enforce access control and security policies across all users, groups, projects, clusters, and clouds.</li>
<li>View the health and capacity of your Kubernetes clusters from a single-pane-of-glass.</li>
</ul>
</blockquote>
<p>Rancher can manage already existing Kubernetes clusters by importing them into Rancher, but Rancher can also do fully automated deployments of complete Kubernetes clusters.</p>
<p>The initial parts of this post will be focusing on getting Rancher itself deployed, then I will do some automated Kubernetes deployments from Rancher. The goal is to showcase how quick and easy it is to to deploy Kubernetes using Rancher. If it is not too obvious when reading these cluster creation chapters, trust me, deploying and managing Kubernetes cluster with Rancher is both fun and easy. After the initial chapters I will dive into some more technical topics.</p>
<p>This post is not meant to be a comprehensive article on all features/configurations possible with Rancher, look at it more as an <em>unboxing</em> Rancher post.</p>
<h2 id="my-environments-used-in-this-post">My environments used in this post</h2>
<p>In this post I will be using two platforms where I run and deploy my Kubernetes clusters. One platform is VMware vSphere the other is using Proxmox. Proxmox is running home in my lab, vSphere is running in another remote place and I am accessing it using IPsec VPN. In this post I will deploy Rancher in a Tanzu Kubernetes Cluster deployed in my vSphere lab. I already have Rancher running in one of my Kubernetes clusters in my Proxmox lab. The Rancher deployment in vSphere is just used to go through the installation of Rancher (I had already done the installation of Rancher before creating this post and didnt want to tear it down). The Rancher instance in my lab will be used for both importing existing Kubernetes clusters and the automated deployments of Kubernetes clusters on both the vSphere environment and Proxmox environment.</p>
<p>In a very high level diagram it should look like this:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="home-remote-environments"
      
        class="image_figure image_internal image_processed"
        width="3054"
        height="1316"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509112418043.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="where-rancher-sits">Where Rancher sits</h3>
<p>As I will proceed through this post by adding and deploying Kubernetes clusters and using Rancher accessing these clusters, it will make sense to illustrate how this looks like. It may be beneficial to the overall understanding to have as much context as possible of whats going on and how things work when reading through the post.</p>
<p>Running Rancher on Kubernetes makes Rancher Highly Available, it will be distributed across multiple Kubernetes worker nodes and also benefit from Kubernetes lifecycle management, self-healing etc. Rancher will become a critical endpoint so managing and ensuring availability to this endpoint is critical. Exposing the Rancher using a HA capable loadbalancer is something to consider. Loosing a singleton instance loadbalancer means loosing access to Rancher. To expose Rancher one can use VMware <a href="https://docs.vmware.com/en/VMware-NSX-Advanced-Load-Balancer/index.html">Avi Loadbalancer</a> with its distributed architecture (several Service Engines in Active/Active) or one can use Traefik loadbalancer, HAProxy Nginx, just to name a few. Then the underlaying physical compute hosts should consist of more than one host of course.</p>
<p>One should thrive to make the Rancher API endpoint as robust as possible as this will be THE endpoint to use to access and manage the Rancher managed Kubernetes Clusters.</p>
<img src=images/image-20240509114316030.png style="width:500px" />
<p>As one can imagine, managing multiple clusters using Rancher there will be some requests to this endpoint. So performance and resilience is key.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="rancher-proxy"
      
        class="image_figure image_internal image_processed"
        width="2352"
        height="1752"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509222710678.png"
      
      
    />

    </picture>
</figure>
</p>
<p>As soon as I have authenticated through Rancher I can access my Kubernetes clusters. Rancher will then work as a proxy and forward my requests to my respective Kubernetes clusters.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">{</span><span class="s2">&#34;kind&#34;</span>:<span class="s2">&#34;Event&#34;</span>,<span class="s2">&#34;authorization.k8s.io/decision&#34;</span>:<span class="s2">&#34;allow&#34;</span>,<span class="s2">&#34;authorization.k8s.io/reason&#34;</span>:<span class="s2">&#34;RBAC: allowed by ClusterRoleBinding \&#34;globaladmin-user-64t5q\&#34; of ClusterRole \&#34;cluster-admin\&#34; to User \&#34;user-64t5q\&#34;&#34;</span><span class="o">}}</span>
</span></span></code></pre></div><h2 id="installing-rancher-on-an-existing-kubernetes-cluster-using-helm">Installing Rancher on an existing Kubernetes Cluster using Helm</h2>
<p>Before I can start using Rancher I need to install it. Rancher can be deployed using Docker for poc/testing purposes and on (more or less any) Kubernetes platform for production use. <em>If one started out testing Rancher on Docker one can actually <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/other-installation-methods">migrate</a> from Docker to Kubernetes at a later stage also.</em> In this post I will deploy Rancher on Kubernetes. I have already deployed a Kubernetes cluster I intend to deploy Rancher on. The Kubernetes cluster that will be used is provisioned by vSphere with Tanzu, running in my vSphere cluster using the method I describe in this <a href="https://blog.andreasm.io/2024/02/04/argo-cd-vsphere-with-tanzu/">post</a>. vSphere with Tanzu is also its own Kubernetes management platform of course. I have deployed 3 control plane nodes and 3 worker nodes. All persistent storage will be handled by the the vSphere Cluster VSAN storage. Ingress will be taken care of by VMware Avi loadbalancer.</p>
<p>Here is my TKC cluster I will install rancher on:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="tkc-cluster-1"
      
        class="image_figure image_internal image_processed"
        width="513"
        height="233"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506080623908.png"
      
      
    />

    </picture>
</figure>
</p>
<p>The cluster is ready with all the necessary backend services like the Avi loadbalancer providing loadbalancer services and Ingress rules. The first thing I need is to add the Helm repo for Rancher.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># latest - recommended for testing the newest features</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">andreasm@linuxmgmt01:~$ helm repo add rancher-latest https://releases.rancher.com/server-charts/latest
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="s2">&#34;rancher-latest&#34;</span> has been added to your repositories
</span></span></code></pre></div><p>Create a namespace for Rancher:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">andreasm@linuxmgmt01:~$ kubectl create namespace cattle-system
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">namespace/cattle-system created
</span></span></code></pre></div><p>I will bring my own Certificate, so skipping Cert-Manager. This is my Rancher Helm value yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">  1</span><span class="cl"><span class="c"># Additional Trusted CAs.</span><span class="w">
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="w"></span><span class="c"># Enable this flag and add your CA certs as a secret named tls-ca-additional in the namespace.</span><span class="w">
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="w"></span><span class="c"># See README.md for details.</span><span class="w">
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="w"></span><span class="nt">additionalTrustedCAs</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="w"></span><span class="nt">antiAffinity</span><span class="p">:</span><span class="w"> </span><span class="l">preferred</span><span class="w">
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="w"></span><span class="nt">topologyKey</span><span class="p">:</span><span class="w"> </span><span class="l">kubernetes.io/hostname</span><span class="w">
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="w"></span><span class="c"># Audit Logs https://rancher.com/docs/rancher/v2.x/en/installation/api-auditing/</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="w"></span><span class="c"># The audit log is piped to the console of the rancher-audit-log container in the rancher pod.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="w"></span><span class="c"># https://rancher.com/docs/rancher/v2.x/en/installation/api-auditing/</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="w"></span><span class="c"># destination stream to sidecar container console or hostPath volume</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="w"></span><span class="c"># level: Verbosity of logs, 0 to 3. 0 is off 3 is a lot.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="w"></span><span class="nt">auditLog</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="w">  </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l">sidecar</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="w">  </span><span class="nt">hostPath</span><span class="p">:</span><span class="w"> </span><span class="l">/var/log/rancher/audit/</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="w">  </span><span class="nt">maxAge</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="w">  </span><span class="nt">maxBackup</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="w">  </span><span class="nt">maxSize</span><span class="p">:</span><span class="w"> </span><span class="m">100</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="w">  </span><span class="c"># Image for collecting rancher audit logs.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="w">  </span><span class="c"># Important: update pkg/image/export/resolve.go when this default image is changed, so that it&#39;s reflected accordingly in rancher-images.txt generated for air-gapped setups.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;rancher/mirrored-bci-micro&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="m">15.4.14.3</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="w">    </span><span class="c"># Override imagePullPolicy image</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 28</span><span class="cl"><span class="w">    </span><span class="c"># options: Always, Never, IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="w">    </span><span class="nt">pullPolicy</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;IfNotPresent&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="w"></span><span class="c"># As of Rancher v2.5.0 this flag is deprecated and must be set to &#39;true&#39; in order for Rancher to start</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="w"></span><span class="nt">addLocal</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="w"></span><span class="c"># Add debug flag to Rancher server</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="w"></span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="w"></span><span class="c"># When starting Rancher for the first time, bootstrap the admin as restricted-admin</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="w"></span><span class="nt">restrictedAdmin</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="w"></span><span class="c"># Extra environment variables passed to the rancher pods.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="w"></span><span class="c"># extraEnv:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="w"></span><span class="c"># - name: CATTLE_TLS_MIN_VERSION</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="w"></span><span class="c">#   value: &#34;1.0&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 44</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="w"></span><span class="c"># Fully qualified name to reach your Rancher server</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="w"></span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">rancher-01.my.domain.net</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 47</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="w"></span><span class="c">## Optional array of imagePullSecrets containing private registry credentials</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 49</span><span class="cl"><span class="w"></span><span class="c">## Ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="w"></span><span class="nt">imagePullSecrets</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 51</span><span class="cl"><span class="w"></span><span class="c"># - name: secretName</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="w"></span><span class="c">### ingress ###</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="w"></span><span class="c"># Readme for details and instruction on adding tls secrets.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="w"></span><span class="nt">ingress</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="w">  </span><span class="c"># If set to false, ingress will not be created</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="w">  </span><span class="c"># Defaults to true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="w">  </span><span class="c"># options: true, false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 60</span><span class="cl"><span class="w">  </span><span class="nt">includeDefaultExtraAnnotations</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="w">  </span><span class="nt">extraAnnotations</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;avi-lb&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="w">  </span><span class="c"># Certain ingress controllers will will require the pathType or path to be set to a different value.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="w">  </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l">ImplementationSpecific</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;/&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="w">  </span><span class="c"># backend port number</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 67</span><span class="cl"><span class="w">  </span><span class="nt">servicePort</span><span class="p">:</span><span class="w"> </span><span class="m">80</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="w">  </span><span class="c"># configurationSnippet - Add additional Nginx configuration. This example statically sets a header on the ingress.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="w">  </span><span class="c"># configurationSnippet: |</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 71</span><span class="cl"><span class="w">  </span><span class="c">#   more_set_input_headers &#34;X-Forwarded-Host: {{ .Values.hostname }}&#34;;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="w">  </span><span class="nt">tls</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="w">    </span><span class="c"># options: rancher, letsEncrypt, secret</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 75</span><span class="cl"><span class="w">    </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l">secret</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="w">    </span><span class="nt">secretName</span><span class="p">:</span><span class="w"> </span><span class="l">tls-rancher-ingress</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="w"></span><span class="c">### service ###</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="w"></span><span class="c"># Override to use NodePort or LoadBalancer service type - default is ClusterIP</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="w"></span><span class="nt">service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 82</span><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 83</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 84</span><span class="cl"><span class="w"></span><span class="c">### LetsEncrypt config ###</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="w"></span><span class="c"># ProTip: The production environment only allows you to register a name 5 times a week.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 86</span><span class="cl"><span class="w"></span><span class="c">#         Use staging until you have your config right.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="w"></span><span class="nt">letsEncrypt</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="w">  </span><span class="c"># email: none@example.com</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l">production</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="w">  </span><span class="nt">ingress</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="w">    </span><span class="c"># options: traefik, nginx</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="w">    </span><span class="nt">class</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="w"></span><span class="c"># If you are using certs signed by a private CA set to &#39;true&#39; and set the &#39;tls-ca&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 94</span><span class="cl"><span class="w"></span><span class="c"># in the &#39;rancher-system&#39; namespace. See the README.md for details</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="w"></span><span class="nt">privateCA</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="w"></span><span class="c"># http[s] proxy server passed into rancher server.</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="w"></span><span class="c"># proxy: http://&lt;username&gt;@&lt;password&gt;:&lt;url&gt;:&lt;port&gt;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">100</span><span class="cl"><span class="w"></span><span class="c"># comma separated list of domains or ip addresses that will not use the proxy</span><span class="w">
</span></span></span><span class="line"><span class="ln">101</span><span class="cl"><span class="w"></span><span class="nt">noProxy</span><span class="p">:</span><span class="w"> </span><span class="m">127.0.0.0</span><span class="l">/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,.svc,.cluster.local</span><span class="w">
</span></span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="w"></span><span class="c"># Override rancher image location for Air Gap installs</span><span class="w">
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="w"></span><span class="nt">rancherImage</span><span class="p">:</span><span class="w"> </span><span class="l">rancher/rancher</span><span class="w">
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="w"></span><span class="c"># rancher/rancher image tag. https://hub.docker.com/r/rancher/rancher/tags/</span><span class="w">
</span></span></span><span class="line"><span class="ln">106</span><span class="cl"><span class="w"></span><span class="c"># Defaults to .Chart.appVersion</span><span class="w">
</span></span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="w"></span><span class="c"># rancherImageTag: v2.0.7</span><span class="w">
</span></span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="w"></span><span class="c"># Override imagePullPolicy for rancher server images</span><span class="w">
</span></span></span><span class="line"><span class="ln">110</span><span class="cl"><span class="w"></span><span class="c"># options: Always, Never, IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="ln">111</span><span class="cl"><span class="w"></span><span class="c"># Defaults to IfNotPresent</span><span class="w">
</span></span></span><span class="line"><span class="ln">112</span><span class="cl"><span class="w"></span><span class="c"># rancherImagePullPolicy: &lt;pullPolicy&gt;</span><span class="w">
</span></span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">114</span><span class="cl"><span class="w"></span><span class="c"># Number of Rancher server replicas. Setting to negative number will dynamically between 0 and the abs(replicas) based on available nodes.</span><span class="w">
</span></span></span><span class="line"><span class="ln">115</span><span class="cl"><span class="w"></span><span class="c"># of available nodes in the cluster</span><span class="w">
</span></span></span><span class="line"><span class="ln">116</span><span class="cl"><span class="w"></span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="m">3</span><span class="w">
</span></span></span><span class="line"><span class="ln">117</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">118</span><span class="cl"><span class="w"></span><span class="c"># Set priorityClassName to avoid eviction</span><span class="w">
</span></span></span><span class="line"><span class="ln">119</span><span class="cl"><span class="w"></span><span class="nt">priorityClassName</span><span class="p">:</span><span class="w"> </span><span class="l">rancher-critical</span><span class="w">
</span></span></span><span class="line"><span class="ln">120</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="w"></span><span class="c"># Set pod resource requests/limits for Rancher.</span><span class="w">
</span></span></span><span class="line"><span class="ln">122</span><span class="cl"><span class="w"></span><span class="nt">resources</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">124</span><span class="cl"><span class="w"></span><span class="c">#</span><span class="w">
</span></span></span><span class="line"><span class="ln">125</span><span class="cl"><span class="w"></span><span class="c"># tls</span><span class="w">
</span></span></span><span class="line"><span class="ln">126</span><span class="cl"><span class="w"></span><span class="c">#   Where to offload the TLS/SSL encryption</span><span class="w">
</span></span></span><span class="line"><span class="ln">127</span><span class="cl"><span class="w"></span><span class="c"># - ingress (default)</span><span class="w">
</span></span></span><span class="line"><span class="ln">128</span><span class="cl"><span class="w"></span><span class="c"># - external</span><span class="w">
</span></span></span><span class="line"><span class="ln">129</span><span class="cl"><span class="w"></span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l">ingress</span><span class="w">
</span></span></span><span class="line"><span class="ln">130</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">131</span><span class="cl"><span class="w"></span><span class="nt">systemDefaultRegistry</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">132</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="w"></span><span class="c"># Set to use the packaged system charts</span><span class="w">
</span></span></span><span class="line"><span class="ln">134</span><span class="cl"><span class="w"></span><span class="nt">useBundledSystemChart</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="w"></span><span class="c"># Certmanager version compatibility</span><span class="w">
</span></span></span><span class="line"><span class="ln">137</span><span class="cl"><span class="w"></span><span class="nt">certmanager</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">138</span><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">139</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">140</span><span class="cl"><span class="w"></span><span class="c"># Rancher custom logos persistence</span><span class="w">
</span></span></span><span class="line"><span class="ln">141</span><span class="cl"><span class="w"></span><span class="nt">customLogos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">142</span><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">143</span><span class="cl"><span class="w">  </span><span class="nt">volumeSubpaths</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="w">    </span><span class="nt">emberUi</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;ember&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">145</span><span class="cl"><span class="w">    </span><span class="nt">vueUi</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;vue&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">146</span><span class="cl"><span class="w">  </span><span class="c">## Volume kind to use for persistence: persistentVolumeClaim, configMap</span><span class="w">
</span></span></span><span class="line"><span class="ln">147</span><span class="cl"><span class="w">  </span><span class="nt">volumeKind</span><span class="p">:</span><span class="w"> </span><span class="l">persistentVolumeClaim</span><span class="w">
</span></span></span><span class="line"><span class="ln">148</span><span class="cl"><span class="w">  </span><span class="c">## Use an existing volume. Custom logos should be copied to the volume by the user</span><span class="w">
</span></span></span><span class="line"><span class="ln">149</span><span class="cl"><span class="w">  </span><span class="c"># volumeName: custom-logos</span><span class="w">
</span></span></span><span class="line"><span class="ln">150</span><span class="cl"><span class="w">  </span><span class="c">## Just for volumeKind: persistentVolumeClaim</span><span class="w">
</span></span></span><span class="line"><span class="ln">151</span><span class="cl"><span class="w">  </span><span class="c">## To disables dynamic provisioning, set storageClass: &#34;&#34; or storageClass: &#34;-&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">152</span><span class="cl"><span class="w">  </span><span class="c"># storageClass: &#34;-&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">153</span><span class="cl"><span class="w">  </span><span class="nt">accessMode</span><span class="p">:</span><span class="w"> </span><span class="l">ReadWriteOnce</span><span class="w">
</span></span></span><span class="line"><span class="ln">154</span><span class="cl"><span class="w">  </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l">1Gi</span><span class="w">
</span></span></span><span class="line"><span class="ln">155</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">156</span><span class="cl"><span class="w"></span><span class="c"># Rancher post-delete hook</span><span class="w">
</span></span></span><span class="line"><span class="ln">157</span><span class="cl"><span class="w"></span><span class="nt">postDelete</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">158</span><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln">159</span><span class="cl"><span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">160</span><span class="cl"><span class="w">    </span><span class="nt">repository</span><span class="p">:</span><span class="w"> </span><span class="l">rancher/shell</span><span class="w">
</span></span></span><span class="line"><span class="ln">161</span><span class="cl"><span class="w">    </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l">v0.1.23</span><span class="w">
</span></span></span><span class="line"><span class="ln">162</span><span class="cl"><span class="w">  </span><span class="nt">namespaceList</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">163</span><span class="cl"><span class="w">    </span>- <span class="l">cattle-fleet-system</span><span class="w">
</span></span></span><span class="line"><span class="ln">164</span><span class="cl"><span class="w">    </span>- <span class="l">cattle-system</span><span class="w">
</span></span></span><span class="line"><span class="ln">165</span><span class="cl"><span class="w">    </span>- <span class="l">rancher-operator-system</span><span class="w">
</span></span></span><span class="line"><span class="ln">166</span><span class="cl"><span class="w">  </span><span class="c"># Number of seconds to wait for an app to be uninstalled</span><span class="w">
</span></span></span><span class="line"><span class="ln">167</span><span class="cl"><span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="ln">168</span><span class="cl"><span class="w">  </span><span class="c"># by default, the job will fail if it fail to uninstall any of the apps</span><span class="w">
</span></span></span><span class="line"><span class="ln">169</span><span class="cl"><span class="w">  </span><span class="nt">ignoreTimeoutError</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">170</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">171</span><span class="cl"><span class="w"></span><span class="c"># Set a bootstrap password. If leave empty, a random password will be generated.</span><span class="w">
</span></span></span><span class="line"><span class="ln">172</span><span class="cl"><span class="w"></span><span class="nt">bootstrapPassword</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;MyPassword&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">173</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">174</span><span class="cl"><span class="w"></span><span class="nt">livenessProbe</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">175</span><span class="cl"><span class="w">  </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="m">60</span><span class="w">
</span></span></span><span class="line"><span class="ln">176</span><span class="cl"><span class="w">  </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="ln">177</span><span class="cl"><span class="w"></span><span class="nt">readinessProbe</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">178</span><span class="cl"><span class="w">  </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="ln">179</span><span class="cl"><span class="w">  </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">30</span><span class="w">
</span></span></span><span class="line"><span class="ln">180</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">181</span><span class="cl"><span class="w"></span><span class="nt">global</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">182</span><span class="cl"><span class="w">  </span><span class="nt">cattle</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">183</span><span class="cl"><span class="w">    </span><span class="nt">psp</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">184</span><span class="cl"><span class="w">      </span><span class="c"># will default to true on 1.24 and below, and false for 1.25 and above</span><span class="w">
</span></span></span><span class="line"><span class="ln">185</span><span class="cl"><span class="w">      </span><span class="c"># can be changed manually to true or false to bypass version checks and force that option</span><span class="w">
</span></span></span><span class="line"><span class="ln">186</span><span class="cl"><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">187</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">188</span><span class="cl"><span class="w"></span><span class="c"># helm values to use when installing the rancher-webhook chart.</span><span class="w">
</span></span></span><span class="line"><span class="ln">189</span><span class="cl"><span class="w"></span><span class="c"># helm values set here will override all other global values used when installing the webhook such as priorityClassName and systemRegistry settings.</span><span class="w">
</span></span></span><span class="line"><span class="ln">190</span><span class="cl"><span class="w"></span><span class="nt">webhook</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">191</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">192</span><span class="cl"><span class="w"></span><span class="c"># helm values to use when installing the fleet chart.</span><span class="w">
</span></span></span><span class="line"><span class="ln">193</span><span class="cl"><span class="w"></span><span class="c"># helm values set here will override all other global values used when installing the fleet chart.</span><span class="w">
</span></span></span><span class="line"><span class="ln">194</span><span class="cl"><span class="w"></span><span class="nt">fleet</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;&#34;</span><span class="w">
</span></span></span></code></pre></div><p>I choose secret under TLS, so before I install Rancher I can create the secret with my own certificate.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">andreasm@linuxmgmt01:~$ k create secret -n cattle-system tls tls-rancher-ingress --cert<span class="o">=</span>tls.crt --key<span class="o">=</span>tls.key
</span></span><span class="line"><span class="ln">2</span><span class="cl">secret/tls-rancher-ingress created
</span></span></code></pre></div><p>Now I can deploy Rancher with my value.yaml above.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">helm install -n cattle-system rancher rancher-latest/rancher -f rancher.values.yaml
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAME: rancher
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">LAST DEPLOYED: Mon May  <span class="m">6</span> 08:24:36 <span class="m">2024</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">NAMESPACE: cattle-system
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">STATUS: deployed
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">REVISION: <span class="m">1</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">TEST SUITE: None
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">NOTES:
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">Rancher Server has been installed.
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">NOTE: Rancher may take several minutes to fully initialize. Please standby <span class="k">while</span> Certificates are being issued, Containers are started and the Ingress rule comes up.
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">Check out our docs at https://rancher.com/docs/
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">If you provided your own bootstrap password during installation, browse to https://rancher-01.my-domain.net to get started.
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">If this is the first <span class="nb">time</span> you installed Rancher, get started by running this <span class="nb">command</span> and clicking the URL it generates:
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="nb">echo</span> https://rancher-01.my-domain.net/dashboard/?setup<span class="o">=</span><span class="k">$(</span>kubectl get secret --namespace cattle-system bootstrap-secret -o go-template<span class="o">=</span><span class="s1">&#39;{{.data.bootstrapPassword|base64decode}}&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">To get just the bootstrap password on its own, run:
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template<span class="o">=</span><span class="s1">&#39;{{.data.bootstrapPassword|base64decode}}{{ &#34;\n&#34; }}&#39;</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="sb">```</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">Happy Containering!
</span></span></code></pre></div><p>Now its time to log into the the url mentioned above using the provided bootstrap password (if entered):</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="first-login"
      
        class="image_figure image_internal image_processed"
        width="2384"
        height="1576"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506113216096.png"
      
      
    />

    </picture>
</figure>
</p>
<p>By entering the bootstrap password above will log you in. If logging out, next time it will look like this:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="user-password"
      
        class="image_figure image_internal image_processed"
        width="2240"
        height="1362"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506113324912.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Before going to the next chapter, in my Kubernetes cluster now I will have some additional namespaces created, services and deployments. Below is some of them:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Namespaces</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAME                                     STATUS   AGE
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">cattle-fleet-clusters-system             Active   3h9m
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">cattle-fleet-local-system                Active   3h8m
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cattle-fleet-system                      Active   3h10m
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">cattle-global-data                       Active   3h10m
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">cattle-global-nt                         Active   3h10m
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">cattle-impersonation-system              Active   3h9m
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">cattle-provisioning-capi-system          Active   3h8m
</span></span><span class="line"><span class="ln">10</span><span class="cl">cattle-system                            Active   3h24m
</span></span><span class="line"><span class="ln">11</span><span class="cl">cluster-fleet-local-local-1a3d67d0a899   Active   3h8m
</span></span><span class="line"><span class="ln">12</span><span class="cl">fleet-default                            Active   3h10m
</span></span><span class="line"><span class="ln">13</span><span class="cl">fleet-local                              Active   3h10m
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="nb">local</span>                                    Active   3h10m
</span></span><span class="line"><span class="ln">15</span><span class="cl">p-4s8sk                                  Active   3h10m
</span></span><span class="line"><span class="ln">16</span><span class="cl">p-n8cmn                                  Active   3h10m
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="c1"># Deployments and services</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">NAME                                   READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="ln">19</span><span class="cl">pod/helm-operation-9bzv8               0/2     Completed   <span class="m">0</span>          3m22s
</span></span><span class="line"><span class="ln">20</span><span class="cl">pod/helm-operation-bvjrq               0/2     Completed   <span class="m">0</span>          8m10s
</span></span><span class="line"><span class="ln">21</span><span class="cl">pod/helm-operation-njvlg               0/2     Completed   <span class="m">0</span>          8m22s
</span></span><span class="line"><span class="ln">22</span><span class="cl">pod/rancher-5498b85476-bpfcn           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="ln">23</span><span class="cl">pod/rancher-5498b85476-j6ggn           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="ln">24</span><span class="cl">pod/rancher-5498b85476-xg247           1/1     Running     <span class="m">0</span>          9m25s
</span></span><span class="line"><span class="ln">25</span><span class="cl">pod/rancher-webhook-7d876fccc8-6m8tk   1/1     Running     <span class="m">0</span>          8m7s
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">NAME                      TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>          AGE
</span></span><span class="line"><span class="ln">28</span><span class="cl">service/rancher           ClusterIP   10.10.227.75   &lt;none&gt;        80/TCP,443/TCP   9m26s
</span></span><span class="line"><span class="ln">29</span><span class="cl">service/rancher-webhook   ClusterIP   10.10.81.6     &lt;none&gt;        443/TCP          8m8s
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">NAME                              READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class="line"><span class="ln">32</span><span class="cl">deployment.apps/rancher           3/3     <span class="m">3</span>            <span class="m">3</span>           9m27s
</span></span><span class="line"><span class="ln">33</span><span class="cl">deployment.apps/rancher-webhook   1/1     <span class="m">1</span>            <span class="m">1</span>           8m9s
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">NAME                                         DESIRED   CURRENT   READY   AGE
</span></span><span class="line"><span class="ln">36</span><span class="cl">replicaset.apps/rancher-5498b85476           <span class="m">3</span>         <span class="m">3</span>         <span class="m">3</span>       9m26s
</span></span><span class="line"><span class="ln">37</span><span class="cl">replicaset.apps/rancher-webhook-7d876fccc8   <span class="m">1</span>         <span class="m">1</span>         <span class="m">1</span>       8m8s
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">NAME      CLASS    HOSTS                        ADDRESS          PORTS     AGE
</span></span><span class="line"><span class="ln">40</span><span class="cl">rancher   avi-lb   rancher-01.my-domain.net   192.168.121.10   80, <span class="m">443</span>   9m47s
</span></span></code></pre></div><p>Rancher is ready to be used.</p>
<h2 id="create-and-manage-kubernetes-clusters">Create and manage Kubernetes clusters</h2>
<p>As soon as I have logged in the first thing I would like to do is to create a Kubernetes cluster. Rancher supports many methods of creating a Kubernetes cluster. Rancher can create clusters in a hosted Kubernetes provider such as Amazon EKS, Azure AKS, Google GKE and more. Rancher can create clusters and provision the nodes on Amazon EC2, Azure, DigitalOcean, Harvester, Linode, VMware vSphere and more. If you dont use any of them, it can create clusters on exisiting nodes like VMs deployed with a Linux (or even Windows..) OS waiting to be configured to do something (I will go through that later) or using <a href="https://elemental.docs.rancher.com/">Elemental</a> (more on that later also).</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create-clusters"
      
        class="image_figure image_internal image_processed"
        width="2481"
        height="912"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506215803466.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Under drivers, see the list of possible Cluster Drivers and Node Drivers:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-drivers"
      
        class="image_figure image_internal image_processed"
        width="1113"
        height="797"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220220902.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="node-drivers"
      
        class="image_figure image_internal image_processed"
        width="1545"
        height="1318"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220250915.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I happen to have vSphere as my virtualization platform which is natively supported by Rancher and will start by provisioning a Kubernetes cluster using the vSphere cloud. I also have another hypervisor platform running in my lab (Proxmox) which does not have a native driver for Rancher, instead I will make Rancher deploy Kubernetes on existing VM nodes. I will go through how I deploy Kubernetes clusters on vSphere and on Proxmox using the <em>Custom</em> &quot;cloud&quot; on existing nodes.</p>
<h3 id="rancher-kubernetes-distributions">Rancher Kubernetes distributions</h3>
<p>Rancher is fully capable of doing automated provisining of Kubernetes clusters, as I will go through in this post, as much as it can manage already exisiting Kubernetes clusters by importing them.</p>
<p>When Rancher is doing automated provisions of Kubernetes on supported clouds or onto existing nodes it uses its own Kubernetes distribution. In Rancher one can choose between three distributions called RKE, RKE2 and K3s. In this post I will only use RKE2 which stands for Rancher Kubernetes Engine. RKE2 is Rancher's <em>next-generation</em> Kubernetes distribution. I may touch upon the K3s distribution also, as this is very much focused on edge use cases due to its lightweight.</p>
<p>For more information on RKE2 head over <a href="https://docs.rke2.io/">here</a></p>
<p>For more information on K3s head over <a href="https://www.rancher.com/products/k3s">here</a></p>
<p>At the current time of writing this post I am using Rancher 2.8.3 and the latest RKE2/Kubernetes release is 1.28.8 which is not so far away from Kubernetes upstream which is currently at v1.30.</p>
<h2 id="create-rke2-clusters-using-vsphere">Create RKE2 clusters using vSphere</h2>
<p>Using vSphere as the &quot;cloud&quot; in Rancher do have some benefits. From the docs</p>
<p>For Rancher to spin up and create RKE2 clusters on vSphere I need to create a VM template using the OS of choice in my vSphere cluster. According to the official RKE2 <a href="https://docs.rke2.io/install/requirements#operating-systems">documentation</a> <em>RKE2 should work on any Linux distribution that uses systemd and iptables</em>. There is also a RKE2 Support Matrix for all OS versions that have been validated with RKE2 <a href="https://www.suse.com/suse-rke2/support-matrix/all-supported-versions/rke2-v1-28/">here</a> (linked to v1.28 as this post uses 1.28 but v1.29 is already out at the time of writing this post).</p>
<p>I went with Ubuntu 22.04 as my Linux distribution</p>
<p>There is a couple of ways Rancher can utilize vSphere to manage the template. Below is a screenshot of the possible options of the time of writing this post:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="deployment-methods"
      
        class="image_figure image_internal image_processed"
        width="978"
        height="174"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240508233641430.png"
      
      
    />

    </picture>
</figure>
</p>
<p>In this section I will go through the two methods <strong>Deploy from template: Content Library</strong> and <strong>deploy from template: Data Center</strong></p>
<h3 id="create-cloud-credentials">Create Cloud Credentials</h3>
<p>The first thing I will do before getting to the actual cluster creation is to create credentials for the user and connection information to my vCenter server. I will go to the Cluster Management and Cloud Credentials section in Rancher:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cloud-credentials"
      
        class="image_figure image_internal image_processed"
        width="322"
        height="334"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509001856987.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click create in the top right corner and select VMware vSphere:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vsphere"
      
        class="image_figure image_internal image_processed"
        width="2483"
        height="725"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002004160.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Fill in the relevant information about your vCenter server including the credentials with the right permissions (see permissions <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/launch-kubernetes-with-rancher/use-new-nodes-in-an-infra-provider/vsphere/create-credentials">here</a> using some very old screenshots from vCenter..):</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vcenter-info"
      
        class="image_figure image_internal image_processed"
        width="2552"
        height="444"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002145078.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="credentials-created"
      
        class="image_figure image_internal image_processed"
        width="2487"
        height="408"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002408912.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="rke2-clusters-using-vsphere-content-library-template">RKE2 clusters using vSphere Content Library template</h3>
<p>I decided to start with the method of deploying RKE2 clusters using the Content Library method as I found that one to be the easiest and fastest method (its just about uploading the image to the content library and thats it). The concept behind this is to create a Content Library in your vCenter hosting a Cloud Image template for the OS of choice. This should be as minimal as possible, with zero to none configs. All the needed configs are done by Rancher when adding the nodes to your cluster later.</p>
<p>As mentioned above, I went with Ubuntu Cloud image. Ubuntu Cloud images can be found <a href="https://cloud-images.ubuntu.com/">here</a>.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cloud-images"
      
        class="image_figure image_internal image_processed"
        width="2776"
        height="1976"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240508220123400.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I will go with this OVA image (22.04 LTS Jammy Jellyfish):</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="jammy-cloud-image-ova"
      
        class="image_figure image_internal image_processed"
        width="1916"
        height="74"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240508220225820.png"
      
      
    />

    </picture>
</figure>
</p>
<p>In my vCenter I create a Content Library:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="content-lib-create"
      
        class="image_figure image_internal image_processed"
        width="1177"
        height="934"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240508235953618.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Local content library:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="local-content"
      
        class="image_figure image_internal image_processed"
        width="861"
        height="724"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000026841.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Select my datastore to host the content:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="content-datastore"
      
        class="image_figure image_internal image_processed"
        width="857"
        height="713"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000126128.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Finish:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="content-library-created"
      
        class="image_figure image_internal image_processed"
        width="866"
        height="720"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000149484.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="content-library"
      
        class="image_figure image_internal image_processed"
        width="1440"
        height="60"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000233597.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I need to enter the content library by clicking on the name to add my desired Ubuntu Cloud Image version:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="import-items"
      
        class="image_figure image_internal image_processed"
        width="704"
        height="366"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000417561.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I will select Source File URL and paste the below URL:</p>
<p><a href="https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.ova">https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.ova</a></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="import"
      
        class="image_figure image_internal image_processed"
        width="868"
        height="540"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000545222.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click on Import and it will download the OVA from the URL</p>
<p>It may complain about SSL certificate being untruste.. Click Actions and Continue:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="continue"
      
        class="image_figure image_internal image_processed"
        width="857"
        height="526"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000656514.png"
      
      
    />

    </picture>
</figure>
</p>
<p>The template should be downloading now:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="downloading"
      
        class="image_figure image_internal image_processed"
        width="1808"
        height="1010"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509000742764.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Thats it from the vCenter side. The cloud image is ready as a template for Rancher to use. Now I will head over to Rancher and create my RKE2 cluster on vSphere based on this template.</p>
<p>I will go to Cluster Management using the top left menu or directy from the homepage clicking on manage</p>
<p>As I have done the preparations in vSphere I am now ready to create my RKE2 cluster on vSphere. Head to Clusters in the top left corner and click create in the top right corner then select VMware vSphere:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vSphere-cloud"
      
        class="image_figure image_internal image_processed"
        width="2555"
        height="951"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002529003.png"
      
      
    />

    </picture>
</figure>
</p>
<p>The cluster I want to create is one control-plane node and one worker node.</p>
<p>Give the cluster a name and description if you want. Then select the roles, at a minimum one have to deploy one node with all roles <em>etcd</em>, <em>Control Plane</em> and <em>Worker</em>. Give the pool a name, I will go with default values here. Machine count I will go with default 1 here also. I can scale it later 😄. Then make sure to select the correct datacenter in your vCenter, select the Resource Pool. If you have resource pools, if not just select the correct cluster (sfo-m01-cl01)/Resources which will be the cluster resource pool (root). Then select the correct Datastore. Then I will left the other fields default except the Creation method and Network. Under creation method I have selected <strong>Deploy from template: Content Library</strong> the correct Content Library and the <strong>jammy-server-cloudimg</strong> template I have uploaded/downloaded to the Content Library. Click Add Network and select the correct vCenter Network Portgroup you want the node to be placed in.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="node-pool1"
      
        class="image_figure image_internal image_processed"
        width="2474"
        height="1268"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509002845862.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Thats it for pool-1. I will scroll a bit down, click on the + sign and add a second pool for the nodes to have only the role worker.</p>
<p>I will repeat the steps above for pool-2. They will be identical except for the pool name and only role <strong>Worker</strong> selected.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="plus-to-add-pool"
      
        class="image_figure image_internal image_processed"
        width="296"
        height="261"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509003712557.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pool-2"
      
        class="image_figure image_internal image_processed"
        width="2480"
        height="1264"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509003856064.png"
      
      
    />

    </picture>
</figure>
</p>
<p>For the sake of keeping it simple, I will leave all the other fields default and just click create. I will now sit back and enjoy Rancher creating my RKE2 cluster on vSphere.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create"
      
        class="image_figure image_internal image_processed"
        width="2482"
        height="1323"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509004028543.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-creation-in-progress"
      
        class="image_figure image_internal image_processed"
        width="2237"
        height="478"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509004328959.png"
      
      
    />

    </picture>
</figure>
</p>
<p>In vCenter:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="content-library-being-used"
      
        class="image_figure image_internal image_processed"
        width="588"
        height="694"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509005651880.png"
      
      
    />

    </picture>
</figure>
</p>
<p>And cluster is ready:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ready"
      
        class="image_figure image_internal image_processed"
        width="2225"
        height="615"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509010740012.png"
      
      
    />

    </picture>
</figure>
</p>
<p>There was of course a bunch of option I elegantly skipped during the creation of this cluster. But the point, again, was to show how quickly and easily I could bring up a RKE2 cluster on vSphere. And so it was.</p>
<p><strong>Supplemental information</strong></p>
<p>To make further customization of the Ubuntu Cloud Image one can use the #cloud-config (<a href="https://cloud-init.io/">cloud-init</a>), and the vSphere vApp function.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cloud-config"
      
        class="image_figure image_internal image_processed"
        width="574"
        height="84"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011206653.png"
      
      
    />

    </picture>
</figure>
</p>
<p>vApp:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="image-20240509011229727"
      
        class="image_figure image_internal image_processed"
        width="483"
        height="200"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011229727.png"
      
      
    />

    </picture>
</figure>
</p>
<p>When it comes to the Ubuntu Cloud Image it does not contain any default username and password. So how can I access SSH on them? Well, from the Rancher UI one can access SSH directly or download the SSH keys. One can even copy paste into the SSH shell from there. SSH through the UI is very neat feature.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="node-operations"
      
        class="image_figure image_internal image_processed"
        width="2478"
        height="581"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011635979.png"
      
      
    />

    </picture>
</figure>
</p>
<p>SSH Shell:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ssh-shell"
      
        class="image_figure image_internal image_processed"
        width="2486"
        height="1171"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509011829741.png"
      
      
    />

    </picture>
</figure>
</p>
<p>For IP allocation I have configured DHCP in my NSX-T environment for the segment my RKE2 nodes will be placed in and all nodes will use dynamically allocated IP addresses in that subnet.</p>
<h3 id="rke2-clusters-using-vsphere-vm-template">RKE2 clusters using vSphere VM template</h3>
<p>The other method of preparing a template for Rancher to use is to install the Ubuntu Server as a regular VM. That involves doing the necessary configs, power it down and convert it to template. I thought this would mean a very minimal config to be done. But not quite.</p>
<p>My first attempt did not go so well. I installed Ubuntu, then powered it down and converted it to a template. Tried to create a RKE2 cluster with it from Rancher, it cloned the amount of control plane nodes and worker nodes I had defined, but there it stopped. So I figured I must have missed something along the way.</p>
<p>Then I found this post <a href="https://dev.to/balajivedagiri/provisioning-an-rke2-cluster-on-vsphere-13mh">here</a> which elegantly described the things I need in my template before &quot;handing&quot; it over to Rancher. So below is what I did in my Ubuntu Template by following the blog <a href="https://dev.to/balajivedagiri/provisioning-an-rke2-cluster-on-vsphere-13mh">post</a> above.</p>
<p>In short, this is what I did following the post above.</p>
<p>On my template:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">sudo apt-get install -y curl wget git net-tools unzip ca-certificates cloud-init cloud-guest-utils cloud-image-utils cloud-initramfs-growroot open-iscsi openssh-server open-vm-tools net-tools apparmor
</span></span></code></pre></div><p>and:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">sudo dpkg-reconfigure cloud-init
</span></span></code></pre></div><p>Deselected everything except &quot;NoCloud&quot;</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_processed"
        width="1094"
        height="821"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507105845272.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then I ran the script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="cp"></span><span class="c1"># Cleaning logs.</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/audit/audit.log <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  cat /dev/null &gt; /var/log/audit/audit.log
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/wtmp <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">  cat /dev/null &gt; /var/log/wtmp
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /var/log/lastlog <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">  cat /dev/null &gt; /var/log/lastlog
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"># Cleaning udev rules.</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="k">if</span> <span class="o">[</span> -f /etc/udev/rules.d/70-persistent-net.rules <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  rm /etc/udev/rules.d/70-persistent-net.rules
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># Cleaning the /tmp directories</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">rm -rf /tmp/*
</span></span><span class="line"><span class="ln">20</span><span class="cl">rm -rf /var/tmp/*
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="c1"># Cleaning the SSH host keys</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">rm -f /etc/ssh/ssh_host_*
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="c1"># Cleaning the machine-id</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">truncate -s <span class="m">0</span> /etc/machine-id
</span></span><span class="line"><span class="ln">27</span><span class="cl">rm /var/lib/dbus/machine-id
</span></span><span class="line"><span class="ln">28</span><span class="cl">ln -s /etc/machine-id /var/lib/dbus/machine-id
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="c1"># Cleaning the shell history</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="nb">unset</span> HISTFILE
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="nb">history</span> -cw
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="nb">echo</span> &gt; ~/.bash_history
</span></span><span class="line"><span class="ln">34</span><span class="cl">rm -fr /root/.bash_history
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="c1"># Truncating hostname, hosts, resolv.conf and setting hostname to localhost</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">truncate -s <span class="m">0</span> /etc/<span class="o">{</span>hostname,hosts,resolv.conf<span class="o">}</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">hostnamectl set-hostname localhost
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="c1"># Clean cloud-init</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">cloud-init clean -s -l
</span></span></code></pre></div><p>Powered off the VM, converted it to a template in vSphere.</p>

<div class="notices warning">
    <div class="label">Info</div>
    <p>Still after doing the steps described in the post linked to above my deployment failed. It turned out to be insufficient disk capacity. So I had to update my template in vSphere to use bigger disk. I was too conservative (or cheap) when I created it, I extended it to 60gb to be on the safe side. Could that have been a &quot;no-issue&quot; if I had read the official <a href="https://docs.rke2.io/install/requirements">documentation/requirements</a>, yes.</p>

  </div>

<p>I saw that when I connected to the control plane and checked the cattle-cluster-agent (it never started):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="l">andreasm@linuxmgmt01:~/$ k --kubeconfig test-cluster.yaml describe pod -n cattle-system cattle-cluster-agent-5cc77b7988-dwrtj</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">Name</span><span class="p">:</span><span class="w">             </span><span class="l">cattle-cluster-agent-5cc77b7988-dwrtj</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">Namespace</span><span class="p">:</span><span class="w">        </span><span class="l">cattle-system</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="nt">Events</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="l">Type     Reason                  Age                    From               Message</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">  </span>---- <span class="w">    </span>------ <span class="w">                 </span>---- <span class="w">                  </span>---- <span class="w">              </span>-------<span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span><span class="l">Warning  Failed                  6m24s                  kubelet            Failed to pull image &#34;rancher/rancher-agent:v2.8.3&#34;: failed to pull and unpack image &#34;docker.io/rancher/rancher-agent:v2.8.3&#34;: failed to extract layer sha256:3a9df665b61dd3e00c0753ca43ca9a0828cb5592ec051048b4bbc1a3f4488e05: write /var/lib/rancher/rke2/agent/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/108/fs/var/lib/rancher-data/local-catalogs/v2/rancher-partner-charts/8f17acdce9bffd6e05a58a3798840e408c4ea71783381ecd2e9af30baad65974/.git/objects/pack/pack-3b07a8b347f63714781c345b34c0793ec81f2b86.pack: no space left on device: unknown</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">  </span><span class="nt">Warning  Failed                  6m24s                  kubelet            Error</span><span class="p">:</span><span class="w"> </span><span class="l">ErrImagePull</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">  </span><span class="l">Warning  FailedMount             4m15s (x5 over 4m22s)  kubelet            MountVolume.SetUp failed for volume &#34;kube-api-access-cvwz2&#34; : failed to fetch token: Post &#34;https://127.0.0.1:6443/api/v1/namespaces/cattle-system/serviceaccounts/cattle/token&#34;: dial tcp 127.0.0.1:6443: connect: connection refused</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="l">Normal   Pulling                 4m7s                   kubelet            Pulling image &#34;rancher/rancher-agent:v2.8.3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">  </span><span class="nt">Warning  Evicted                 3m59s                  kubelet            The node was low on resource: ephemeral-storage. Threshold quantity: 574385774, available</span><span class="p">:</span><span class="w"> </span><span class="l">108048Ki.</span><span class="w">
</span></span></span></code></pre></div><p>After doing the additional changes in my template I gave the RKE2 cluster creation another attempt.</p>
<p>From the Cluster Management, click Create</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create"
      
        class="image_figure image_internal image_processed"
        width="2491"
        height="242"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220544660.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Select VMware vSphere:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vsphere"
      
        class="image_figure image_internal image_processed"
        width="1380"
        height="902"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506220614627.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I will start by defining &quot;pool-1&quot; as my 3 control plane nodes. Select vCenter Datacenter, Datastore and resource pool (if no resource pool is defined in vCenter, select just Resources which is &quot;root&quot;/cluster-level)</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pool-1"
      
        class="image_figure image_internal image_processed"
        width="3402"
        height="1588"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506221613295.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then define the &quot;pool-1&quot; instance options like cpu, memory, disk, network and the created vm template:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="instance-1"
      
        class="image_figure image_internal image_processed"
        width="3400"
        height="1472"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506231625901.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Add a second pool by clicking on the + sign here:</p>
<img src=images/image-20240506223316563.png style="width:500px" /> 
<p>Then confgure the amount of Machine count, roles (worker only) and vSphere placement as above (unless one have several clusters and want to distribute the workers.. That is another discussion).</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pool-2-2"
      
        class="image_figure image_internal image_processed"
        width="3438"
        height="1372"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506223445557.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Configure the pool-2 instance cpu, memory, network, vm template etc.. Here one can define the workers to be a bit more beefier (resource wise) than the control plane nodes.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pool-2-3"
      
        class="image_figure image_internal image_processed"
        width="3358"
        height="1590"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506231800970.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then it is the cluster config itself. There is a lot of details I will not cover now, will cover these a bit later. Now the sole purpose is to get a cluster up and running as easy and fast as possible. I will leave everything default, except pod CIDR and service CIDR. Will get into some more details later in the post.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-config-1"
      
        class="image_figure image_internal image_processed"
        width="3380"
        height="1656"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506223906595.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Pod CIDR and Service CIDR</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-config-2"
      
        class="image_figure image_internal image_processed"
        width="3388"
        height="1614"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506224042794.png"
      
      
    />

    </picture>
</figure>
</p>
<p>When done, click create bottom right corner.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="image-20240506224209849"
      
        class="image_figure image_internal image_processed"
        width="2912"
        height="224"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506224209849.png"
      
      
    />

    </picture>
</figure>
</p>
<p>From vCenter:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vms-reconfigured-powering-on"
      
        class="image_figure image_internal image_processed"
        width="542"
        height="278"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506232010931.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Here is my cluster starting to be built.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="vms-powered-on"
      
        class="image_figure image_internal image_processed"
        width="344"
        height="157"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240506232040851.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Rancher cluster creation status</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="status-1"
      
        class="image_figure image_internal image_processed"
        width="2213"
        height="88"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507134729148.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="status-2"
      
        class="image_figure image_internal image_processed"
        width="2230"
        height="870"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507134755776.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ready"
      
        class="image_figure image_internal image_processed"
        width="2207"
        height="812"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507140438861.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="status-complete"
      
        class="image_figure image_internal image_processed"
        width="2221"
        height="51"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507140941899.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Thats it. Cluster is up and running. There was a couple of additional tasks that needed to be done, but it worked. If one does not have the option to use a Cloud Image, then this will also work. The experience using a Cloud Image was by far the easiest and most flexible approach.</p>
<h2 id="creating-a-rke2-cluster-on-existing-nodes---non-native-cloud-provider">Creating a RKE2 cluster on existing nodes - non native cloud provider</h2>
<p>If I dont have a vSphere environment or other supported Cloud provider, but another platform for my virtalization needs, one alternative is then to prepare some VMs with my preferred operating system I can tell Rancher to deploy RKE2 on. The provisioning and managing of these VMs will be handled by OpenTofu. Lets see how that works.</p>
<p>I have already a <a href="https://blog.andreasm.io/2024/01/15/proxmox-with-opentofu-kubespray-and-kubernetes/">post</a> covering how I am deploying VMs and Kubernetes using OpenTofu and Kubespray on my Proxmox cluster. For this section I will use the OpenTofu part just to quickly deploy the VMs on Proxmox I need to build or bring up my Kubernetes (RKE2) cluster.</p>
<p>My OpenTofu project is already configured, it should deploy 6 VMs, 3 control plane nodes and 3 workers. I will kick that task off like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~/terraform/proxmox/rancher-cluster-1$ tofu apply plan
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">proxmox_virtual_environment_file.ubuntu_cloud_init: Creating...
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">proxmox_virtual_environment_file.ubuntu_cloud_init: Creation <span class="nb">complete</span> after 1s <span class="o">[</span><span class="nv">id</span><span class="o">=</span>local:snippets/ubuntu.cloud-config.yaml<span class="o">]</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>0<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>1<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">proxmox_virtual_environment_vm.rke2-worker-vms-cl01<span class="o">[</span>1<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>0<span class="o">]</span>: Creating...
</span></span><span class="line"><span class="ln">10</span><span class="cl">...
</span></span><span class="line"><span class="ln">11</span><span class="cl">proxmox_virtual_environment_vm.rke2-cp-vms-cl01<span class="o">[</span>2<span class="o">]</span>: Creation <span class="nb">complete</span> after 1m37s <span class="o">[</span><span class="nv">id</span><span class="o">=</span>1023<span class="o">]</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">Apply complete! Resources: <span class="m">7</span> added, <span class="m">0</span> changed, <span class="m">0</span> destroyed.
</span></span></code></pre></div><p>And my vms should start popping up in my Proxmox ui:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="soon-to-be-rke-nodes-proxmox"
      
        class="image_figure image_internal image_processed"
        width="612"
        height="256"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507161104692.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I have some freshly installed VMs running, it is time to hand them over to Rancher to do some magic on them. Lets head over to Rancher and create a Custom cluster.</p>
<h3 id="creating-rke2-cluster-on-existing-nodes---custom-cloud">Creating RKE2 cluster on existing nodes - &quot;custom cloud&quot;</h3>
<p>In Rancher, go to Cluster Management or from the homepage, <strong>create</strong> and select <strong>Custom</strong></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="custom-cluster"
      
        class="image_figure image_internal image_processed"
        width="809"
        height="906"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507161939708.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Give the cluster a name, and change what you want according to your needs. I will only change the Container Network and the pod/services CIDR.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="rke2-cluster-proxmox"
      
        class="image_figure image_internal image_processed"
        width="2480"
        height="958"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507184317985.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="rke2-cluster-proxmox-2"
      
        class="image_figure image_internal image_processed"
        width="2103"
        height="803"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162547885.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click create:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create"
      
        class="image_figure image_internal image_processed"
        width="432"
        height="212"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162615075.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now it will tell you to paste a registration command on the node you want to be the controlplane, etc and worker node.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="registration-command"
      
        class="image_figure image_internal image_processed"
        width="2226"
        height="766"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507162749161.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click on the cli command to get it into the clipboard. I will start by preparing the first node with all three roles <em>control-plane</em>, <em>etcd</em> and <em>worker</em>. Then I will continue with the next two. After my controlplane is ready and consist of three nodes I will change the parameter to only include worker node and do the last three nodes.</p>
<p>Then go ahead and ssh into my intented control plane node and paste the command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">ubuntu@ubuntu:~$ curl -fL https://rancher-dev.my-domain.net/system-agent-install.sh <span class="p">|</span> sudo  sh -s - --server https://rancher-dev.my-domain.net --label <span class="s1">&#39;cattle.io/os=linux&#39;</span> --token p5fp6sv4qbskmhl7mmpksbxcgs9gk9dtsqkqg9q8q8ln5f56l5jlpb --etcd --controlplane --worker
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="m">100</span> <span class="m">32228</span>    <span class="m">0</span> <span class="m">32228</span>    <span class="m">0</span>     <span class="m">0</span>   368k      <span class="m">0</span> --:--:-- --:--:-- --:--:--  370k
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Label: cattle.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: etcd
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: controlplane
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: worker
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent configuration directory /etc/rancher/agent
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent var directory /var/lib/rancher/agent
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully tested Rancher connection
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent binary from https://rancher-dev.my-domain.net/assets/rancher-system-agent-amd64
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent binary.
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent-uninstall.sh script from https://rancher-dev.my-doamin.net/assets/system-agent-uninstall.sh
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent-uninstall.sh script.
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Generating Cattle ID
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded Rancher connection information
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  systemd: Creating service file
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Creating environment file /etc/systemd/system/rancher-system-agent.env
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Enabling rancher-system-agent.service
</span></span><span class="line"><span class="ln">21</span><span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/rancher-system-agent.service → /etc/systemd/system/rancher-system-agent.service.
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Starting/restarting rancher-system-agent.service
</span></span><span class="line"><span class="ln">23</span><span class="cl">ubuntu@ubuntu:~$
</span></span></code></pre></div><p>Now, lets just wait in the Rancher UI and monitor the progress.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="status-opentofu-cluster"
      
        class="image_figure image_internal image_processed"
        width="2478"
        height="500"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507175908266.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="done"
      
        class="image_figure image_internal image_processed"
        width="1427"
        height="392"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180132180.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="green"
      
        class="image_figure image_internal image_processed"
        width="2221"
        height="394"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180155419.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Repeat same operation for the two last control plane nodes.</p>
<p>For the worker nodes I will adjust the command to only deploy worker node role:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="worker-node"
      
        class="image_figure image_internal image_processed"
        width="2223"
        height="819"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507180445251.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">ubuntu@ubuntu:~$ curl -fL https://rancher-dev.my-domain.net/system-agent-install.sh <span class="p">|</span> sudo  sh -s - --server https://rancher-dev.my-domain.net --label <span class="s1">&#39;cattle.io/os=linux&#39;</span> --token jfjd5vwfdqxkszgg25m6w49hhm4l99kjk2xhrm2hp75dvwhrjnrt2d --worker
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="m">100</span> <span class="m">32228</span>    <span class="m">0</span> <span class="m">32228</span>    <span class="m">0</span>     <span class="m">0</span>   370k      <span class="m">0</span> --:--:-- --:--:-- --:--:--  374k
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Label: cattle.io/os<span class="o">=</span>linux
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Role requested: worker
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent configuration directory /etc/rancher/agent
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Using default agent var directory /var/lib/rancher/agent
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully tested Rancher connection
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent binary from https://rancher-dev.my-domain.net/assets/rancher-system-agent-amd64
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent binary.
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Downloading rancher-system-agent-uninstall.sh script from https://rancher-dev.my-doamin.net/assets/system-agent-uninstall.sh
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded the rancher-system-agent-uninstall.sh script.
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Generating Cattle ID
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Successfully downloaded Rancher connection information
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  systemd: Creating service file
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Creating environment file /etc/systemd/system/rancher-system-agent.env
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Enabling rancher-system-agent.service
</span></span><span class="line"><span class="ln">19</span><span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/rancher-system-agent.service → /etc/systemd/system/rancher-system-agent.service.
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="o">[</span>INFO<span class="o">]</span>  Starting/restarting rancher-system-agent.service
</span></span></code></pre></div><p>Repeat for all the worker nodes needed.</p>
<p>After some minutes, the cluster should be complete with all control plane nodes and worker nodes:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-ready"
      
        class="image_figure image_internal image_processed"
        width="2228"
        height="692"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240508164728679.png"
      
      
    />

    </picture>
</figure>
</p>
<p>The whole process, two tasks really, from deploying my six VMs to a fully working Kubernetes cluster running was just shy of 10 minutes. All I had to do was to provison the VMs, go into Rancher create a RKE2 cluster, execute the registration command on each node.</p>
<p>Deploying Kubernetes clusters couldn't be more fun actually.</p>
<h2 id="import-existing-kubernetes-clusters">Import existing Kubernetes Clusters</h2>
<p>As mentioned earlier, Rancher can also import existing Kubernetes clusters for central management. If one happen to have a bunch of Kubernetes clusters deployed, no central management of them, add them to Rancher.</p>
<p>Here is how to import existing Kubernetes clusters.</p>
<p>Head over to Cluster Management in the Rancher UI, go to Clusters and find the <em>Import Existing</em> button:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="import-existing"
      
        class="image_figure image_internal image_processed"
        width="2557"
        height="197"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101644242.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="Generic"
      
        class="image_figure image_internal image_processed"
        width="2031"
        height="537"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101716841.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I will select Generic as I dont have any clusters running in Amazon, Azure nor Google.</p>
<p>Give the cluster a name (name as it will show in Rancher <em>and ignore my typo tanzuz</em>) and description. I am using the default admin account in Rancher.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="name-cluster"
      
        class="image_figure image_internal image_processed"
        width="2019"
        height="534"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509101919752.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click create in the bottom right corner.</p>
<p>It will now show me how I can register my already existing cluster into Rancher:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="import-kubectl"
      
        class="image_figure image_internal image_processed"
        width="2486"
        height="761"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102041261.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I need to get into the context of the Kubernetes cluster I want to import and execute the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">kubectl apply -f https://rancher-dev.my-domain.net/v3/import/knkh9n4rvhgpkxxxk7c4rhblhkqxfjxcq82nm7zcgfdcgqsl7bqdg5_c-m-qxpbc6tp.yaml
</span></span></code></pre></div><p>In the correct context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~$ kubectl apply -f https://rancher-dev.my-domain.net/v3/import/knkh9n4rvhgpkxxxk7c4rhblhkqxfjxcq82nm7zcgfdcgqsl7bqdg5_c-m-qxpbc6tp.yaml
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">clusterrole.rbac.authorization.k8s.io/proxy-clusterrole-kubeapiserver created
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">clusterrolebinding.rbac.authorization.k8s.io/proxy-role-binding-kubernetes-master created
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Warning: resource namespaces/cattle-system is missing the kubectl.kubernetes.io/last-applied-configuration annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation will be patched automatically.
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">namespace/cattle-system configured
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">serviceaccount/cattle created
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">clusterrolebinding.rbac.authorization.k8s.io/cattle-admin-binding created
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">secret/cattle-credentials-603e85e created
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">clusterrole.rbac.authorization.k8s.io/cattle-admin created
</span></span><span class="line"><span class="ln">10</span><span class="cl">Warning: spec.template.spec.affinity.nodeAffinity.requiredDuringSchedulingIgnoredDuringExecution.nodeSelectorTerms<span class="o">[</span>0<span class="o">]</span>.matchExpressions<span class="o">[</span>0<span class="o">]</span>.key: beta.kubernetes.io/os is deprecated since v1.14<span class="p">;</span> use <span class="s2">&#34;kubernetes.io/os&#34;</span> instead
</span></span><span class="line"><span class="ln">11</span><span class="cl">deployment.apps/cattle-cluster-agent created
</span></span><span class="line"><span class="ln">12</span><span class="cl">service/cattle-cluster-agent created
</span></span></code></pre></div><p>In the Rancher UI:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-imported"
      
        class="image_figure image_internal image_processed"
        width="2210"
        height="761"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102515887.png"
      
      
    />

    </picture>
</figure>
</p>
<p>It took a couple of seconds, and the cluster was imported.</p>
<p>Now just having a look around.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="first-glance"
      
        class="image_figure image_internal image_processed"
        width="2485"
        height="626"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102738378.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Nodes:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="nodes"
      
        class="image_figure image_internal image_processed"
        width="2482"
        height="844"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103535894.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Doing kubectl from the UI:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="kubectl-from-ui"
      
        class="image_figure image_internal image_processed"
        width="1090"
        height="1330"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509102842910.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="storage-classes"
      
        class="image_figure image_internal image_processed"
        width="2482"
        height="658"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103027863.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="navigating-the-rancher-ui">Navigating the Rancher UI</h2>
<p>So far I have only created and imported clusters into Rancher. The current inventory in Rancher is a couple of clusters both imported and created by Rancher:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="Clusters"
      
        class="image_figure image_internal image_processed"
        width="1801"
        height="835"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509103337593.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Its time to explore Rancher.</p>
<p>What is the information Rancher can give me on my new RKE2 cluster. Lets click around.</p>
<p>Click on <em>Explore</em></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="explore"
      
        class="image_figure image_internal image_processed"
        width="345"
        height="54"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507141639433.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="rancher-cluster-dashboard">Rancher Cluster Dashboard</h3>
<p>The first thing I get to when clicking on <em>Explore</em> is the Cluster Dashboard. It contains a brief status of the cluster like CPU and Memory usage, total resources, pods running (55 of 660?) and latest events. Very nice set of information.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-dashboard"
      
        class="image_figure image_internal image_processed"
        width="2230"
        height="1217"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142216636.png"
      
      
    />

    </picture>
</figure>
</p>
<p>But in the top right corner, what have we there? Install Monitoring and Add Cluster Badge. Lets try the Cluster Badge</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-badge"
      
        class="image_figure image_internal image_processed"
        width="598"
        height="470"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142721055.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I can customize the cluster badge.. Lets see how this looks like</p>
<p>It adds a color and initials on the cluster list on the left side menu, making it easy to distinguish and sort the different Kubernetes clusters.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="with-badge"
      
        class="image_figure image_internal image_processed"
        width="533"
        height="417"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507142908603.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now, what about the Install Monitoring.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="candy"
      
        class="image_figure image_internal image_processed"
        width="2327"
        height="824"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507143047488.png"
      
      
    />

    </picture>
</figure>
</p>
<p>A set of available monitoring tools, ready to be installed. This is really great, and qualifies for dedicated sections later in this post.</p>
<p>On left side menu, there is additional information:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="left-side-menu"
      
        class="image_figure image_internal image_processed"
        width="638"
        height="418"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507150707248.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Pods:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pods"
      
        class="image_figure image_internal image_processed"
        width="2472"
        height="746"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507150901820.png"
      
      
    />

    </picture>
</figure>
</p>
<p>What about executing directly into shell of a pod?</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pod-exec"
      
        class="image_figure image_internal image_processed"
        width="922"
        height="613"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507153519566.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Nodes:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="nodes"
      
        class="image_figure image_internal image_processed"
        width="2486"
        height="687"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507151005533.png"
      
      
    />

    </picture>
</figure>
</p>
<p>ConfigMaps:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="configmaps"
      
        class="image_figure image_internal image_processed"
        width="2481"
        height="757"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507151128892.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I have an action menu on every object available in the left side menus, I can edit configMaps, secrets, drain node etc right there from the Rancher UI.</p>
<p>If I know the object name, I can just search for it also:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="search"
      
        class="image_figure image_internal image_processed"
        width="2380"
        height="1208"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507153838802.png"
      
      
    />

    </picture>
</figure>
</p>
<p>So much information readily available directly after deploying the cluster. This was just a quick overview, there are several more fields to explore.</p>
<h3 id="accessing-my-new-rke2-cluster-deployed-on-vsphere">Accessing my new RKE2 cluster deployed on vSphere</h3>
<p>Now that my clusters is up and running, how can I access it? SSH into one of the control plane nodes and grab the kubeconfig? Well that is possible, but is it a better way?</p>
<p>Yes it is...</p>
<p>Click on the three dots at the end of the cluster:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="three-dots"
      
        class="image_figure image_internal image_processed"
        width="2227"
        height="745"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507141220328.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Lets try the <strong>Kubectl Shell</strong></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="kubectl-shell"
      
        class="image_figure image_internal image_processed"
        width="2501"
        height="681"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240507154958703.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Or just copy the KubeConfig to Clipboard, paste it in a file on your workstation and access your cluster like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~/$ k get nodes -owide
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAME                                  STATUS   ROLES                              AGE    VERSION          INTERNAL-IP       EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION       CONTAINER-RUNTIME
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">rke2-cluster-1-pool1-47454a8f-6npvs   Ready    control-plane,etcd,master,worker   127m   v1.28.8+rke2r1   192.168.150.98    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">rke2-cluster-1-pool1-47454a8f-9tv65   Ready    control-plane,etcd,master,worker   123m   v1.28.8+rke2r1   192.168.150.54    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">rke2-cluster-1-pool1-47454a8f-xpjqf   Ready    control-plane,etcd,master,worker   121m   v1.28.8+rke2r1   192.168.150.32    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">rke2-cluster-1-pool2-b5e2f49f-2mr5r   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.97    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">rke2-cluster-1-pool2-b5e2f49f-9qnl2   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.99    &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">rke2-cluster-1-pool2-b5e2f49f-tfw2x   Ready    worker                             119m   v1.28.8+rke2r1   192.168.150.100   &lt;none&gt;        Ubuntu 22.04.4 LTS   5.15.0-105-generic   containerd://1.7.11-k3s2
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">andreasm@linuxmgmt01:~/$ k get pods -A
</span></span><span class="line"><span class="ln">11</span><span class="cl">NAMESPACE             NAME                                                           READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="ln">12</span><span class="cl">cattle-fleet-system   fleet-agent-595ff97fd6-vl9t4                                   1/1     Running     <span class="m">0</span>          124m
</span></span><span class="line"><span class="ln">13</span><span class="cl">cattle-system         cattle-cluster-agent-6bb5b4f9c6-br6lk                          1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">14</span><span class="cl">cattle-system         cattle-cluster-agent-6bb5b4f9c6-t5822                          1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">15</span><span class="cl">cattle-system         rancher-webhook-bcc8984b6-9ztqj                                1/1     Running     <span class="m">0</span>          122m
</span></span><span class="line"><span class="ln">16</span><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-6npvs   1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">17</span><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-9tv65   1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">18</span><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-1-pool1-47454a8f-xpjqf   1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">19</span><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-6npvs                       1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">20</span><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-9tv65                       1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">21</span><span class="cl">kube-system           etcd-rke2-cluster-1-pool1-47454a8f-xpjqf                       1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">22</span><span class="cl">kube-system           helm-install-rke2-canal-4cxc6                                  0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">23</span><span class="cl">kube-system           helm-install-rke2-coredns-vxvpj                                0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">24</span><span class="cl">kube-system           helm-install-rke2-ingress-nginx-f5g88                          0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">25</span><span class="cl">kube-system           helm-install-rke2-metrics-server-66rff                         0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">26</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-9ncn6                0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">27</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-rrhbw                    0/1     Completed   <span class="m">1</span>          127m
</span></span><span class="line"><span class="ln">28</span><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-jxgr5            0/1     Completed   <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">29</span><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-6npvs             1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">30</span><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-9tv65             1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">31</span><span class="cl">kube-system           kube-apiserver-rke2-cluster-1-pool1-47454a8f-xpjqf             1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">32</span><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-6npvs    1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">33</span><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-9tv65    1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">34</span><span class="cl">kube-system           kube-controller-manager-rke2-cluster-1-pool1-47454a8f-xpjqf    1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">35</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-6npvs                 1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">36</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-9tv65                 1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">37</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool1-47454a8f-xpjqf                 1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">38</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-2mr5r                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">39</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-9qnl2                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">40</span><span class="cl">kube-system           kube-proxy-rke2-cluster-1-pool2-b5e2f49f-tfw2x                 1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">41</span><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-6npvs             1/1     Running     <span class="m">0</span>          127m
</span></span><span class="line"><span class="ln">42</span><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-9tv65             1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">43</span><span class="cl">kube-system           kube-scheduler-rke2-cluster-1-pool1-47454a8f-xpjqf             1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">44</span><span class="cl">kube-system           rke2-canal-7lmxr                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">45</span><span class="cl">kube-system           rke2-canal-cmrm2                                               2/2     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">46</span><span class="cl">kube-system           rke2-canal-f9ztm                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">47</span><span class="cl">kube-system           rke2-canal-gptjt                                               2/2     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">48</span><span class="cl">kube-system           rke2-canal-p9dj4                                               2/2     Running     <span class="m">0</span>          121m
</span></span><span class="line"><span class="ln">49</span><span class="cl">kube-system           rke2-canal-qn998                                               2/2     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="ln">50</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-q7cjn                     1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">51</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-v2lq7                     1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="ln">52</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-lj6mp           1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="ln">53</span><span class="cl">kube-system           rke2-ingress-nginx-controller-24g4k                            1/1     Running     <span class="m">0</span>          113m
</span></span><span class="line"><span class="ln">54</span><span class="cl">kube-system           rke2-ingress-nginx-controller-9gncw                            1/1     Running     <span class="m">0</span>          123m
</span></span><span class="line"><span class="ln">55</span><span class="cl">kube-system           rke2-ingress-nginx-controller-h9slv                            1/1     Running     <span class="m">0</span>          119m
</span></span><span class="line"><span class="ln">56</span><span class="cl">kube-system           rke2-ingress-nginx-controller-p98mx                            1/1     Running     <span class="m">0</span>          120m
</span></span><span class="line"><span class="ln">57</span><span class="cl">kube-system           rke2-ingress-nginx-controller-rfvnm                            1/1     Running     <span class="m">0</span>          125m
</span></span><span class="line"><span class="ln">58</span><span class="cl">kube-system           rke2-ingress-nginx-controller-xlhd8                            1/1     Running     <span class="m">0</span>          113m
</span></span><span class="line"><span class="ln">59</span><span class="cl">kube-system           rke2-metrics-server-544c8c66fc-n8r9b                           1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="ln">60</span><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-5twmc                      1/1     Running     <span class="m">0</span>          126m
</span></span><span class="line"><span class="ln">61</span><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-8fzx7              1/1     Running     <span class="m">0</span>          126m
</span></span></code></pre></div><p>This goes for both Rancher automated deployed Kubernetes clusters and imported clusters. Same API endpoint to access them all.</p>
<p>If I would access my Tanzu Kubernetes clusters I would have to use the <em>kubectl vsphere login</em> command and from there enter the correnct vSphere Namespace context to get to my TKC cluster. By just adding the Tanzu cluster to Rancher I can use the same endpoint to access this cluster two. Have a quick look at how the kubectl config:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Config</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">clusters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">cluster</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://rancher-dev.my-domain.net/k8s/clusters/c-m-qxpbc6tp&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="nt">users</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kubeconfig-user-64t5qq4d67:l8mdcs55ggf8kz4zlrcpth8tk48j85kp9qjslk5zrcmjczw6nqr7fw&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w"></span><span class="nt">contexts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">    </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w"></span><span class="nt">current-context</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;tanzuz-cluster-1&#34;</span><span class="w">
</span></span></span></code></pre></div><p>I accessing my TKC cluster through Rancher API endpoint.</p>
<h2 id="managing-kubernetes-clusters-from-rancher">Managing Kubernetes clusters from Rancher</h2>
<p>Though making Kubernetes cluster deployments an easy task is important, handling day two operations is even more important. Let's explore some typical administrative tasks that needs to be done on a Kubernetes cluster during its lifetime using Rancher.</p>
<h3 id="scaling-nodes-horizontally---up-and-down">Scaling nodes horizontally - up and down</h3>
<p>There will come a time when there is a need to scale the amount of worker nodes in a cluster. Lets see how we can do that in Rancher.</p>
<p>If I manually want to scale the amount of worker nodes up, I will go to Cluster Management and Clusters, then click on the name of my cluster to be scaled:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="cluster-management"
      
        class="image_figure image_internal image_processed"
        width="3430"
        height="1132"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234028538.png"
      
      
    />

    </picture>
</figure>
</p>
<p>By clicking on the cluster name it will take me directly to the Machine pools, on the right there is some obvious -/+ buttons. By clicking on the + sign once it will scale with 1 additional worker node in that pool. Lets test</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="scale-up"
      
        class="image_figure image_internal image_processed"
        width="2926"
        height="1264"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234146135.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I will now scale my <em>rke2-cluster-2-vsphere</em> with from one worker node to two worker nodes.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="scaling"
      
        class="image_figure image_internal image_processed"
        width="2862"
        height="1412"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234351880.png"
      
      
    />

    </picture>
</figure>
</p>
<p>In my vCenter:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="deploying_new_vm"
      
        class="image_figure image_internal image_processed"
        width="1406"
        height="206"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509234451691.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Cluster is now scaled with one additional worker node:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="scaled"
      
        class="image_figure image_internal image_processed"
        width="2916"
        height="1350"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509235322632.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Manual autoscaling is not always sufficient as the cluster is too dynamic so Rancher does have support Node Autoscaling</p>
<p>Autoscaling:
<a href="https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/rancher/README.md">https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/rancher/README.md</a></p>
<h3 id="scaling-nodes-vertically---add-cpu-ram-and-disk">Scaling nodes vertically - add cpu, ram and disk</h3>
<p>What if I need to change the cpu, memory and disk resources on the nodes? An unexpected change in the workload dictates the nodes to be handle to change that and scaling horizontally does not solve it. Then I need an easy way to change the current nodes resource.</p>
<p>From the Cluster Manager and Clusters view, click on the name of the cluster that needs to have its nodes resources changed, and from there click <em>Config</em>:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="config"
      
        class="image_figure image_internal image_processed"
        width="2916"
        height="440"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240509235837729.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Select the pool you want to change the resources on, I will select pool2 as thats where my worker nodes are residing.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="pool2"
      
        class="image_figure image_internal image_processed"
        width="2934"
        height="896"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000010471.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then in the top right corner click on the three dots and select edit config to allow for the required fields to be edited.</p>
<p>From there I will adjust the memory and cpu on the pool2 from 2 cpus to 4 and from 4096mb memory to 6144mb memory. Then click save.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="adjust-cpu-ram"
      
        class="image_figure image_internal image_processed"
        width="2932"
        height="1918"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000238032.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="status"
      
        class="image_figure image_internal image_processed"
        width="2890"
        height="166"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000322240.png"
      
      
    />

    </picture>
</figure>
</p>
<p>This triggers a rollout of a new worker nodes until all nodes have been replace with new nodes using the new cpu and memory config:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="rollout"
      
        class="image_figure image_internal image_processed"
        width="1538"
        height="484"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000357561.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="new-cpu-memory-alloc"
      
        class="image_figure image_internal image_processed"
        width="1708"
        height="824"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510000435285.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Thats it</p>
<h3 id="upgrading-kubernetes-clusters">Upgrading Kubernetes clusters</h3>
<p>This is probably one of the most important task maintaining a Kubernetes cluster, keeping pace with Kubernetes updates and performing Kubernetes upgrades. New Kubernetes release is coming approximately every 3 months.</p>
<p>So how can I upgrade my Kubernetes cluster using Rancher?</p>
<p>Almost same approach as above, but instead of changing any of the CPU and Memory resources I will scroll down and select the new Kubernetes version I want to upgrade to:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="upgrade-k8s-version"
      
        class="image_figure image_internal image_processed"
        width="1934"
        height="1096"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001659760.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I have a cluster currently running version 1.27.12 and want to upgrade to 1.28.8.
I will now select the latest version available and then save:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="1.28.8-upgrade"
      
        class="image_figure image_internal image_processed"
        width="2912"
        height="1876"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001754393.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="notification"
      
        class="image_figure image_internal image_processed"
        width="1668"
        height="582"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510001818305.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Continue.</p>
<p>This will not trigger a rolling upgrade, instead it will do a in-line upgrade by cordon node by node and the upgrade the node.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="control-plane-nodes-ready"
      
        class="image_figure image_internal image_processed"
        width="1562"
        height="420"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002109501.png"
      
      
    />

    </picture>
</figure>
</p>
<p>My control plane nodes has been upgrade to 1.28.8 already.</p>
<p>All nodes have been upgraded:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ready"
      
        class="image_figure image_internal image_processed"
        width="3444"
        height="1664"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002231948.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="all-nodes"
      
        class="image_figure image_internal image_processed"
        width="1530"
        height="414"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510002325256.png"
      
      
    />

    </picture>
</figure>
</p>
<p>This took just a couple of seconds (I was suspecting that something was wrong actually), it really only just took a couple of seconds. Everything worked as it should afterwards, I must say a relatively smoth process.</p>
<h3 id="installing-another-ingress-controller-than-the-default-ngninx---avi-kubernetes-operator">Installing another Ingress controller than the default Ngninx - Avi Kubernetes Operator</h3>
<p>In my vSphere environment I already have Avi Loadbalancer running, Avi can also be extended into Kubernetes to automate K8s service creation and also Ingress and Gateway API. So in this section I will create a cluster with AKO as my Ingress controller.</p>
<p>By default Rancher installs Nginx as the Ingress controller. To install my own Ingress controller, like AKO, I will deselect Nginx in the cluster creation wizard:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="disable-nginx"
      
        class="image_figure image_internal image_processed"
        width="1776"
        height="1226"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510094631745.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Deploy the cluster, wait for it be finished.</p>
<p>Now that I have a cluster deployed without any ingressClasses or Ingress controller I can go on an deploy the ingress controller of my choice. As from my understanding there is currently no support for OCI Helm Chart repositories as of yet in Rancher I need to deploy  AKO using the cli approach. Otherwise I could just have added the AKO repo through the GUI and deploy it as an APP.</p>
<p>From my linux machine, I have grabbed the context of my newly created K8s cluster without any Ingress installed. Then I will just follow the regular AKO installation instructions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingressclasses.networking.k8s.io
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">No resources found
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k create ns avi-system
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">namespace/avi-system created
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ helm show values oci://projects.registry.vmware.com/ako/helm-charts/ako --version 1.11.3 &gt; values.yaml
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Pulled: projects.registry.vmware.com/ako/helm-charts/ako:1.11.3
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">Digest: sha256:e4d0fcd80ae5b5377edf510d3d085211181a3f6b458a17c8b4a19d328e4cdfe6
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># Will now edit the values.yaml file to accomodate my Avi config settings</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># After edit I will deploy AKO</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ helm install --generate-name oci://projects.registry.vmware.com/ako/helm-charts/ako --version 1.11.3 -f values.yaml -n avi-system
</span></span><span class="line"><span class="ln">11</span><span class="cl">Pulled: projects.registry.vmware.com/ako/helm-charts/ako:1.11.3
</span></span><span class="line"><span class="ln">12</span><span class="cl">Digest: sha256:e4d0fcd80ae5b5377edf510d3d085211181a3f6b458a17c8b4a19d328e4cdfe6
</span></span><span class="line"><span class="ln">13</span><span class="cl">NAME: ako-1715330716
</span></span><span class="line"><span class="ln">14</span><span class="cl">LAST DEPLOYED: Fri May <span class="m">10</span> 10:45:19 <span class="m">2024</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">NAMESPACE: avi-system
</span></span><span class="line"><span class="ln">16</span><span class="cl">STATUS: deployed
</span></span><span class="line"><span class="ln">17</span><span class="cl">REVISION: <span class="m">1</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">TEST SUITE: None
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="c1"># Check for pods and Ingress Classes</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get pods -n avi-system
</span></span><span class="line"><span class="ln">22</span><span class="cl">NAME    READY   STATUS    RESTARTS   AGE
</span></span><span class="line"><span class="ln">23</span><span class="cl">ako-0   1/1     Running   <span class="m">0</span>          39s
</span></span><span class="line"><span class="ln">24</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingressclasses.networking.k8s.io
</span></span><span class="line"><span class="ln">25</span><span class="cl">NAME     CONTROLLER              PARAMETERS   AGE
</span></span><span class="line"><span class="ln">26</span><span class="cl">avi-lb   ako.vmware.com/avi-lb   &lt;none&gt;       47s
</span></span></code></pre></div><p>Now I have an Ingress controller installed in my cluster.</p>
<p>How about going back to the Rancher UI and create and Ingress using my newly deployed ingress controller?</p>
<p>I will go into my cluster, Service Discovery -&gt; Ingresses</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ingresses"
      
        class="image_figure image_internal image_processed"
        width="1288"
        height="774"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105025660.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now lets try to create an Ingress:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create-ingress"
      
        class="image_figure image_internal image_processed"
        width="2912"
        height="1360"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105300728.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Target Service and Ports are selected from the dropdown lists as long as the services are available from within the same namespace as I create my Ingress. Thats really nice.</p>
<p>Selecting my IngressClass from the dropdown.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ingressclass"
      
        class="image_figure image_internal image_processed"
        width="1714"
        height="876"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105509618.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then click Create:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create"
      
        class="image_figure image_internal image_processed"
        width="2910"
        height="1864"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105608334.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ingress-active"
      
        class="image_figure image_internal image_processed"
        width="2898"
        height="678"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510105640095.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k get ingress -n fruit
</span></span><span class="line"><span class="ln">2</span><span class="cl">NAME            CLASS    HOSTS                     ADDRESS          PORTS   AGE
</span></span><span class="line"><span class="ln">3</span><span class="cl">fruit-ingress   avi-lb   fruit-1.my-domain.net   192.168.121.13   <span class="m">80</span>      35s
</span></span></code></pre></div><p>In my Avi controller I should now have a new Virtual Service using the fqdn name:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="fruit-virtual-service"
      
        class="image_figure image_internal image_processed"
        width="1708"
        height="854"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510114029343.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="installing-custom-cni---bootstrapping-new-clusters-using-antrea-cni">Installing Custom CNI - bootstrapping new clusters using Antrea CNI</h2>
<p>What if I want to use a CNI that is not in the list of CNIs in Rancher?</p>
<p>Rancher provide a list of tested CNIs to choose from when deploying a new RKE2 cluster, but one is not limited to only choose one of these CNIs. It is possible to create a cluster using your own preferred CNI. So in this chapter I will go through how I can deploy a new RKE2 cluster using Antrea as my CNI.</p>
<p>Before I can bootstrap a cluster with Antrea (or any custom CNI) I need to tell Rancher to not deploy any CNI from the list of provided CNIs. This involves editing the cluster deployment using the YAML editor in Rancher. There is two ways I can install Antrea as the CNI during cluster creation/bootsrap, one is using the Antrea deployment manifest the other is using Helm Charts. The Helm Chart approach is the recommended way if you ask me, but one may not always have the option use Helm Chart that is way I have included both approaches. Below I will go through both of them, starting with the Antrea manifest. I need to complete one of these steps before clicking on the <em>create</em> cluster button.</p>
<h3 id="add-on-config-using-manifest">Add-on Config using manifest</h3>
<p>After I have gone through the typical cluster creation steps, node pool config, cluster config etc I will need to add my Antrea manifest in the Add-On Config section.</p>
<p>So I will be going into the Cluster Configuration section and <em>Add-On Config</em></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="add-on-config"
      
        class="image_figure image_internal image_processed"
        width="1111"
        height="491"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240513161022543.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Here I can add the deployment manifest for Antrea by just copy paste the content directly from the Antrea repo <a href="https://github.com/antrea-io/antrea/blob/main/build/yamls/antrea.yml">here</a>. This will always take you to the latest version of Antrea. Do the necessary configs in the deployment yaml like enabling or disabling the Antrea feature gates, if needed. They can be changed post cluster provision too.</p>
<p>Disregard the already populated Calico Configuration section:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="calico-add-on-config"
      
        class="image_figure image_internal image_processed"
        width="847"
        height="1224"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240513161936973.png"
      
      
    />

    </picture>
</figure>
</p>
<p>This will be removed at a later stage completely. I need to paste my Antrea deployment manifest under <em>Additional Manifest</em></p>
<p>When done proceed to the step which involves disabling the default CNI that Rancher wants to deploy. It is not possible set CNI to <em>none</em> from the UI so I need to configure the yaml directly to tell it to not install any CNI. That is done by following the steps below.</p>
<p>Click <em>edit as yaml</em></p>
<img src=images/image-20240513144701914.png style="width:400px" />
<p>Within my cluster yaml, there is certain blocks I need to edit and remove. Below is a &quot;default&quot; yaml using Calico as CNI, then I will paste the yaml which I have edited to allow me to install my custom CNI. See comments in the yamls by extending the code-field. I have only pasted parts of the yaml that is involved to make it &quot;shorter&quot;.</p>
<p>The &quot;untouched&quot; yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c"># Before edited - expand field for all content to display</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE Cluster with Antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.8+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span><span class="c">## Need to add {} due to remove the below line</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">      </span><span class="nt">rke2-calico</span><span class="p">:</span><span class="w"> </span>{}<span class="w"> </span><span class="c">### This needs to be removed</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w"></span><span class="c">#        bucket: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w"></span><span class="c">#        cloudCredentialName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w"></span><span class="c">#        endpoint: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w"></span><span class="c">#        endpointCA: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w"></span><span class="c">#        folder: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w"></span><span class="c">#        region: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w"></span><span class="c">#        skipSSLVerify: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">calico</span><span class="w"> </span><span class="c">### Need to set this to none</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span></code></pre></div><p>The edited yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c"># Before edited - expand field for all content to display</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE Cluster with Antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="c">#  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.8+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w"></span><span class="c">#        bucket: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w"></span><span class="c">#        cloudCredentialName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w"></span><span class="c">#        endpoint: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w"></span><span class="c">#        endpointCA: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w"></span><span class="c">#        folder: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w"></span><span class="c">#        region: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w"></span><span class="c">#        skipSSLVerify: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">none</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="c">## See comment below</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span></code></pre></div><p>After editing the yaml as indicated above it is time to click Create.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create-no-cni"
      
        class="image_figure image_internal image_processed"
        width="2245"
        height="349"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240513151518462.png"
      
      
    />

    </picture>
</figure>
</p>
<p>After a couple of minutes the cluster should be getting green and ready to consume with Antrea as the CNI.</p>
<p>Next up is the Helm Chart approach.</p>
<h3 id="add-on-config-using-helm-charts">Add-on Config using Helm Charts</h3>
<p>I will follow almost the same approach as above, but instead of providing the Antrea manifest, I will be providing the Antrea Helm Chart repo.</p>
<p>So to save some digital ink, head over to Add-On Config and populate the Additional Manifest with the following content:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-helm-chart"
      
        class="image_figure image_internal image_processed"
        width="2235"
        height="504"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514203207791.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Below is the yaml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">helm.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">HelmChart</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">kube-system</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span><span class="nt">bootstrap</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c"># this is important</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">  </span><span class="nt">chart</span><span class="p">:</span><span class="w"> </span><span class="l">antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">  </span><span class="nt">targetNamespace</span><span class="p">:</span><span class="w"> </span><span class="l">kube-system</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">  </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l">https://charts.antrea.io</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l">v1.15.1</span><span class="w"> </span><span class="c"># if I want a specific version to be installed</span><span class="w">
</span></span></span></code></pre></div><p>Below is a template to see which key/values that can be used:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">helm.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">HelmChart</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="c">#string</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">default</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w"></span><span class="c">#  annotations:  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w"></span><span class="c">#  labels:  key: string</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w"></span><span class="c">#  authPassCredentials: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w"></span><span class="c">#  authSecret:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w"></span><span class="c">#  backOffLimit: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w"></span><span class="c">#  bootstrap: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w"></span><span class="c">#  chart: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w"></span><span class="c">#  chartContent: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w"></span><span class="c">#  createNamespace: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w"></span><span class="c">#  dockerRegistrySecret:</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w"></span><span class="c">#  failurePolicy: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w"></span><span class="c">#  helmVersion: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w"></span><span class="c">#  jobImage: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w"></span><span class="c">#  podSecurityContext:</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w"></span><span class="c">#    fsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w"></span><span class="c">#    fsGroupChangePolicy: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w"></span><span class="c">#    runAsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w"></span><span class="c">#    runAsNonRoot: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w"></span><span class="c">#    runAsUser: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w"></span><span class="c">#    seLinuxOptions:</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w"></span><span class="c">#      level: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w"></span><span class="c">#      role: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="w"></span><span class="c">#      user: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="w"></span><span class="c">#    seccompProfile:</span><span class="w">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="w"></span><span class="c">#      localhostProfile: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="w"></span><span class="c">#    supplementalGroups:</span><span class="w">
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="w"></span><span class="c">#      - int</span><span class="w">
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="w"></span><span class="c">#    sysctls:</span><span class="w">
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="w"></span><span class="c">#      - name: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="w"></span><span class="c">#        value: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="w"></span><span class="c">#    windowsOptions:</span><span class="w">
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpec: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpecName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="w"></span><span class="c">#      hostProcess: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="w"></span><span class="c">#      runAsUserName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="w"></span><span class="c">#  repo: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="w"></span><span class="c">#  repoCA: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="w"></span><span class="c">#  repoCAConfigMap:</span><span class="w">
</span></span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="w"></span><span class="c">#    name: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="w"></span><span class="c">#  securityContext:</span><span class="w">
</span></span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="w"></span><span class="c">#    allowPrivilegeEscalation: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">52</span><span class="cl"><span class="w"></span><span class="c">#    capabilities:</span><span class="w">
</span></span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="w"></span><span class="c">#      add:</span><span class="w">
</span></span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="w"></span><span class="c">#        - string</span><span class="w">
</span></span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="w"></span><span class="c">#      drop:</span><span class="w">
</span></span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="w"></span><span class="c">#        - string</span><span class="w">
</span></span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="w"></span><span class="c">#    privileged: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">58</span><span class="cl"><span class="w"></span><span class="c">#    procMount: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">59</span><span class="cl"><span class="w"></span><span class="c">#    readOnlyRootFilesystem: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">60</span><span class="cl"><span class="w"></span><span class="c">#    runAsGroup: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">61</span><span class="cl"><span class="w"></span><span class="c">#    runAsNonRoot: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">62</span><span class="cl"><span class="w"></span><span class="c">#    runAsUser: int</span><span class="w">
</span></span></span><span class="line"><span class="ln">63</span><span class="cl"><span class="w"></span><span class="c">#    seLinuxOptions:</span><span class="w">
</span></span></span><span class="line"><span class="ln">64</span><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="w"></span><span class="c">#      level: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">66</span><span class="cl"><span class="w"></span><span class="c">#      role: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">67</span><span class="cl"><span class="w"></span><span class="c">#      user: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="w"></span><span class="c">#    seccompProfile:</span><span class="w">
</span></span></span><span class="line"><span class="ln">69</span><span class="cl"><span class="w"></span><span class="c">#      type: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">70</span><span class="cl"><span class="w"></span><span class="c">#      localhostProfile: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">71</span><span class="cl"><span class="w"></span><span class="c">#    windowsOptions:</span><span class="w">
</span></span></span><span class="line"><span class="ln">72</span><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpec: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">73</span><span class="cl"><span class="w"></span><span class="c">#      gmsaCredentialSpecName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">74</span><span class="cl"><span class="w"></span><span class="c">#      hostProcess: boolean</span><span class="w">
</span></span></span><span class="line"><span class="ln">75</span><span class="cl"><span class="w"></span><span class="c">#      runAsUserName: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">76</span><span class="cl"><span class="w"></span><span class="c">#  set: map[]</span><span class="w">
</span></span></span><span class="line"><span class="ln">77</span><span class="cl"><span class="w"></span><span class="c">#  targetNamespace: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">78</span><span class="cl"><span class="w"></span><span class="c">#  timeout: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">79</span><span class="cl"><span class="w"></span><span class="c">#  valuesContent: string</span><span class="w">
</span></span></span><span class="line"><span class="ln">80</span><span class="cl"><span class="w"></span><span class="c">#  version: string</span><span class="w">
</span></span></span></code></pre></div><p>Then edit the cluster yaml to disable the Rancher provided CNI, as described above.</p>
<p>Click <em>create</em></p>
<p>Below is a complete yaml of the cluster being provisioned with Antrea as the CNI using Helm Chart option.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln">  1</span><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">provisioning.cattle.io/v1</span><span class="w">
</span></span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Cluster</span><span class="w">
</span></span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">rke2-cluster-4-antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="w">  </span><span class="nt">annotations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="w">    </span><span class="nt">field.cattle.io/description</span><span class="p">:</span><span class="w"> </span><span class="l">RKE2 using Antrea</span><span class="w">
</span></span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="w">  </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="w">    </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l">fleet-default</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="w">  </span><span class="nt">cloudCredentialSecretName</span><span class="p">:</span><span class="w"> </span><span class="l">cattle-global-data:cc-qsq7b</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="w">  </span><span class="nt">clusterAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="w">    </span><span class="nt">appendTolerations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="w">    </span><span class="nt">overrideResourceRequirements</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="w">  </span><span class="nt">defaultPodSecurityAdmissionConfigurationTemplateName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="w">  </span><span class="nt">defaultPodSecurityPolicyTemplateName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="w">  </span><span class="nt">fleetAgentDeploymentCustomization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="w">    </span><span class="nt">appendTolerations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="w">    </span><span class="nt">overrideAffinity</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="w">    </span><span class="nt">overrideResourceRequirements</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="w">  </span><span class="nt">kubernetesVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1.28.9+rke2r1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="w">  </span><span class="nt">localClusterAuthEndpoint</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="w">    </span><span class="nt">caCerts</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="w">    </span><span class="nt">fqdn</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="w">  </span><span class="nt">rkeConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="w">    </span><span class="nt">additionalManifest</span><span class="p">:</span><span class="w"> </span><span class="p">|-</span><span class="sd">
</span></span></span><span class="line"><span class="ln"> 28</span><span class="cl"><span class="sd">      apiVersion: helm.cattle.io/v1
</span></span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="sd">      kind: HelmChart
</span></span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="sd">      metadata:
</span></span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="sd">        name: antrea
</span></span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="sd">        namespace: kube-system
</span></span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="sd">      spec:
</span></span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="sd">        bootstrap: true # This is important
</span></span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="sd">        chart: antrea
</span></span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="sd">        targetNamespace: kube-system
</span></span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="sd">        repo: https://charts.antrea.io</span><span class="w">      
</span></span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="w">    </span><span class="nt">chartValues</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 39</span><span class="cl"><span class="w">    </span><span class="nt">etcd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="w">      </span><span class="nt">disableSnapshots</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="w">      </span><span class="nt">s3</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="w">      </span><span class="nt">snapshotRetention</span><span class="p">:</span><span class="w"> </span><span class="m">5</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="w">      </span><span class="nt">snapshotScheduleCron</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="cp">*/5</span><span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w">
</span></span></span><span class="line"><span class="ln"> 44</span><span class="cl"><span class="w">    </span><span class="nt">machineGlobalConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="w">      </span><span class="nt">cluster-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.10.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="w">      </span><span class="nt">cni</span><span class="p">:</span><span class="w"> </span><span class="l">none</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 47</span><span class="cl"><span class="w">      </span><span class="nt">disable-kube-proxy</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="w">      </span><span class="nt">etcd-expose-metrics</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 49</span><span class="cl"><span class="w">      </span><span class="nt">service-cidr</span><span class="p">:</span><span class="w"> </span><span class="m">10.20.0.0</span><span class="l">/16</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="w">      </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 51</span><span class="cl"><span class="w">    </span><span class="nt">machinePools</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pool1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="w">        </span><span class="nt">etcdRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="w">        </span><span class="nt">controlPlaneRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="w">        </span><span class="nt">workerRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="w">        </span><span class="nt">hostnamePrefix</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="w">        </span><span class="nt">quantity</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="w">        </span><span class="nt">unhealthyNodeTimeout</span><span class="p">:</span><span class="w"> </span><span class="l">0m</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="w">        </span><span class="nt">machineConfigRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 60</span><span class="cl"><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VmwarevsphereConfig</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nc-rke2-cluster-4-antrea-pool1-gh2nj</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="w">        </span><span class="nt">drainBeforeDelete</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="w">        </span><span class="nt">machineOS</span><span class="p">:</span><span class="w"> </span><span class="l">linux</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="w">        </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">pool2</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="w">        </span><span class="nt">etcdRole</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 67</span><span class="cl"><span class="w">        </span><span class="nt">controlPlaneRole</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="w">        </span><span class="nt">workerRole</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="w">        </span><span class="nt">hostnamePrefix</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="w">        </span><span class="nt">quantity</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 71</span><span class="cl"><span class="w">        </span><span class="nt">unhealthyNodeTimeout</span><span class="p">:</span><span class="w"> </span><span class="l">0m</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="w">        </span><span class="nt">machineConfigRef</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="w">          </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">VmwarevsphereConfig</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nc-rke2-cluster-4-antrea-pool2-s5sv4</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 75</span><span class="cl"><span class="w">        </span><span class="nt">drainBeforeDelete</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="w">        </span><span class="nt">machineOS</span><span class="p">:</span><span class="w"> </span><span class="l">linux</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="w">        </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="w">    </span><span class="nt">machineSelectorConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="w">      </span>- <span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="w">          </span><span class="nt">protect-kernel-defaults</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 81</span><span class="cl"><span class="w">    </span><span class="nt">registries</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 82</span><span class="cl"><span class="w">      </span><span class="nt">configs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 83</span><span class="cl"><span class="w">        </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 84</span><span class="cl"><span class="w">      </span><span class="nt">mirrors</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="w">        </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln"> 86</span><span class="cl"><span class="w">    </span><span class="nt">upgradeStrategy</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="w">      </span><span class="nt">controlPlaneConcurrency</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="w">      </span><span class="nt">controlPlaneDrainOptions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="w">        </span><span class="nt">deleteEmptyDirData</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="w">        </span><span class="nt">disableEviction</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="w">        </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="w">        </span><span class="nt">gracePeriod</span><span class="p">:</span><span class="w"> </span>-<span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 94</span><span class="cl"><span class="w">        </span><span class="nt">ignoreDaemonSets</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="w">        </span><span class="nt">skipWaitForDeleteTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="w">        </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="w">      </span><span class="nt">workerConcurrency</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="w">      </span><span class="nt">workerDrainOptions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="w">        </span><span class="nt">deleteEmptyDirData</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln">100</span><span class="cl"><span class="w">        </span><span class="nt">disableEviction</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">101</span><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="w">        </span><span class="nt">force</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="w">        </span><span class="nt">gracePeriod</span><span class="p">:</span><span class="w"> </span>-<span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="w">        </span><span class="nt">ignoreDaemonSets</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="w">        </span><span class="nt">skipWaitForDeleteTimeoutSeconds</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="ln">106</span><span class="cl"><span class="w">        </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="m">120</span><span class="w">
</span></span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="w">  </span><span class="nt">machineSelectorConfig</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="w">    </span>- <span class="nt">config</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="w"></span><span class="nt">__clone</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>By doing the steps above, I should shortly have a freshly installed Kubernetes cluster deployed using Antrea as my CNI.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-app"
      
        class="image_figure image_internal image_processed"
        width="2481"
        height="697"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514203832012.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-1"
      
        class="image_figure image_internal image_processed"
        width="2481"
        height="650"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514193830195.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-tiers"
      
        class="image_figure image_internal image_processed"
        width="2478"
        height="653"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514193904279.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Run kubectl commands inside here</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># e.g. kubectl get all</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">&gt; k get pods -A
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">NAMESPACE             NAME                                                                  READY   STATUS      RESTARTS      AGE
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cattle-fleet-system   fleet-agent-7cf5c7b6cb-cbr4c                                          1/1     Running     <span class="m">0</span>             35m
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">cattle-system         cattle-cluster-agent-686798b687-jq9kp                                 1/1     Running     <span class="m">0</span>             36m
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">cattle-system         cattle-cluster-agent-686798b687-q97mx                                 1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">cattle-system         dashboard-shell-6tldq                                                 2/2     Running     <span class="m">0</span>             7s
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">cattle-system         helm-operation-95wr6                                                  0/2     Completed   <span class="m">0</span>             35m
</span></span><span class="line"><span class="ln">10</span><span class="cl">cattle-system         helm-operation-jtgzs                                                  0/2     Completed   <span class="m">0</span>             29m
</span></span><span class="line"><span class="ln">11</span><span class="cl">cattle-system         helm-operation-qz9bc                                                  0/2     Completed   <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln">12</span><span class="cl">cattle-system         rancher-webhook-7d57cd6cb8-4thw7                                      1/1     Running     <span class="m">0</span>             29m
</span></span><span class="line"><span class="ln">13</span><span class="cl">cattle-system         system-upgrade-controller-6f86d6d4df-x46gp                            1/1     Running     <span class="m">0</span>             35m
</span></span><span class="line"><span class="ln">14</span><span class="cl">kube-system           antrea-agent-9qm2d                                                    2/2     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">15</span><span class="cl">kube-system           antrea-agent-dr2hz                                                    2/2     Running     <span class="m">1</span> <span class="o">(</span>33m ago<span class="o">)</span>   34m
</span></span><span class="line"><span class="ln">16</span><span class="cl">kube-system           antrea-controller-768b4dbcb5-7srnw                                    1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">17</span><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv   1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">18</span><span class="cl">kube-system           etcd-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv                       1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">19</span><span class="cl">kube-system           helm-install-antrea-vtskp                                             0/1     Completed   <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln">20</span><span class="cl">kube-system           helm-install-rke2-coredns-8lrrq                                       0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">21</span><span class="cl">kube-system           helm-install-rke2-ingress-nginx-4bbr4                                 0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">22</span><span class="cl">kube-system           helm-install-rke2-metrics-server-8xrbh                                0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">23</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-rt5hb                       0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">24</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-pncxt                           0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">25</span><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-zv9kl                   0/1     Completed   <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">26</span><span class="cl">kube-system           kube-apiserver-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv             1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">27</span><span class="cl">kube-system           kube-controller-manager-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv    1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">28</span><span class="cl">kube-system           kube-proxy-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv                 1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">29</span><span class="cl">kube-system           kube-proxy-rke2-cluster-5-antrea-pool2-209a1e89-9sjt7                 1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln">30</span><span class="cl">kube-system           kube-scheduler-rke2-cluster-5-antrea-pool1-fea898fd-t7fhv             1/1     Running     <span class="m">0</span>             38m
</span></span><span class="line"><span class="ln">31</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-6hrfv                            1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">32</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-z2bb5                            1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln">33</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-spj7d                  1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">34</span><span class="cl">kube-system           rke2-ingress-nginx-controller-8p7rz                                   1/1     Running     <span class="m">0</span>             34m
</span></span><span class="line"><span class="ln">35</span><span class="cl">kube-system           rke2-ingress-nginx-controller-zdbvm                                   0/1     Pending     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">36</span><span class="cl">kube-system           rke2-metrics-server-655477f655-5n7sp                                  1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">37</span><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-6mtbs                             1/1     Running     <span class="m">0</span>             37m
</span></span><span class="line"><span class="ln">38</span><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-jprqr                     1/1     Running     <span class="m">0</span>             37m
</span></span></code></pre></div><p>Now with Antrea installed as the CNI I can go ahead and use the rich set of feature gates Antrea brings to table.</p>
<p>To enable and disable the Antrea FeatureGates either edit the configMap using <em>kubectl edit configmap -n kube-system antrea-config</em> or use the Rancher UI:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ConfigMaps"
      
        class="image_figure image_internal image_processed"
        width="2482"
        height="634"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194348844.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="edit-config"
      
        class="image_figure image_internal image_processed"
        width="2487"
        height="1326"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194425307.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="edit-yaml"
      
        class="image_figure image_internal image_processed"
        width="2488"
        height="763"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514194506279.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="upgrading-or-changing-version-of-the-antrea-cni-using-rancher">Upgrading or changing version of the Antrea CNI using Rancher</h3>
<p>When I deploy Antrea using the Helm Chart Add-On Config, upgrading or changing the version of Antrea is a walk in the park.</p>
<p>In the cluster I want to upgrade/downgrade Antrea I first need to add the Antrea Helm Repo under App -&gt; Repositories:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="add-antrea-repo"
      
        class="image_figure image_internal image_processed"
        width="1541"
        height="347"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204700410.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Then head back to Installed Apps under <strong>Apps</strong> and click on <em>antrea</em></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-app"
      
        class="image_figure image_internal image_processed"
        width="2478"
        height="440"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204819652.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Click top right corner:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="upgrade"
      
        class="image_figure image_internal image_processed"
        width="2240"
        height="223"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514204934418.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Follow the wizard and select the version you want, then click next.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="antrea-version"
      
        class="image_figure image_internal image_processed"
        width="2487"
        height="788"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205037494.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Change values or dont, and click Upgrade:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="upgrade"
      
        class="image_figure image_internal image_processed"
        width="2485"
        height="1328"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205229183.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Sit back and enjoy:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="upgraded"
      
        class="image_figure image_internal image_processed"
        width="2100"
        height="1273"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514205343991.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I just downgraded from version 2.0.0 to 1.15.1, the same approach is true for upgrading to a newer version of course. But why upgrade when one can downgrade, one need to have some fun in life...</p>
<p>In the list of <strong>Installed Apps</strong> view Rancher will notify me if there is a new release available. This is a nice indicator whenever there is a new release:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="new-version-available"
      
        class="image_figure image_internal image_processed"
        width="2480"
        height="749"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240514211110983.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="neuvector">NeuVector</h2>
<p>NeuVector is new for me, by having a quick look at what it does it did spark my interest. From the official <a href="https://open-docs.neuvector.com/basics/overview">docs page</a>:</p>
<blockquote>
<p>NeuVector provides a powerful end-to-end container security platform. This includes end-to-end vulnerability scanning and complete run-time protection for containers, pods and hosts, including:</p>
<ol>
<li>CI/CD Vulnerability Management &amp; Admission Control. Scan images with a Jenkins plug-in, scan registries, and enforce admission control rules for deployments into production.</li>
<li>Violation Protection. Discovers behavior and creates a whitelist based policy to detect violations of normal behavior.</li>
<li>Threat Detection. Detects common application attacks such as DDoS and DNS attacks on containers.</li>
<li>DLP and WAF Sensors. Inspect network traffic for Data Loss Prevention of sensitive data, and detect common OWASP Top10 WAF attacks.</li>
<li>Run-time Vulnerability Scanning. Scans registries, images and running containers orchestration platforms and hosts for common (CVE) as well as application specific vulnerabilities.</li>
<li>Compliance &amp; Auditing. Runs Docker Bench tests and Kubernetes CIS Benchmarks automatically.</li>
<li>Endpoint/Host Security. Detects privilege escalations, monitors processes and file activity on hosts and within containers, and monitors container file systems for suspicious activity.</li>
<li>Multi-cluster Management. Monitor and manage multiple Kubernetes clusters from a single console.</li>
</ol>
<p>Other features of NeuVector include the ability to quarantine containers and to export logs through SYSLOG and webhooks, initiate packet capture for investigation, and integration with OpenShift RBACs, LDAP, Microsoft AD, and SSO with SAML. Note: Quarantine means that all network traffic is blocked. The container will remain and continue to run - just without any network connections. Kubernetes will not start up a container to replace a quarantined container, as the api-server is still able to reach the container.</p>
</blockquote>
<p>If I head over to any of my clusters in Rancher under Apps -&gt; Charts I will find a set of ready to install applications. There I also find NeuVector:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="apps-neuvector"
      
        class="image_figure image_internal image_processed"
        width="1966"
        height="1432"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121533387.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Lets try an installation of NeuVector. I will keep everything at default for now. As one can imagine there is some configurations that should be done if deploying it in production, like Ingress, Certificate, PVC etc. By just deploying with all default values it will be exposed using NodePort, selfsigned certificate and no PVC.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="install"
      
        class="image_figure image_internal image_processed"
        width="3434"
        height="1036"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121711137.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="step-1"
      
        class="image_figure image_internal image_processed"
        width="2932"
        height="1898"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121802867.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="step2"
      
        class="image_figure image_internal image_processed"
        width="2930"
        height="1902"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510121903296.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">&gt; k get pods -A
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAMESPACE                 NAME                                                                   READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-cctd7                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-ql5dz                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cattle-neuvector-system   neuvector-controller-pod-5b8b6f7df-tmb77                               1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-lnsfl                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-m4gjp                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">cattle-neuvector-system   neuvector-enforcer-pod-wr5j4                                           1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">cattle-neuvector-system   neuvector-manager-pod-779f9976f8-cmlh5                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln">10</span><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-8lztx                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln">11</span><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-8qhr7                                 1/1     Running     <span class="m">0</span>          53s
</span></span><span class="line"><span class="ln">12</span><span class="cl">cattle-neuvector-system   neuvector-scanner-pod-797cc57f7d-gcbr9                                 1/1     Running     <span class="m">0</span>          53s
</span></span></code></pre></div><p>NeuVector is up and running.</p>
<p>Lets have a quick look inside NeuVector</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="login"
      
        class="image_figure image_internal image_processed"
        width="2594"
        height="1754"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124246619.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Default password is <em>admin</em></p>
<p>First glance:</p>
<p>Dashboard</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="dasboard"
      
        class="image_figure image_internal image_processed"
        width="3566"
        height="1978"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124409589.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Network Activity</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="network-activity"
      
        class="image_figure image_internal image_processed"
        width="3558"
        height="1952"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510124556048.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Network Rules</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="network-rules"
      
        class="image_figure image_internal image_processed"
        width="3568"
        height="1970"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510125541756.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Settings</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="settings"
      
        class="image_figure image_internal image_processed"
        width="3562"
        height="1914"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240510125624102.png"
      
      
    />

    </picture>
</figure>
</p>
<p>For more information head over to the official NeuVector documentation page <a href="https://open-docs.neuvector.com/navigation/navigation">here</a></p>
<p><strong>Neuvector Rancher UI Extension</strong></p>
<p>Neuvector can also be installed as an extension in Rancher:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="neuvector-rancher"
      
        class="image_figure image_internal image_processed"
        width="3554"
        height="1922"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100149730.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="install"
      
        class="image_figure image_internal image_processed"
        width="2532"
        height="1152"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100231909.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="reload"
      
        class="image_figure image_internal image_processed"
        width="1288"
        height="704"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100341875.png"
      
      
    />

    </picture>
</figure>
</p>
<p>If I now head into the cluster I have deployed NeuVector, I will get a great overview from NeuVector directly in the Rancher UI:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="neuvector-overview"
      
        class="image_figure image_internal image_processed"
        width="3578"
        height="2012"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511100543769.png"
      
      
    />

    </picture>
</figure>
</p>
<p>That is very neat. And again, it was just one click to enable this extension.</p>
<h2 id="monitoring">Monitoring</h2>
<p>Keeping track of whats going on in the whole Kubernetes estate is crucial, everything from Audit logs, performance, troubleshooting.</p>
<p>I will try out the Monitoring app that is available under Monitoring tools, or Cluster tools here:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="monitoring"
      
        class="image_figure image_internal image_processed"
        width="3430"
        height="1640"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101446424.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="monitoring"
      
        class="image_figure image_internal image_processed"
        width="3420"
        height="2008"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101610249.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Again, using default values:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="install"
      
        class="image_figure image_internal image_processed"
        width="3444"
        height="2012"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511101709208.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">SUCCESS: helm upgrade --install<span class="o">=</span><span class="nb">true</span> --namespace<span class="o">=</span>cattle-monitoring-system --timeout<span class="o">=</span>10m0s --values<span class="o">=</span>/home/shell/helm/values-rancher-monitoring-103.1.0-up45.31.1.yaml --version<span class="o">=</span>103.1.0+up45.31.1 --wait<span class="o">=</span><span class="nb">true</span> rancher-monitoring /home/shell/helm/rancher-monitoring-103.1.0-up45.31.1.tgz
</span></span><span class="line"><span class="ln">2</span><span class="cl">2024-05-11T08:19:06.403230781Z ---------------------------------------------------------------------
</span></span></code></pre></div><p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="up-and-running"
      
        class="image_figure image_internal image_processed"
        width="950"
        height="408"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511102112263.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I suddenly can access it all from the Monitoring section within my cluster:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="monitoring"
      
        class="image_figure image_internal image_processed"
        width="3562"
        height="1550"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104058931.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Notice the Active Alerts.</p>
<p>From the Cluster Dashboard:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="dashboard"
      
        class="image_figure image_internal image_processed"
        width="2229"
        height="776"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240513143749611.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Lets see whats going on in and with my cluster:</p>
<p><strong>AlertManager</strong></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="alertmanager"
      
        class="image_figure image_internal image_processed"
        width="2564"
        height="1200"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104237091.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="alert"
      
        class="image_figure image_internal image_processed"
        width="2476"
        height="714"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511111127724.png"
      
      
    />

    </picture>
</figure>
</p>
<p><strong>Grafana</strong></p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="grafana"
      
        class="image_figure image_internal image_processed"
        width="3566"
        height="2006"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104314786.png"
      
      
    />

    </picture>
</figure>
</p>
<p>A bunch of provided dashboards:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="dashboards"
      
        class="image_figure image_internal image_processed"
        width="3386"
        height="1856"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511104358707.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="the-rancher-api">The Rancher API</h2>
<p>One can interact with Rancher not only using the great Rancher UI, but using the CLI, kubectl and from external applications.</p>
<p>Lets start with the CLI. The binary for the CLI can be downloaded from the Rancher UI by going to <em>about</em> - here:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="image-20240511112634751"
      
        class="image_figure image_internal image_processed"
        width="3566"
        height="1994"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511112634751.png"
      
      
    />

    </picture>
</figure>
</p>
<p>I download the tar file for mac, extract it using <code>tar -zxvf rancher-darwin-amd64-v2.8.3.tar.gz</code> and then copy/and move it to <em>/user/local/bin/</em> folder.</p>
<p>Before I can use th CLI to connect to my Rancher endpoint I need to create an api token here:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="api-key"
      
        class="image_figure image_internal image_processed"
        width="3434"
        height="660"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113253630.png"
      
      
    />

    </picture>
</figure>
</p>
<p>No Scopes as I want access to them all</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="create"
      
        class="image_figure image_internal image_processed"
        width="3444"
        height="1148"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113331005.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="ready"
      
        class="image_figure image_internal image_processed"
        width="3438"
        height="1222"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113416587.png"
      
      
    />

    </picture>
</figure>
</p>
<p>Now I need to copy these keys, so I have them. They will expire in 90 days. If I loose them I have to create new ones.</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="created"
      
        class="image_figure image_internal image_processed"
        width="3206"
        height="140"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511113618928.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher login https://rancher-dev.my-domain.net --token token-m8k88:cr89kvdq4xfsl4pcnn4rh5xkdcw2rhvz46cxlrpw29qblqxbsnz
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NUMBER    CLUSTER NAME             PROJECT ID             PROJECT NAME   PROJECT DESCRIPTION
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="m">1</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-dt4qw   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="m">2</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-rpqhc   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="m">3</span>         rke2-cluster-1           c-m-d85dvj2l:p-gpczf   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="m">4</span>         rke2-cluster-1           c-m-d85dvj2l:p-l6cln   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="m">5</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-57cpk   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="m">6</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-fzdtp   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="m">7</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-8gc9x   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="m">8</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-f2kkb   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="m">9</span>         tanzuz-cluster-1         c-m-qxpbc6tp:p-mk49f   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="m">10</span>        tanzuz-cluster-1         c-m-qxpbc6tp:p-s428w   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="m">11</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-nrxgl   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="m">12</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-xsmbd   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="m">13</span>        <span class="nb">local</span>                    local:p-tqk2t          Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="m">14</span>        <span class="nb">local</span>                    local:p-znt9n          System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">17</span><span class="cl">Select a Project:
</span></span></code></pre></div><p>Selecting project rke2-cluster-2-vsphere ID 5:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">Select a Project:5
</span></span><span class="line"><span class="ln">2</span><span class="cl">INFO<span class="o">[</span>0123<span class="o">]</span> Saving config to /Users/andreasm/.rancher/cli2.json
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher kubectl get pods -A
</span></span><span class="line"><span class="ln">2</span><span class="cl">NAMESPACE                  NAME                                                                   READY   STATUS      RESTARTS      AGE
</span></span><span class="line"><span class="ln">3</span><span class="cl">calico-system              calico-kube-controllers-7fdf877475-svqt8                               1/1     Running     <span class="m">0</span>             22h
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">#Switch between contexts</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ rancher context switch
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">NUMBER    CLUSTER NAME             PROJECT ID             PROJECT NAME   PROJECT DESCRIPTION
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="m">1</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-dt4qw   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="m">2</span>         rke2-cluster-3-ako       c-m-6h64tt4t:p-rpqhc   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="m">3</span>         rke2-cluster-1           c-m-d85dvj2l:p-gpczf   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="m">4</span>         rke2-cluster-1           c-m-d85dvj2l:p-l6cln   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="m">5</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-57cpk   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="m">6</span>         rke2-cluster-2-vsphere   c-m-ddljkdhx:p-fzdtp   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="m">7</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-8gc9x   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="m">8</span>         k8s-prod-cluster-2       c-m-pjl4pxfl:p-f2kkb   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="m">9</span>         tanzuz-cluster-1         c-m-qxpbc6tp:p-mk49f   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="m">10</span>        tanzuz-cluster-1         c-m-qxpbc6tp:p-s428w   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="m">11</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-nrxgl   Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="m">12</span>        rke2-cluster-proxmox-1   c-m-tllp6sd6:p-xsmbd   System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="m">13</span>        <span class="nb">local</span>                    local:p-tqk2t          Default        Default project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="m">14</span>        <span class="nb">local</span>                    local:p-znt9n          System         System project created <span class="k">for</span> the cluster
</span></span><span class="line"><span class="ln">18</span><span class="cl">Select a Project:
</span></span></code></pre></div><p>More information on the CLI reference page <a href="https://ranchermanager.docs.rancher.com/reference-guides/cli-with-rancher/rancher-cli">here</a></p>
<p>More information on the API <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api">here</a></p>
<p><strong>kubectl</strong></p>
<p>Using kubectl without the Rancher CLI is of course possible, just grab the contexts from your different cluster you have access to from the Rancher UI, copy or download them and put into the .kube/config or point to them as below and interact with Rancher managed Kubernetes clusters as they were any other Kubernetes cluster:</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="download"
      
        class="image_figure image_internal image_processed"
        width="1326"
        height="330"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511115154151.png"
      
      
    />

    </picture>
</figure>
</p>
<p>
  <figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt="copy"
      
        class="image_figure image_internal image_processed"
        width="746"
        height="290"
        src="/2024/05/05/taking-rancher-by-suse-for-a-spin/images/image-20240511115215009.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">andreasm@linuxmgmt01:~/rancher$ k --kubeconfig rke-ako.yaml get pods -A
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">NAMESPACE             NAME                                                               READY   STATUS      RESTARTS   AGE
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">avi-system            ako-0                                                              1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">calico-system         calico-kube-controllers-67f857444-qwtd7                            1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">calico-system         calico-node-4k6kl                                                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">calico-system         calico-node-wlzpt                                                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">calico-system         calico-typha-75d7fbfc6c-bhgxj                                      1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">cattle-fleet-system   fleet-agent-7cf5c7b6cb-kqgqm                                       1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">cattle-system         cattle-cluster-agent-8548cbfbb7-b4t5f                              1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">10</span><span class="cl">cattle-system         cattle-cluster-agent-8548cbfbb7-hvdcx                              1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">11</span><span class="cl">cattle-system         rancher-webhook-7d57cd6cb8-gwvr4                                   1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">12</span><span class="cl">cattle-system         system-upgrade-controller-6f86d6d4df-zg7lv                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">13</span><span class="cl">fruit                 apple-app                                                          1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="ln">14</span><span class="cl">fruit                 banana-app                                                         1/1     Running     <span class="m">0</span>          24h
</span></span><span class="line"><span class="ln">15</span><span class="cl">kube-system           cloud-controller-manager-rke2-cluster-3-ako-pool1-b6cddca0-tf84w   1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">16</span><span class="cl">kube-system           etcd-rke2-cluster-3-ako-pool1-b6cddca0-tf84w                       1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">17</span><span class="cl">kube-system           helm-install-rke2-calico-crd-w2skj                                 0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">18</span><span class="cl">kube-system           helm-install-rke2-calico-lgcdp                                     0/1     Completed   <span class="m">1</span>          25h
</span></span><span class="line"><span class="ln">19</span><span class="cl">kube-system           helm-install-rke2-coredns-xlrtx                                    0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">20</span><span class="cl">kube-system           helm-install-rke2-metrics-server-rb7qj                             0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">21</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-crd-bhrq5                    0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">22</span><span class="cl">kube-system           helm-install-rke2-snapshot-controller-wlftf                        0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">23</span><span class="cl">kube-system           helm-install-rke2-snapshot-validation-webhook-jmnm2                0/1     Completed   <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">24</span><span class="cl">kube-system           kube-apiserver-rke2-cluster-3-ako-pool1-b6cddca0-tf84w             1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">25</span><span class="cl">kube-system           kube-controller-manager-rke2-cluster-3-ako-pool1-b6cddca0-tf84w    1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">26</span><span class="cl">kube-system           kube-proxy-rke2-cluster-3-ako-pool1-b6cddca0-tf84w                 1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">27</span><span class="cl">kube-system           kube-proxy-rke2-cluster-3-ako-pool2-50bb46e0-tj2kp                 1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">28</span><span class="cl">kube-system           kube-scheduler-rke2-cluster-3-ako-pool1-b6cddca0-tf84w             1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">29</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-jj2gk                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">30</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-84b9cb946c-wq4hs                         1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">31</span><span class="cl">kube-system           rke2-coredns-rke2-coredns-autoscaler-b49765765-c86ps               1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">32</span><span class="cl">kube-system           rke2-metrics-server-544c8c66fc-hkdh9                               1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">33</span><span class="cl">kube-system           rke2-snapshot-controller-59cc9cd8f4-np4lt                          1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">34</span><span class="cl">kube-system           rke2-snapshot-validation-webhook-54c5989b65-9zk7w                  1/1     Running     <span class="m">0</span>          25h
</span></span><span class="line"><span class="ln">35</span><span class="cl">tigera-operator       tigera-operator-779488d655-7x25x                                   1/1     Running     <span class="m">0</span>          25h
</span></span></code></pre></div><h2 id="authentication-and-rbac-with-rancher">Authentication and RBAC with Rancher</h2>
<p>Rancher provides a robust Authentication and RBAC out of the box. For more information on authentication and RBAC in Rancher head over <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config">here</a> <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac">here</a></p>
<p>Rancher can integrate with the following external authentication services, in addition to local user authentication:</p>
<ul>
<li>Microsoft Active Directory</li>
<li>Microsoft Azure AD</li>
<li>Microsoft AD FS</li>
<li>GitHub</li>
<li>FreeIPA</li>
<li>OpenLDAP</li>
<li>PingIdentity</li>
<li>KeyCloak (OIDC)</li>
<li>KeyCloak ((SAML)</li>
<li>Okta</li>
<li>Google OAuth</li>
<li>Shibboleth</li>
</ul>
<p>RBAC is an important part in managing a Kubernetes estate. I will cover RBAC in Rancher in more depth in another blog post.</p>
<h2 id="outro">Outro</h2>
<p>My experience with Rancher has been very positive, I would say way over the expectations I had before I started writing this post. It (Rancher) just feels like a well thought through product, solid and complete. It brings a lot of built-in features and tested applications, but its not limiting me to do things differently nor add my own &quot;custom&quot; things to it. Delivering a product with so many features out-of-the-box, without setting to many limitations on what I can do &quot;outside-the-box&quot; is not an easy achievement, but Rancher gives me the feeling they have acheived it. I feel like whatever feature I wanted, Rancher had it, at the same time many features I even haven't thought of, Rancher had it.</p>
<p>A very powerful Kubernetes management platform. Its open-source and available.</p>
<p>Stay tuned for some follow-up posts where I deepdive into specific topics of Rancher. This will be fun.</p>

    </div>




  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    <br>
    
  
  <div class="search">
    <input type="search" class="search_field form_field" placeholder='Search...' id="find" autocomplete="off" data-scope='post'>
    <label for="find" class="search_label"><svg class="icon">
  <title>search</title>
  <use xlink:href="#search"></use>
</svg>

    </label>
    
    <div class="search_results results"></div>
  </div>

        <h2>Hi there</h2>
      <div class="author_bio">
        This is Andreas Marqvardsen's blog, a Lead Solution Engineer at VMware by Broadcom. This blog focuses on Kubernetes, Kubernetes infrastructure such as networking and security and stuff he finds interesting.
      </div>
      <a href='https://blog.andreasm.io/about/' class="button mt-1" role="button" title='Read More'>Read More</a>

    
    
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://blog.andreasm.io/2024/05/13/neuvector-by-suse-security-where-it-is-needed-part-1/" class="nav-link" title="NeuVector by SUSE - security where it is needed - part 1">NeuVector by SUSE - security where it is needed - part 1</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2024/05/05/taking-rancher-by-suse-for-a-spin/" class="nav-link" title="Taking Rancher by SUSE for a Spin">Taking Rancher by SUSE for a Spin</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2024/04/16/exploring-some-antrea-features/" class="nav-link" title="Exploring some Antrea Features">Exploring some Antrea Features</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2024/04/08/vsphere-with-tanzu-avi-and-multiple-supervisors/" class="nav-link" title="vSphere with Tanzu - Avi and Multiple Supervisors">vSphere with Tanzu - Avi and Multiple Supervisors</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2024/02/04/argo-cd-vsphere-with-tanzu/" class="nav-link" title="Argo CD &amp; vSphere with Tanzu">Argo CD &amp; vSphere with Tanzu</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2024/01/15/proxmox-with-opentofu-kubespray-and-kubernetes/" class="nav-link" title="Proxmox with OpenTofu Kubespray and Kubernetes">Proxmox with OpenTofu Kubespray and Kubernetes</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2023/12/26/traefik-proxy-in-kubernetes/" class="nav-link" title="Traefik Proxy in Kubernetes">Traefik Proxy in Kubernetes</a>
      </li>
      <li>
        <a href="https://blog.andreasm.io/2023/12/18/a-quick-glance-at-cilium-cni/" class="nav-link" title="A Quick Glance at Cilium CNI">A Quick Glance at Cilium CNI</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">Categories</h2>
      <nav class="tags_nav">
        <a href='https://blog.andreasm.io/categories/kubernetes/' class="post_tag button button_translucent" title="kubernetes">
          KUBERNETES
          <span class="button_tally">42</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/networking/' class="post_tag button button_translucent" title="networking">
          NETWORKING
          <span class="button_tally">20</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/tanzu/' class="post_tag button button_translucent" title="tanzu">
          TANZU
          <span class="button_tally">13</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/cni/' class="post_tag button button_translucent" title="cni">
          CNI
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/loadbalancing/' class="post_tag button button_translucent" title="loadbalancing">
          LOADBALANCING
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/security/' class="post_tag button button_translucent" title="security">
          SECURITY
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/avi/' class="post_tag button button_translucent" title="avi">
          AVI
          <span class="button_tally">6</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/nsx/' class="post_tag button button_translucent" title="nsx">
          NSX
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/antrea/' class="post_tag button button_translucent" title="antrea">
          ANTREA
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/automation/' class="post_tag button button_translucent" title="automation">
          AUTOMATION
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/blog/' class="post_tag button button_translucent" title="blog">
          BLOG
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/network/' class="post_tag button button_translucent" title="network">
          NETWORK
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/vmware-nsx/' class="post_tag button button_translucent" title="vmware-nsx">
          VMWARE-NSX
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://blog.andreasm.io/categories/argocd/' class="post_tag button button_translucent" title="argocd">
          ARGOCD
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">All Categories</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://blog.andreasm.io/categories/antrea/' class=" post_tag button button_translucent" data-position=4 title="antrea">ANTREA<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/argocd/' class=" post_tag button button_translucent" data-position=1 title="argocd">ARGOCD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/automation/' class=" post_tag button button_translucent" data-position=2 title="automation">AUTOMATION<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/autoscaling/' class=" post_tag button button_translucent" data-position=1 title="autoscaling">AUTOSCALING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/avi/' class=" post_tag button button_translucent" data-position=6 title="avi">AVI<span class="button_tally">6</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/blog/' class=" post_tag button button_translucent" data-position=2 title="blog">BLOG<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/certificate/' class=" post_tag button button_translucent" data-position=1 title="certificate">CERTIFICATE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/cni/' class=" post_tag button button_translucent" data-position=9 title="cni">CNI<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/compliance/' class=" post_tag button button_translucent" data-position=1 title="compliance">COMPLIANCE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/docker/' class=" post_tag button button_translucent" data-position=1 title="docker">DOCKER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/ebpf/' class=" post_tag button button_translucent" data-position=1 title="ebpf">EBPF<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/github/' class=" post_tag button button_translucent" data-position=1 title="github">GITHUB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/gitops/' class=" post_tag button button_translucent" data-position=1 title="gitops">GITOPS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/harbor/' class=" post_tag button button_translucent" data-position=1 title="harbor">HARBOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/helm/' class=" post_tag button button_translucent" data-position=1 title="helm">HELM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/home-automation/' class=" post_tag button button_translucent" data-position=1 title="home-automation">HOME-AUTOMATION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/hugo/' class=" post_tag button button_translucent" data-position=1 title="hugo">HUGO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/ingress/' class=" post_tag button button_translucent" data-position=1 title="ingress">INGRESS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/kubernetes/' class=" post_tag button button_translucent" data-position=42 title="kubernetes">KUBERNETES<span class="button_tally">42</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/kubernetes-management/' class=" post_tag button button_translucent" data-position=1 title="kubernetes-management">KUBERNETES-MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/lcm/' class=" post_tag button button_translucent" data-position=1 title="lcm">LCM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/lifecycle-management/' class=" post_tag button button_translucent" data-position=1 title="lifecycle-management">LIFECYCLE-MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/loadbalancing/' class=" post_tag button button_translucent" data-position=9 title="loadbalancing">LOADBALANCING<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/management/' class=" post_tag button button_translucent" data-position=1 title="management">MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/monitoring/' class=" post_tag button button_translucent" data-position=1 title="monitoring">MONITORING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/netowkring/' class=" post_tag button button_translucent" data-position=1 title="netowkring">NETOWKRING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/network/' class=" post_tag button button_translucent" data-position=2 title="network">NETWORK<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/networking/' class=" post_tag button button_translucent" data-position=20 title="networking">NETWORKING<span class="button_tally">20</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/neuvector/' class=" post_tag button button_translucent" data-position=1 title="neuvector">NEUVECTOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/nsx/' class=" post_tag button button_translucent" data-position=5 title="nsx">NSX<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/nsx-alb/' class=" post_tag button button_translucent" data-position=1 title="nsx-alb">NSX-ALB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/nsx-t/' class=" post_tag button button_translucent" data-position=1 title="nsx-t">NSX-T<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/pinniped/' class=" post_tag button button_translucent" data-position=1 title="pinniped">PINNIPED<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/rancher/' class=" post_tag button button_translucent" data-position=1 title="rancher">RANCHER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/rbac/' class=" post_tag button button_translucent" data-position=1 title="rbac">RBAC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/rke2/' class=" post_tag button button_translucent" data-position=1 title="rke2">RKE2<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/security/' class=" post_tag button button_translucent" data-position=7 title="security">SECURITY<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/storage/' class=" post_tag button button_translucent" data-position=1 title="storage">STORAGE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/suse/' class=" post_tag button button_translucent" data-position=1 title="suse">SUSE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/tanzu/' class=" post_tag button button_translucent" data-position=13 title="tanzu">TANZU<span class="button_tally">13</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/tanzu-mission-control/' class=" post_tag button button_translucent" data-position=1 title="tanzu-mission-control">TANZU-MISSION-CONTROL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/tkg/' class=" post_tag button button_translucent" data-position=1 title="tkg">TKG<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/tkgi/' class=" post_tag button button_translucent" data-position=1 title="tkgi">TKGI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/tmc/' class=" post_tag button button_translucent" data-position=1 title="tmc">TMC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/troubleshooting/' class=" post_tag button button_translucent" data-position=1 title="troubleshooting">TROUBLESHOOTING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/virtualization/' class=" post_tag button button_translucent" data-position=1 title="virtualization">VIRTUALIZATION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/vmare-nsx-intelligence/' class=" post_tag button button_translucent" data-position=1 title="vmare-nsx-intelligence">VMARE-NSX-INTELLIGENCE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/vmware-cloud/' class=" post_tag button button_translucent" data-position=1 title="vmware-cloud">VMWARE-CLOUD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/vmware-nsx/' class=" post_tag button button_translucent" data-position=2 title="vmware-nsx">VMWARE-NSX<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/categories/vsphere/' class=" post_tag button button_translucent" data-position=1 title="vsphere">VSPHERE<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://blog.andreasm.io/tags/kubernetes/' class="post_tag button button_translucent" title="kubernetes">
          KUBERNETES
          <span class="button_tally">24</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/tanzu/' class="post_tag button button_translucent" title="tanzu">
          TANZU
          <span class="button_tally">14</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/nsx/' class="post_tag button button_translucent" title="nsx">
          NSX
          <span class="button_tally">13</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/antrea/' class="post_tag button button_translucent" title="antrea">
          ANTREA
          <span class="button_tally">12</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/ako/' class="post_tag button button_translucent" title="ako">
          AKO
          <span class="button_tally">8</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/avi/' class="post_tag button button_translucent" title="avi">
          AVI
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/loadbalancing/' class="post_tag button button_translucent" title="loadbalancing">
          LOADBALANCING
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/security/' class="post_tag button button_translucent" title="security">
          SECURITY
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/ingress/' class="post_tag button button_translucent" title="ingress">
          INGRESS
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/cni/' class="post_tag button button_translucent" title="cni">
          CNI
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/availability/' class="post_tag button button_translucent" title="availability">
          AVAILABILITY
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/cert-manager/' class="post_tag button button_translucent" title="cert-manager">
          CERT-MANAGER
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/network/' class="post_tag button button_translucent" title="network">
          NETWORK
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://blog.andreasm.io/tags/networking/' class="post_tag button button_translucent" title="networking">
          NETWORKING
          <span class="button_tally">3</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">All Tags</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://blog.andreasm.io/tags/ako/' class=" post_tag button button_translucent" data-position=8 title="ako">AKO<span class="button_tally">8</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/amko/' class=" post_tag button button_translucent" data-position=1 title="amko">AMKO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/ansible/' class=" post_tag button button_translucent" data-position=1 title="ansible">ANSIBLE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/antrea/' class=" post_tag button button_translucent" data-position=12 title="antrea">ANTREA<span class="button_tally">12</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/argocd/' class=" post_tag button button_translucent" data-position=1 title="argocd">ARGOCD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/authentication/' class=" post_tag button button_translucent" data-position=2 title="authentication">AUTHENTICATION<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/automation/' class=" post_tag button button_translucent" data-position=1 title="automation">AUTOMATION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/autoscaling/' class=" post_tag button button_translucent" data-position=1 title="autoscaling">AUTOSCALING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/availability/' class=" post_tag button button_translucent" data-position=3 title="availability">AVAILABILITY<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/avi/' class=" post_tag button button_translucent" data-position=7 title="avi">AVI<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/cert-manager/' class=" post_tag button button_translucent" data-position=3 title="cert-manager">CERT-MANAGER<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/certificate/' class=" post_tag button button_translucent" data-position=1 title="certificate">CERTIFICATE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/cilium/' class=" post_tag button button_translucent" data-position=1 title="cilium">CILIUM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/cni/' class=" post_tag button button_translucent" data-position=4 title="cni">CNI<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/compliance/' class=" post_tag button button_translucent" data-position=1 title="compliance">COMPLIANCE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/custom-resource-definitions/' class=" post_tag button button_translucent" data-position=1 title="custom-resource-definitions">CUSTOM-RESOURCE-DEFINITIONS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/distributed-firewall/' class=" post_tag button button_translucent" data-position=1 title="distributed-firewall">DISTRIBUTED-FIREWALL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/dns-service/' class=" post_tag button button_translucent" data-position=1 title="dns-service">DNS-SERVICE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/docker/' class=" post_tag button button_translucent" data-position=2 title="docker">DOCKER<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/ebpf/' class=" post_tag button button_translucent" data-position=1 title="ebpf">EBPF<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/github/' class=" post_tag button button_translucent" data-position=1 title="github">GITHUB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/gitops/' class=" post_tag button button_translucent" data-position=1 title="gitops">GITOPS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/gslb/' class=" post_tag button button_translucent" data-position=1 title="gslb">GSLB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/harbor/' class=" post_tag button button_translucent" data-position=1 title="harbor">HARBOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/home-assistant/' class=" post_tag button button_translucent" data-position=1 title="home-assistant">HOME-ASSISTANT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/hugo/' class=" post_tag button button_translucent" data-position=2 title="hugo">HUGO<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/ids/' class=" post_tag button button_translucent" data-position=1 title="ids">IDS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/informational/' class=" post_tag button button_translucent" data-position=2 title="informational">INFORMATIONAL<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/ingress/' class=" post_tag button button_translucent" data-position=5 title="ingress">INGRESS<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/ips/' class=" post_tag button button_translucent" data-position=1 title="ips">IPS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/keycloak/' class=" post_tag button button_translucent" data-position=1 title="keycloak">KEYCLOAK<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/kubernetes/' class=" post_tag button button_translucent" data-position=24 title="kubernetes">KUBERNETES<span class="button_tally">24</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/kubernetes-api-endpoint/' class=" post_tag button button_translucent" data-position=1 title="kubernetes-api-endpoint">KUBERNETES-API-ENDPOINT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/kubernetes-management/' class=" post_tag button button_translucent" data-position=1 title="kubernetes-management">KUBERNETES-MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/kubespray/' class=" post_tag button button_translucent" data-position=1 title="kubespray">KUBESPRAY<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/lifecycle-management/' class=" post_tag button button_translucent" data-position=1 title="lifecycle-management">LIFECYCLE-MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/load-balancing/' class=" post_tag button button_translucent" data-position=1 title="load-balancing">LOAD-BALANCING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/loadbalancer/' class=" post_tag button button_translucent" data-position=1 title="loadbalancer">LOADBALANCER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/loadbalancing/' class=" post_tag button button_translucent" data-position=7 title="loadbalancing">LOADBALANCING<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/lodbalancing/' class=" post_tag button button_translucent" data-position=1 title="lodbalancing">LODBALANCING<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/management/' class=" post_tag button button_translucent" data-position=1 title="management">MANAGEMENT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/multi-cluster/' class=" post_tag button button_translucent" data-position=1 title="multi-cluster">MULTI-CLUSTER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/multi-dc/' class=" post_tag button button_translucent" data-position=1 title="multi-dc">MULTI-DC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/multi-tenancy/' class=" post_tag button button_translucent" data-position=1 title="multi-tenancy">MULTI-TENANCY<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/network/' class=" post_tag button button_translucent" data-position=3 title="network">NETWORK<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/network-policies/' class=" post_tag button button_translucent" data-position=2 title="network-policies">NETWORK-POLICIES<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/networking/' class=" post_tag button button_translucent" data-position=3 title="networking">NETWORKING<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/neuvector/' class=" post_tag button button_translucent" data-position=1 title="neuvector">NEUVECTOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nfs/' class=" post_tag button button_translucent" data-position=1 title="nfs">NFS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nsx/' class=" post_tag button button_translucent" data-position=13 title="nsx">NSX<span class="button_tally">13</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nsx-advanced-loadbalancer/' class=" post_tag button button_translucent" data-position=1 title="nsx-advanced-loadbalancer">NSX-ADVANCED-LOADBALANCER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nsx-alb/' class=" post_tag button button_translucent" data-position=1 title="nsx-alb">NSX-ALB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nsx-application-platform/' class=" post_tag button button_translucent" data-position=1 title="nsx-application-platform">NSX-APPLICATION-PLATFORM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/nsx-t/' class=" post_tag button button_translucent" data-position=2 title="nsx-t">NSX-T<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/opentofu/' class=" post_tag button button_translucent" data-position=1 title="opentofu">OPENTOFU<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/persistent-storage/' class=" post_tag button button_translucent" data-position=1 title="persistent-storage">PERSISTENT-STORAGE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/pinniped/' class=" post_tag button button_translucent" data-position=1 title="pinniped">PINNIPED<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/proxmox/' class=" post_tag button button_translucent" data-position=1 title="proxmox">PROXMOX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/proxy/' class=" post_tag button button_translucent" data-position=1 title="proxy">PROXY<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/pvc/' class=" post_tag button button_translucent" data-position=1 title="pvc">PVC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/rancher/' class=" post_tag button button_translucent" data-position=1 title="rancher">RANCHER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/rbac/' class=" post_tag button button_translucent" data-position=1 title="rbac">RBAC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/registry/' class=" post_tag button button_translucent" data-position=1 title="registry">REGISTRY<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/rke2/' class=" post_tag button button_translucent" data-position=1 title="rke2">RKE2<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/security/' class=" post_tag button button_translucent" data-position=7 title="security">SECURITY<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/static-content-generator/' class=" post_tag button button_translucent" data-position=1 title="static-content-generator">STATIC-CONTENT-GENERATOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/static-site-generator/' class=" post_tag button button_translucent" data-position=1 title="static-site-generator">STATIC-SITE-GENERATOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/suse/' class=" post_tag button button_translucent" data-position=2 title="suse">SUSE<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tanzu/' class=" post_tag button button_translucent" data-position=14 title="tanzu">TANZU<span class="button_tally">14</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tanzu-kubernetes-grid/' class=" post_tag button button_translucent" data-position=1 title="tanzu-kubernetes-grid">TANZU-KUBERNETES-GRID<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/terraform/' class=" post_tag button button_translucent" data-position=1 title="terraform">TERRAFORM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tkg/' class=" post_tag button button_translucent" data-position=1 title="tkg">TKG<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tkg-2.1/' class=" post_tag button button_translucent" data-position=1 title="tkg-2.1">TKG-2.1<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tkgi/' class=" post_tag button button_translucent" data-position=1 title="tkgi">TKGI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tkgs/' class=" post_tag button button_translucent" data-position=1 title="tkgs">TKGS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tmc/' class=" post_tag button button_translucent" data-position=1 title="tmc">TMC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tmc-local/' class=" post_tag button button_translucent" data-position=1 title="tmc-local">TMC-LOCAL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/tmc-sm/' class=" post_tag button button_translucent" data-position=1 title="tmc-sm">TMC-SM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/traefik/' class=" post_tag button button_translucent" data-position=1 title="traefik">TRAEFIK<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/troubleshooting/' class=" post_tag button button_translucent" data-position=2 title="troubleshooting">TROUBLESHOOTING<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/unifi/' class=" post_tag button button_translucent" data-position=1 title="unifi">UNIFI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/vmconaws/' class=" post_tag button button_translucent" data-position=1 title="vmconaws">VMCONAWS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/vsphere/' class=" post_tag button button_translucent" data-position=2 title="vsphere">VSPHERE<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/vsphere-replication/' class=" post_tag button button_translucent" data-position=1 title="vsphere-replication">VSPHERE-REPLICATION<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/vsphere-with-tanzu/' class=" post_tag button button_translucent" data-position=1 title="vsphere-with-tanzu">VSPHERE-WITH-TANZU<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://blog.andreasm.io/tags/zwave/' class=" post_tag button button_translucent" data-position=1 title="zwave">ZWAVE<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/> 
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing">
    <path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord">
    <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z"/>
  </symbol>
</svg>


<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://blog.andreasm.io/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="From 0.985mhz... to several Ghz">
    <p>Copyright&nbsp;2016-&nbsp;<span class="year"></span>&nbsp;FROM 0.985MHZ... TO SEVERAL GHZ. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <title>to-top</title>
  <use xlink:href="#to-top"></use>
</svg>

</a>

  </div>
</footer>

<script type="text/javascript" src="https://blog.andreasm.io/en/js/bundle.5548d358738600c857a1f05f0459418da7143d4426c66a08bf3f15ded1b39dd2136bf104a559247a909fc4dcc45b8e06bad0870ece4c71ee5303d30550def8bd.js" integrity="sha512-VUjTWHOGAMhXofBfBFlBjacUPUQmxmoIvz8V3tGzndITa/EEpVkkepCfxNzEW44GutCHDs5Mce5TA9MFUN74vQ==" crossorigin="anonymous"></script>

  <script src="https://blog.andreasm.io/js/search.min.df4d84e4983f0c71dd495e07a09815d920553c3ddf3d0767801c73373573aa17e1b489e4453272dbf4ce2a38a3d01a10b170744e50dd6bec85a598221867ba9a.js"></script>

  </body>
</html>
